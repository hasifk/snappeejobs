function _init(){$.AdminLTE.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),t=$(window).height(),n=$(".sidebar").height();$("body").hasClass("fixed")?$(".content-wrapper, .right-side").css("min-height",t-$(".main-footer").outerHeight()):t>=n?$(".content-wrapper, .right-side").css("min-height",t-e):$(".content-wrapper, .right-side").css("min-height",n)},fixSidebar:function(){return $("body").hasClass("fixed")?("undefined"==typeof $.fn.slimScroll&&console,void($.AdminLTE.options.sidebarSlimScroll&&"undefined"!=typeof $.fn.slimScroll&&($(".sidebar").slimScroll({destroy:!0}).height("auto"),$(".sidebar").slimscroll({height:$(window).height()-$(".main-header").height()+"px",color:"rgba(0,0,0,0.2)",size:"3px"})))):void("undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"))}},$.AdminLTE.pushMenu=function(e){var t=this.options.screenSizes;$(e).click(function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").toggleClass("sidebar-collapse"):$("body").hasClass("sidebar-open")?($("body").removeClass("sidebar-open"),$("body").removeClass("sidebar-collapse")):$("body").addClass("sidebar-open")}),$(".content-wrapper").click(function(){$(window).width()<=t.sm-1&&$("body").hasClass("sidebar-open")&&$("body").removeClass("sidebar-open")})},$.AdminLTE.tree=function(e){var t=this;$("li a",$(e)).click(function(e){var n=$(this),o=n.next();if(o.is(".treeview-menu")&&o.is(":visible"))o.slideUp("normal",function(){o.removeClass("menu-open")}),o.parent("li").removeClass("active");else if(o.is(".treeview-menu")&&!o.is(":visible")){var i=n.parents("ul").first(),r=i.find("ul:visible").slideUp("normal");r.removeClass("menu-open");var s=n.parent("li");o.slideDown("normal",function(){o.addClass("menu-open"),i.find("li.active").removeClass("active"),s.addClass("active"),t.layout.fix()})}o.is(".treeview-menu")&&e.preventDefault()})},$.AdminLTE.boxWidget={activate:function(){var e=$.AdminLTE.options,t=this;$(e.boxWidgetOptions.boxWidgetSelectors.collapse).click(function(e){e.preventDefault(),t.collapse($(this))}),$(e.boxWidgetOptions.boxWidgetSelectors.remove).click(function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=e.parents(".box").first(),n=t.find(".box-body, .box-footer");t.hasClass("collapsed-box")?(e.children(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),n.slideDown(300,function(){t.removeClass("collapsed-box")})):(e.children(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),n.slideUp(300,function(){t.addClass("collapsed-box")}))},remove:function(e){var t=e.parents(".box").first();t.slideUp()},options:$.AdminLTE.options.boxWidgetOptions}}if(function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],o=n.length,i=window.console=window.console||{};o--;)e=n[o],i[e]||(i[e]=t)}(),$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content")}}),$("[data-method]").append(function(){return"\n<form action='"+$(this).attr("href")+"' method='POST' name='delete_item' style='display:none'>\n   <input type='hidden' name='_method' value='"+$(this).attr("data-method")+"'>\n   <input type='hidden' name='_token' value='"+$('meta[name="_token"]').attr("content")+"'>\n</form>\n"}).removeAttr("href").attr("style","cursor:pointer;").attr("onclick",'$(this).find("form").submit();'),$("form[name=delete_item]").submit(function(){return confirm("Are you sure you want to delete this item?")}),$('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="popover"]').popover(),$("body").on("click",function(e){$('[data-toggle="popover"]').each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")})})}),"undefined"==typeof jQuery)throw new Error("AdminLTE requires jQuery");$.AdminLTE={},$.AdminLTE.options={navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"3px",navbarMenuHeight:"200px",sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!0,enableBoxRefresh:!0,enableBSToppltip:!0,BSTooltipSelector:"[data-toggle='tooltip']",enableFastclick:!0,enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa fa-minus",open:"fa fa-plus",remove:"fa fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},$(function(){var e=$.AdminLTE.options;_init(),$.AdminLTE.layout.activate(),$.AdminLTE.tree(".sidebar"),e.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:"200px",alwaysVisible:!1,size:"3px"}).css("width","100%"),e.sidebarPushMenu&&$.AdminLTE.pushMenu(e.sidebarToggleSelector),e.enableBSToppltip&&$(e.BSTooltipSelector).tooltip(),e.enableBoxWidget&&$.AdminLTE.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(e.directChat.contactToggleSelector).click(function(){var e=$(this).parents(".direct-chat").first();e.toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var e=$(this);$(this).find(".btn").click(function(t){e.find(".btn.active").removeClass("active"),$(this).addClass("active"),t.preventDefault()})})}),function(e){e.fn.boxRefresh=function(t){function n(e){e.append(r),i.onLoadStart.call(e)}function o(e){e.find(r).remove(),i.onLoadDone.call(e)}var i=e.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){},onLoadDone:function(e){}},t),r=e('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===i.source)return void console;var t=e(this),r=t.find(i.trigger).first();r.click(function(e){e.preventDefault(),n(t),t.find(".box-body").load(i.source,function(){o(t)})})})}}(jQuery),function(e){e.fn.todolist=function(t){var n=e.extend({onCheck:function(e){},onUncheck:function(e){}},t);return this.each(function(){"undefined"!=typeof e.fn.iCheck?(e("input",this).on("ifChecked",function(t){var o=e(this).parents("li").first();o.toggleClass("done"),n.onCheck.call(o)}),e("input",this).on("ifUnchecked",function(t){var o=e(this).parents("li").first();o.toggleClass("done"),n.onUncheck.call(o)})):e("input",this).on("change",function(t){var o=e(this).parents("li").first();o.toggleClass("done"),n.onCheck.call(o)})})}}(jQuery),!function(e){e(["jquery"],function(e){return function(){function t(e,t,n){return p({type:C.error,iconClass:m().iconClasses.error,message:e,optionsOverride:n,title:t})}function n(t,n){return t||(t=m()),y=e("#"+t.containerId),y.length?y:(n&&(y=u(t)),y)}function o(e,t,n){return p({type:C.info,iconClass:m().iconClasses.info,message:e,optionsOverride:n,title:t})}function i(e){v=e}function r(e,t,n){return p({type:C.success,iconClass:m().iconClasses.success,message:e,optionsOverride:n,title:t})}function s(e,t,n){return p({type:C.warning,iconClass:m().iconClasses.warning,message:e,optionsOverride:n,title:t})}function a(e){var t=m();y||n(t),d(e,t)||c(t)}function l(t){var o=m();return y||n(o),t&&0===e(":focus",t).length?void g(t):void(y.children().length&&y.remove())}function c(t){for(var n=y.children(),o=n.length-1;o>=0;o--)d(e(n[o]),t)}function d(t,n){return t&&0===e(":focus",t).length?(t[n.hideMethod]({duration:n.hideDuration,easing:n.hideEasing,complete:function(){g(t)}}),!0):!1}function u(t){return y=e("<div/>").attr("id",t.containerId).addClass(t.positionClass).attr("aria-live","polite").attr("role","alert"),y.appendTo(e(t.target)),y}function h(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",target:"body",closeHtml:'<button type="button">&times;</button>',newestOnTop:!0,preventDuplicates:!1,progressBar:!1}}function f(e){v&&v(e)}function p(t){function o(t){return!e(":focus",d).length||t?(clearTimeout(C.intervalId),d[a.hideMethod]({duration:a.hideDuration,easing:a.hideEasing,complete:function(){g(d),a.onHidden&&"hidden"!==x.state&&a.onHidden(),x.state="hidden",x.endTime=new Date,f(x)}})):void 0}function i(){(a.timeOut>0||a.extendedTimeOut>0)&&(c=setTimeout(o,a.extendedTimeOut),C.maxHideTime=parseFloat(a.extendedTimeOut),C.hideEta=(new Date).getTime()+C.maxHideTime)}function r(){clearTimeout(c),C.hideEta=0,d.stop(!0,!0)[a.showMethod]({duration:a.showDuration,easing:a.showEasing})}function s(){var e=(C.hideEta-(new Date).getTime())/C.maxHideTime*100;p.width(e+"%")}var a=m(),l=t.iconClass||a.iconClass;if("undefined"!=typeof t.optionsOverride&&(a=e.extend(a,t.optionsOverride),l=t.optionsOverride.iconClass||l),a.preventDuplicates){if(t.message===w)return;w=t.message}b++,y=n(a,!0);var c=null,d=e("<div/>"),u=e("<div/>"),h=e("<div/>"),p=e("<div/>"),v=e(a.closeHtml),C={intervalId:null,hideEta:null,maxHideTime:null},x={toastId:b,state:"visible",startTime:new Date,options:a,map:t};return t.iconClass&&d.addClass(a.toastClass).addClass(l),t.title&&(u.append(t.title).addClass(a.titleClass),d.append(u)),t.message&&(h.append(t.message).addClass(a.messageClass),d.append(h)),a.closeButton&&(v.addClass("toast-close-button").attr("role","button"),d.prepend(v)),a.progressBar&&(p.addClass("toast-progress"),d.prepend(p)),d.hide(),a.newestOnTop?y.prepend(d):y.append(d),d[a.showMethod]({duration:a.showDuration,easing:a.showEasing,complete:a.onShown}),a.timeOut>0&&(c=setTimeout(o,a.timeOut),C.maxHideTime=parseFloat(a.timeOut),C.hideEta=(new Date).getTime()+C.maxHideTime,a.progressBar&&(C.intervalId=setInterval(s,10))),d.hover(r,i),!a.onclick&&a.tapToDismiss&&d.click(o),a.closeButton&&v&&v.click(function(e){e.stopPropagation?e.stopPropagation():void 0!==e.cancelBubble&&e.cancelBubble!==!0&&(e.cancelBubble=!0),o(!0)}),a.onclick&&d.click(function(){a.onclick(),o()}),f(x),a.debug&&console&&void 0,d}function m(){return e.extend({},h(),x.options)}function g(e){y||(y=n()),e.is(":visible")||(e.remove(),e=null,0===y.children().length&&(y.remove(),w=void 0))}var y,v,w,b=0,C={error:"error",info:"info",success:"success",warning:"warning"},x={clear:a,remove:l,error:t,getContainer:n,info:o,options:{},subscribe:i,success:r,version:"2.1.0",warning:s};return x}()})}("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):window.toastr=t(window.jQuery)}),Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&!function(){var e=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return e.get.call(this)},set:function(t){return e.set.call(this,t)}})}(),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var wysihtml5={version:"0.4.13",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};!function(e,t){"function"==typeof define&&define.amd?define(e):t.rangy=e()}(function(){function e(e,t){var n=typeof e[t];return n==v||!(n!=y||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=y||!e[t])}function n(e,t){return typeof e[t]!=w}function o(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}function i(e){return e&&N(e,E)&&T(e,x)}function r(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function s(n){t(window,"console")&&e(window.console,"log")&&window.console.log(n)}function a(e,t){t?window.alert(e):s(e)}function l(e){A.initialized=!0,A.supported=!1,a("Rangy is not supported on this page in your browser. Reason: "+e,A.config.alertOnFail)}function c(e){a("Rangy warning: "+e,A.config.alertOnWarn)}function d(e){return e.message||e.description||String(e)}function u(){if(!A.initialized){var t,n=!1,o=!1;e(document,"createRange")&&(t=document.createRange(),N(t,C)&&T(t,b)&&(n=!0));var a=r(document);if(!a||"body"!=a.nodeName.toLowerCase())return void l("No body element found");if(a&&e(a,"createTextRange")&&(t=a.createTextRange(),i(t)&&(o=!0)),!n&&!o)return void l("Neither Range nor TextRange are available");A.initialized=!0,A.features={implementsDomRange:n,implementsTextRange:o};var c,u;for(var h in _)(c=_[h])instanceof f&&c.init(c,A);for(var p=0,m=O.length;m>p;++p)try{O[p](A)}catch(g){u="Rangy init listener threw an exception. Continuing. Detail: "+d(g),s(u)}}}function h(e){e=e||window,u();for(var t=0,n=I.length;n>t;++t)I[t](e)}function f(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function p(e,t,n,o){var i=new f(t,n,function(e){if(!e.initialized){e.initialized=!0;try{o(A,e),e.supported=!0}catch(n){var i="Module '"+t+"' failed to load: "+d(n);s(i)}}});_[t]=i}function m(){}function g(){}var y="object",v="function",w="undefined",b=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],C=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],x=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],E=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],N=o(e),S=o(t),T=o(n),_={},A={version:"1.3alpha.20140804",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:N,areHostObjects:S,areHostProperties:T,isTextRange:i,getBody:r},features:{},modules:_,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==w?!0:rangyAutoInitialize}};A.fail=l,A.warn=c,{}.hasOwnProperty?A.util.extend=function(e,t,n){var o,i;for(var r in t)t.hasOwnProperty(r)&&(o=e[r],i=t[r],n&&null!==o&&"object"==typeof o&&null!==i&&"object"==typeof i&&A.util.extend(o,i,!0),e[r]=i);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e}:l("hasOwnProperty not supported"),function(){var e=document.createElement("div");e.appendChild(document.createElement("span"));var t,n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(e){return n.call(e,0)})}catch(o){}t||(t=function(e){for(var t=[],n=0,o=e.length;o>n;++n)t[n]=e[n];return t}),A.util.toArray=t}();var R;e(document,"addEventListener")?R=function(e,t,n){e.addEventListener(t,n,!1)}:e(document,"attachEvent")?R=function(e,t,n){e.attachEvent("on"+t,n)}:l("Document does not have required addEventListener or attachEvent method"),A.util.addListener=R;var O=[];A.init=u,A.addInitListener=function(e){A.initialized?e(A):O.push(e)};var I=[];A.addShimListener=function(e){I.push(e)},A.shim=A.createMissingNativeApi=h,f.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,i=n.length;i>o;++o){if(t=n[o],e=_[t],!(e&&e instanceof f))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){A.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){A.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},A.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var o=p(!1,e,n,t);A.initialized&&o.init()},A.createCoreModule=function(e,t,n){p(!0,e,t,n)},A.RangePrototype=m,A.rangePrototype=new m,A.selectionPrototype=new g;var L=!1,D=function(e){L||(L=!0,!A.initialized&&A.config.autoInitialize&&u())};return typeof window==w?void l("No window found"):typeof document==w?void l("No document found"):(e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",D,!1),R(window,"load",D),A.createCoreModule("DomUtil",[],function(e,t){function n(e){var t;return typeof e.namespaceURI==R||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function o(e){var t=e.parentNode;return 1==t.nodeType?t:null}function i(e){for(var t=0;e=e.previousSibling;)++t;return t}function r(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function s(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(D(o,n))return n;return null}function a(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function l(e,t){return a(e,t,!0)}function c(e,t,n){for(var o,i=n?e:e.parentNode;i;){if(o=i.parentNode,o===t)return i;i=o}return null}function d(e){var t=e.nodeType;return 3==t||4==t||8==t}function u(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function h(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function f(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),h(o,e),n)for(var r,s=0;r=n[s++];)r.node==e&&r.offset>t?(r.node=o,r.offset-=t):r.node==e.parentNode&&r.offset>i(e)&&++r.offset;return o}function p(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=R)return e.ownerDocument;if(typeof e.document!=R)return e.document;if(e.parentNode)return p(e.parentNode);throw t.createError("getDocument: no document found for node")}function m(e){var n=p(e);if(typeof n.defaultView!=R)return n.defaultView;if(typeof n.parentWindow!=R)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function g(e){if(typeof e.contentDocument!=R)return e.contentDocument;if(typeof e.contentWindow!=R)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function y(e){if(typeof e.contentWindow!=R)return e.contentWindow;if(typeof e.contentDocument!=R)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function v(e){return e&&O.isHostMethod(e,"setTimeout")&&O.isHostObject(e,"document")}function w(e,t,n){var o;if(e?O.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?g(e):p(e):v(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function b(e){for(var t;t=e.parentNode;)e=t;return e}function C(e,n,o,r){var a,l,d,u,h;if(e==o)return n===r?0:r>n?-1:1;if(a=c(o,e,!0))return n<=i(a)?-1:1;if(a=c(e,o,!0))return i(a)<r?-1:1;if(l=s(e,o),!l)throw new Error("comparePoints error: nodes have no common ancestor");if(d=e===l?l:c(e,l,!0),u=o===l?l:c(o,l,!0),d===u)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(h=l.firstChild;h;){if(h===d)return-1;if(h===u)return 1;h=h.nextSibling}}function x(e){var t;try{return t=e.parentNode,!1}catch(n){return!0}}function E(e){if(!e)return"[No node]";if(k&&x(e))return"[Broken node]";if(d(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+i(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function N(e){for(var t,n=p(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function S(e){this.root=e,this._next=e}function T(e){return new S(e)}function _(e,t){this.node=e,this.offset=t}function A(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var R="undefined",O=e.util;O.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),O.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var I=document.createElement("div");O.areHostMethods(I,["insertBefore","appendChild","cloneNode"]||!O.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),O.isHostProperty(I,"innerHTML")||t.fail("Element is missing innerHTML property");var L=document.createTextNode("test");O.areHostMethods(L,["splitText","deleteData","insertData","appendData","cloneNode"]||!O.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"])||!O.areHostProperties(L,["data"]))||t.fail("Incomplete Text Node implementation");var D=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},k=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br>",k=x(n),e.features.crashyTextNodes=k}();var $;typeof window.getComputedStyle!=R?$=function(e,t){return m(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=R?$=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found"),S.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},_.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+E(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},A.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},A.prototype.toString=function(){return this.message},e.dom={arrayContains:D,isHtmlNamespace:n,parentElement:o,getNodeIndex:i,getNodeLength:r,getCommonAncestor:s,isAncestorOf:a,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:d,isTextOrCommentNode:u,insertAfter:h,splitDataNode:f,getDocument:p,getWindow:m,getIframeWindow:y,getIframeDocument:g,getBody:O.getBody,isWindow:v,getContentDocument:w,getRootContainer:b,comparePoints:C,isBrokenNode:x,inspectNode:E,getComputedStyleProperty:$,fragmentFromNodeChildren:N,createIterator:T,DomPosition:_},e.DOMException=A}),A.createCoreModule("DomRange",["DomUtil"],function(e,t){function n(e,t){return 3!=e.nodeType&&(z(e,t.startContainer)||z(e,t.endContainer))}function o(e){return e.document||j(e.startContainer)}function i(e){return new P(e.parentNode,q(e))}function r(e){return new P(e.parentNode,q(e)+1)}function s(e,t,n){var o=11==e.nodeType?e.firstChild:e;return H(t)?n==t.length?$.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:W(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function a(e,t,n){if(S(e),S(t),o(t)!=o(e))throw new B("WRONG_DOCUMENT_ERR");var i=U(e.startContainer,e.startOffset,t.endContainer,t.endOffset),r=U(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?0>=i&&r>=0:0>i&&r>0}function l(e){for(var t,n,i,r=o(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(i=e.getSubtreeIterator(),n.appendChild(l(i)),i.detach()),10==n.nodeType)throw new B("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function c(e,t,n){var o,i;n=n||{stop:!1};for(var r,s;r=e.next();)if(e.isPartiallySelectedSubtree()){if(t(r)===!1)return void(n.stop=!0);if(s=e.getSubtreeIterator(),c(s,t,n),s.detach(),n.stop)return}else for(o=$.createIterator(r);i=o.next();)if(t(i)===!1)return void(n.stop=!0)}function d(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),d(t),t.detach()):e.remove()}function u(e){for(var t,n,i=o(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(u(n)),n.detach()):e.remove(),10==t.nodeType)throw new B("HIERARCHY_REQUEST_ERR");i.appendChild(t)}return i}function h(e,t,n){var o,i=!(!t||!t.length),r=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var s=[];return c(new p(e,!1),function(t){if((!i||o.test(t.nodeType))&&(!r||n(t))){var a=e.startContainer;if(t!=a||!H(a)||e.startOffset!=a.length){var l=e.endContainer;t==l&&H(l)&&0==e.endOffset||s.push(t)}}}),s}function f(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+$.inspectNode(e.startContainer)+":"+e.startOffset+", "+$.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&H(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||H(this.sc)?V(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||H(this.ec)?V(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function m(e){return function(t,n){for(var o,i=n?t:t.parentNode;i;){if(o=i.nodeType,K(e,o))return i;i=i.parentNode}return null}}function g(e,t){if(oe(e,t))throw new B("INVALID_NODE_TYPE_ERR")}function y(e,t){if(!K(t,e.nodeType))throw new B("INVALID_NODE_TYPE_ERR")}function v(e,t){if(0>t||t>(H(e)?e.length:e.childNodes.length))throw new B("INDEX_SIZE_ERR")}function w(e,t){if(te(e,!0)!==te(t,!0))throw new B("WRONG_DOCUMENT_ERR")}function b(e){if(ne(e,!0))throw new B("NO_MODIFICATION_ALLOWED_ERR")}function C(e,t){if(!e)throw new B(t)}function x(e){return Y&&$.isBrokenNode(e)||!K(Q,e.nodeType)&&!te(e,!0)}function E(e,t){return t<=(H(e)?e.length:e.childNodes.length)}function N(e){return!!e.startContainer&&!!e.endContainer&&!x(e.startContainer)&&!x(e.endContainer)&&E(e.startContainer,e.startOffset)&&E(e.endContainer,e.endOffset)}function S(e){if(!N(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function T(e,t){S(e);var n=e.startContainer,o=e.startOffset,i=e.endContainer,r=e.endOffset,s=n===i;H(i)&&r>0&&r<i.length&&W(i,r,t),H(n)&&o>0&&o<n.length&&(n=W(n,o,t),s?(r-=o,i=n):i==n.parentNode&&r>=q(n)&&r++,o=0),e.setStartAndEnd(n,o,i,r)}function _(e){S(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function A(e){e.START_TO_START=ce,e.START_TO_END=de,e.END_TO_END=ue,e.END_TO_START=he,e.NODE_BEFORE=fe,e.NODE_AFTER=pe,e.NODE_BEFORE_AND_AFTER=me,e.NODE_INSIDE=ge}function R(e){A(e),A(e.prototype)}function O(e,t){return function(){S(this);var n,o,i=this.startContainer,s=this.startOffset,a=this.commonAncestorContainer,l=new p(this,!0);i!==a&&(n=V(i,a,!0),o=r(n),i=o.node,s=o.offset),c(l,b),l.reset();var d=e(l);return l.detach(),t(this,i,s,i,s),d}}function I(t,o){function s(e,t){return function(n){y(n,X),y(G(n),Q);var o=(e?i:r)(n);(t?a:l)(this,o.node,o.offset)}}function a(e,t,n){var i=e.endContainer,r=e.endOffset;(t!==e.startContainer||n!==e.startOffset)&&((G(t)!=G(i)||1==U(t,n,i,r))&&(i=t,r=n),o(e,t,n,i,r))}function l(e,t,n){var i=e.startContainer,r=e.startOffset;(t!==e.endContainer||n!==e.endOffset)&&((G(t)!=G(i)||-1==U(t,n,i,r))&&(i=t,r=n),o(e,i,r,t,n))}var c=function(){};c.prototype=e.rangePrototype,t.prototype=new c,M.extend(t.prototype,{setStart:function(e,t){g(e,!0),v(e,t),a(this,e,t)},setEnd:function(e,t){g(e,!0),v(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],i=t,r=n;switch(e.length){case 3:r=e[2];break;case 4:i=e[2],r=e[3]}o(this,t,n,i,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){S(this),e?o(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):o(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){g(e,!0),o(this,e,0,e,F(e))},selectNode:function(e){g(e,!1),y(e,X);var t=i(e),n=r(e);o(this,t.node,t.offset,n.node,n.offset)},extractContents:O(u,o),deleteContents:O(d,o),canSurroundContents:function(){S(this),b(this.startContainer),b(this.endContainer);var e=new p(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},splitBoundaries:function(){T(this)},splitBoundariesPreservingPositions:function(e){T(this,e)},normalizeBoundaries:function(){S(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,r=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},s=function(o){var r=o.previousSibling;if(r&&r.nodeType==o.nodeType){e=o;var s=o.length;if(t=r.length,o.insertData(0,r.data),r.parentNode.removeChild(r),e==n)i+=t,n=e;else if(n==o.parentNode){var a=q(o);i==a?(n=o,i=s):i>a&&i--}}},a=!0;if(H(n))n.length==i&&r(n);else{if(i>0){var l=n.childNodes[i-1];l&&H(l)&&r(l)}a=!this.collapsed}if(a){if(H(e))0==t&&s(e);else if(t<e.childNodes.length){var c=e.childNodes[t];c&&H(c)&&s(c)}}else e=n,t=i;o(this,e,t,n,i)},collapseToPoint:function(e,t){g(e,!0),v(e,t),this.setStartAndEnd(e,t)}}),R(t)}function L(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:$.getCommonAncestor(e.startContainer,e.endContainer)}function D(e,t,n,o,i){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=i,e.document=$.getDocument(t),L(e)}function k(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,L(this)}var $=e.dom,M=e.util,P=$.DomPosition,B=e.DOMException,H=$.isCharacterDataNode,q=$.getNodeIndex,z=$.isOrIsAncestorOf,j=$.getDocument,U=$.comparePoints,W=$.splitDataNode,V=$.getClosestAncestorIn,F=$.getNodeLength,K=$.arrayContains,G=$.getRootContainer,Y=e.features.crashyTextNodes;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,H(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!H(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return n(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new k(o(this.range));var t=this._current,n=t,i=0,r=t,s=F(t);z(t,this.sc)&&(n=this.sc,i=this.so),z(t,this.ec)&&(r=this.ec,s=this.eo),D(e,n,i,r,s)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var X=[1,3,4,5,7,8,10],Q=[2,9,11],Z=[5,6,10,12],J=[1,3,4,5,7,8,10,11],ee=[1,3,4,5,7,8],te=m([9,11]),ne=m(Z),oe=m([6,10,12]),ie=document.createElement("style"),re=!1;
try{ie.innerHTML="<b>x</b>",re=3==ie.firstChild.nodeType}catch(se){}e.features.htmlParsingConforms=re;var ae=re?function(e){var t=this.startContainer,n=j(t);if(!t)throw new B("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:H(t)&&(o=$.parentElement(t)),o=null===o||"HTML"==o.nodeName&&$.isHtmlNamespace(j(o).documentElement)&&$.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1),o.innerHTML=e,$.fragmentFromNodeChildren(o)}:function(e){var t=o(this),n=t.createElement("body");return n.innerHTML=e,$.fragmentFromNodeChildren(n)},le=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ce=0,de=1,ue=2,he=3,fe=0,pe=1,me=2,ge=3;M.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){S(this),w(this.startContainer,t.startContainer);var n,o,i,r,s=e==he||e==ce?"start":"end",a=e==de||e==ce?"start":"end";return n=this[s+"Container"],o=this[s+"Offset"],i=t[a+"Container"],r=t[a+"Offset"],U(n,o,i,r)},insertNode:function(e){if(S(this),y(e,J),b(this.startContainer),z(e,this.startContainer))throw new B("HIERARCHY_REQUEST_ERR");var t=s(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){S(this);var e,t;if(this.collapsed)return o(this).createDocumentFragment();if(this.startContainer===this.endContainer&&H(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=o(this).createDocumentFragment(),t.appendChild(e),t;var n=new p(this,!0);return e=l(n),n.detach(),e},canSurroundContents:function(){S(this),b(this.startContainer),b(this.endContainer);var e=new p(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},surroundContents:function(e){if(y(e,ee),!this.canSurroundContents())throw new B("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);s(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){S(this);for(var e,t=new k(o(this)),n=le.length;n--;)e=le[n],t[e]=this[e];return t},toString:function(){S(this);var e=this.startContainer;if(e===this.endContainer&&H(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new p(this,!0);return c(n,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){S(this);var t=e.parentNode,n=q(e);if(!t)throw new B("NOT_FOUND_ERR");var o=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return 0>o?i>0?me:fe:i>0?pe:ge},comparePoint:function(e,t){return S(this),C(e,"HIERARCHY_REQUEST_ERR"),w(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)<0?-1:U(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ae,toHtml:function(){return _(this)},intersectsNode:function(e,t){if(S(this),C(e,"NOT_FOUND_ERR"),j(e)!==o(this))return!1;var n=e.parentNode,i=q(e);C(n,"NOT_FOUND_ERR");var r=U(n,i,this.endContainer,this.endOffset),s=U(n,i+1,this.startContainer,this.startOffset);return t?0>=r&&s>=0:0>r&&s>0},isPointInRange:function(e,t){return S(this),C(e,"HIERARCHY_REQUEST_ERR"),w(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)>=0&&U(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return a(this,e,!1)},intersectsOrTouchesRange:function(e){return a(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=U(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=U(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==U(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==U(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new B("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ge},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,F(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return S(this),h(this,e,t)},getDocument:function(){return o(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var n=o(this),i=e.createRange(n);t=t||$.getBody(n),i.selectNodeContents(t);var r=this.intersection(i),s=0,a=0;return r&&(i.setEnd(r.startContainer,r.startOffset),s=i.toString().length,a=s+r.toString().length),{start:s,end:a,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,i,r,s,a=[t],l=!1,c=!1;!c&&(o=a.pop());)if(3==o.nodeType)i=n+o.length,!l&&e.start>=n&&e.start<=i&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=i&&(this.setEnd(o,e.end-n),c=!0),n=i;else for(s=o.childNodes,r=s.length;r--;)a.push(s[r])},getName:function(){return"DomRange"},equals:function(e){return k.rangesEqual(this,e)},isValid:function(){return N(this)},inspect:function(){return f(this)},detach:function(){}}),I(k,D),M.extend(k,{rangeProperties:le,RangeIterator:p,copyComparisonConstants:R,createPrototypeRange:I,inspect:f,toHtml:_,getRangeDocument:o,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=k}),A.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,o,i=e.dom,r=e.util,s=i.DomPosition,a=e.DomRange,l=i.getBody,c=i.getContentDocument,d=i.isCharacterDataNode;if(e.features.implementsDomRange&&!function(){function o(e){for(var t,n=h.length;n--;)t=h[n],e[t]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function s(e,t,n,o,i){var r=e.startContainer!==t||e.startOffset!=n,s=e.endContainer!==o||e.endOffset!=i,a=!e.equals(e.nativeRange);(r||s||a)&&(e.setEnd(o,i),e.setStart(t,n))}var d,u,h=a.rangeProperties;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,o(this)},a.createPrototypeRange(n,s),d=n.prototype,d.selectNode=function(e){this.nativeRange.selectNode(e),o(this)},d.cloneContents=function(){return this.nativeRange.cloneContents()},d.surroundContents=function(e){this.nativeRange.surroundContents(e),o(this)},d.collapse=function(e){this.nativeRange.collapse(e),o(this)},d.cloneRange=function(){return new n(this.nativeRange.cloneRange())},d.refresh=function(){o(this)},d.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");l(document).appendChild(f);var p=document.createRange();p.setStart(f,0),p.setEnd(f,0);try{p.setStart(f,1),d.setStart=function(e,t){this.nativeRange.setStart(e,t),o(this)},d.setEnd=function(e,t){this.nativeRange.setEnd(e,t),o(this)},u=function(e){return function(t){this.nativeRange[e](t),o(this)}}}catch(m){d.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}o(this)},d.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}o(this)},u=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(i){this.nativeRange[t](n),this.nativeRange[e](n)}o(this)}}}d.setStartBefore=u("setStartBefore","setEndBefore"),d.setStartAfter=u("setStartAfter","setEndAfter"),d.setEndBefore=u("setEndBefore","setStartBefore"),d.setEndAfter=u("setEndAfter","setStartAfter"),d.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},p.selectNodeContents(f),p.setEnd(f,3);var g=document.createRange();g.selectNodeContents(f),g.setEnd(f,4),g.setStart(f,2),-1==p.compareBoundaryPoints(p.START_TO_END,g)&&1==p.compareBoundaryPoints(p.END_TO_START,g)?d.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:d.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var y=document.createElement("div");y.innerHTML="123";var v=y.firstChild,w=l(document);w.appendChild(y),p.setStart(v,1),p.setEnd(v,2),p.deleteContents(),"13"==v.data&&(d.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},d.extractContents=function(){var e=this.nativeRange.extractContents();return o(this),e}),w.removeChild(y),w=null,r.isHostMethod(p,"createContextualFragment")&&(d.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(f),d.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),e.createRange()}}(),e.features.implementsTextRange){var u=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();n=e.duplicate(),n.collapse(!1);var r=n.parentElement(),s=o==r?o:i.getCommonAncestor(o,r);return s==t?s:i.getCommonAncestor(t,s)},h=function(e){return 0==e.compareEndPoints("StartToEnd",e)},f=function(e,t,n,o,r){var a=e.duplicate();a.collapse(n);var l=a.parentElement();if(i.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var c=new s(l.parentNode,i.getNodeIndex(l));return{boundaryPosition:c,nodeInfo:{nodeIndex:c.offset,containerElement:c.node}}}var u=i.getDocument(l).createElement("span");u.parentNode&&u.parentNode.removeChild(u);for(var h,f,p,m,g,y=n?"StartToStart":"StartToEnd",v=r&&r.containerElement==l?r.nodeIndex:0,w=l.childNodes.length,b=w,C=b;;){if(C==w?l.appendChild(u):l.insertBefore(u,l.childNodes[C]),a.moveToElementText(u),h=a.compareEndPoints(y,e),0==h||v==b)break;if(-1==h){if(b==v+1)break;v=C}else b=b==v+1?v:C;C=Math.floor((v+b)/2),l.removeChild(u)}if(g=u.nextSibling,-1==h&&g&&d(g)){a.setEndPoint(n?"EndToStart":"EndToEnd",e);var x;if(/[\r\n]/.test(g.data)){var E=a.duplicate(),N=E.text.replace(/\r\n/g,"\r").length;for(x=E.moveStart("character",N);-1==(h=E.compareEndPoints("StartToEnd",E));)x++,E.moveStart("character",1)}else x=a.text.length;m=new s(g,x)}else f=(o||!n)&&u.previousSibling,p=(o||n)&&u.nextSibling,m=p&&d(p)?new s(p,0):f&&d(f)?new s(f,f.data.length):new s(l,i.getNodeIndex(u));return u.parentNode.removeChild(u),{boundaryPosition:m,nodeInfo:{nodeIndex:C,containerElement:l}}},p=function(e,t){var n,o,r,s,a=e.offset,c=i.getDocument(e.node),u=l(c).createTextRange(),h=d(e.node);return h?(n=e.node,o=n.parentNode):(s=e.node.childNodes,n=a<s.length?s[a]:null,o=e.node),r=c.createElement("span"),r.innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),u.moveToElementText(r),u.collapse(!t),o.removeChild(r),h&&u[t?"moveStart":"moveEnd"]("character",a),u};o=function(e){this.textRange=e,this.refresh()},o.prototype=new a(document),o.prototype.refresh=function(){var e,t,n,o=u(this.textRange);h(this.textRange)?t=e=f(this.textRange,o,!0,!0).boundaryPosition:(n=f(this.textRange,o,!0,!1),e=n.boundaryPosition,t=f(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},a.copyComparisonConstants(o);var m=function(e){if(e.collapsed)return p(new s(e.startContainer,e.startOffset),!0);var t=p(new s(e.startContainer,e.startOffset),!0),n=p(new s(e.endContainer,e.endOffset),!1),o=l(a.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=m,o.prototype.toTextRange=function(){return m(this)},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var g=function(){return this}();"undefined"==typeof g.Range&&(g.Range=o),e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=c(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=c(e,t,"createRangyRange"),new a(e)},e.createIframeRange=function(n){return t.deprecationNotice("createIframeRange()","createRange(iframeEl)"),e.createRange(n)},e.createIframeRangyRange=function(n){return t.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),e.createRangyRange(n)},e.addShimListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),A.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){function n(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function o(e,n){if(e){if(A.isWindow(e))return e;if(e instanceof y)return e.win;var o=A.getContentDocument(e,t,n);return A.getWindow(o)}return window}function i(e){return o(e,"getWinSelection").getSelection()}function r(e){return o(e,"getDocSelection").document.selection}function s(e){var t=!1;return e.anchorNode&&(t=1==A.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function a(e,t,n){var o=n?"end":"start",i=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function l(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function c(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function d(t){var n;return t instanceof I?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof L?n=t.nativeRange:$.implementsDomRange&&t instanceof A.getWindow(t.startContainer).Range&&(n=t),n}function u(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;n>t;++t)if(!A.isAncestorOf(e[0],e[t]))return!1;return!0}function h(e){var n=e.getNodes();if(!u(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function f(e){return!!e&&"undefined"!=typeof e.text}function p(e,t){var n=new L(t);e._ranges=[n],a(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function m(t){if(t._ranges.length=0,"None"==t.docSelection.type)c(t);else{var n=t.docSelection.createRange();if(f(n))p(t,n);else{t.rangeCount=n.length;for(var o,i=P(n.item(0)),r=0;r<t.rangeCount;++r)o=e.createRange(i),o.selectNode(n.item(r)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,a(t,t._ranges[t.rangeCount-1],!1)}}}function g(e,n){for(var o=e.docSelection.createRange(),i=h(n),r=P(o.item(0)),s=B(r).createControlRange(),a=0,l=o.length;l>a;++a)s.add(o.item(a));try{s.add(i)}catch(c){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}s.select(),m(e)}function y(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function v(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function w(e,t){for(var n,o,i=te.length;i--;)if(n=te[i],o=n.selection,"deleteAll"==t)v(o);else if(n.win==e)return"delete"==t?(te.splice(i,1),!0):o;return"deleteAll"==t&&(te.length=0),null}function b(e,n){for(var o,i=P(n[0].startContainer),r=B(i).createControlRange(),s=0,a=n.length;a>s;++s){o=h(n[s]);try{r.add(o)}catch(l){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),m(e)}function C(e,t){if(e.win.document!=P(t))throw new D("WRONG_DOCUMENT_ERR")}function x(t){return function(n,o){var i;this.rangeCount?(i=this.getRangeAt(0),i["set"+(t?"Start":"End")](n,o)):(i=e.createRange(this.win.document),i.setStartAndEnd(n,o)),this.setSingleRange(i,this.isBackward())}}function E(e){var t=[],n=new k(e.anchorNode,e.anchorOffset),o=new k(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var r=0,s=e.rangeCount;s>r;++r)t[r]=I.inspect(e.getRangeAt(r));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}e.config.checkSelectionRanges=!0;var N,S,T="boolean",_="number",A=e.dom,R=e.util,O=R.isHostMethod,I=e.DomRange,L=e.WrappedRange,D=e.DOMException,k=A.DomPosition,$=e.features,M="Control",P=A.getDocument,B=A.getBody,H=I.rangesEqual,q=O(window,"getSelection"),z=R.isHostObject(document,"selection");$.implementsWinGetSelection=q,$.implementsDocSelection=z;var j=z&&(!q||e.config.preferTextRange);j?(N=r,e.isSelectionValid=function(e){var t=o(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||P(n.createRange().parentElement())==t}):q?(N=i,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=N;var U=N(),W=e.createNativeRange(document),V=B(document),F=R.areHostProperties(U,["anchorNode","focusNode","anchorOffset","focusOffset"]);$.selectionHasAnchorAndFocus=F;var K=O(U,"extend");$.selectionHasExtend=K;var G=typeof U.rangeCount==_;$.selectionHasRangeCount=G;var Y=!1,X=!0,Q=K?function(t,n){var o=I.getRangeDocument(n),i=e.createRange(o);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(d(i)),t.extend(n.startContainer,n.startOffset)}:null;R.areHostMethods(U,["addRange","getRangeAt","removeAllRanges"])&&typeof U.rangeCount==_&&$.implementsDomRange&&!function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,i=[],r=s(t),a=0;n>a;++a)i[a]=t.getRangeAt(a);var l=B(document),c=l.appendChild(document.createElement("div"));c.contentEditable="false";var d=c.appendChild(document.createTextNode("   ")),u=document.createRange();if(u.setStart(d,1),u.collapse(!0),t.addRange(u),X=1==t.rangeCount,t.removeAllRanges(),!o){var h=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(h&&parseInt(h[1])>=36)Y=!1;else{var f=u.cloneRange();u.setStart(d,0),f.setEnd(d,3),f.setStart(d,2),t.addRange(u),t.addRange(f),Y=2==t.rangeCount}}for(l.removeChild(c),t.removeAllRanges(),a=0;n>a;++a)0==a&&r?Q?Q(t,i[a]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[a])):t.addRange(i[a])}}(),$.selectionSupportsMultipleRanges=Y,$.collapsedNonEditableSelectionsSupported=X;var Z,J=!1;V&&O(V,"createControlRange")&&(Z=V.createControlRange(),R.areHostProperties(Z,["item","add"])&&(J=!0)),$.implementsControlRange=J,S=F?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var ee;O(U,"getRangeAt")?ee=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:F&&(ee=function(t){var n=P(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),y.prototype=e.selectionPrototype;var te=[],ne=function(e){if(e&&e instanceof y)return e.refresh(),e;e=o(e,"getNativeSelection");var t=w(e),n=N(e),i=z?r(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh()):(t=new y(n,i,e),te.push({win:e,selection:t})),t};e.getSelection=ne,e.getIframeSelection=function(n){return t.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),e.getSelection(A.getIframeWindow(n))};var oe=y.prototype;if(!j&&F&&R.areHostMethods(U,["removeAllRanges","addRange"])){oe.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)};var ie=function(e,t){Q(e.nativeSelection,t),e.refresh()};G?oe.addRange=function(t,o){if(J&&z&&this.docSelection.type==M)g(this,t);else if(n(o)&&K)ie(this,t);else{var i;if(Y?i=this.rangeCount:(this.removeAllRanges(),i=0),this.nativeSelection.addRange(d(t).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var r=ee(this.nativeSelection,this.rangeCount-1);r&&!H(r,t)&&(t=new L(r))}this._ranges[this.rangeCount-1]=t,a(this,t,ae(this.nativeSelection)),this.isCollapsed=S(this)}else this.refresh()}}:oe.addRange=function(e,t){n(t)&&K?ie(this,e):(this.nativeSelection.addRange(d(e)),this.refresh())},oe.setRanges=function(e){if(J&&z&&e.length>1)b(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;n>t;++t)this.addRange(e[t])}}}else{if(!(O(U,"empty")&&O(W,"select")&&J&&j))return t.fail("No means of selecting a Range or TextRange was found"),!1;oe.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=P(this.anchorNode);else if(this.docSelection.type==M){var t=this.docSelection.createRange();t.length&&(e=P(t.item(0)))}if(e){var n=B(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(o){}c(this)},oe.addRange=function(t){this.docSelection.type==M?g(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,t,!1))},oe.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?b(this,e):t&&this.addRange(e[0])}}oe.getRangeAt=function(e){if(0>e||e>=this.rangeCount)throw new D("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var re;if(j)re=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=B(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==M?m(t):f(n)?p(t,n):c(t)};else if(O(U,"getRangeAt")&&typeof U.rangeCount==_)re=function(t){if(J&&z&&t.docSelection.type==M)m(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;o>n;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));a(t,t._ranges[t.rangeCount-1],ae(t.nativeSelection)),t.isCollapsed=S(t)}else c(t)};else{if(!F||typeof U.isCollapsed!=T||typeof W.collapsed!=T||!$.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;re=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=ee(n,0),e._ranges=[t],e.rangeCount=1,l(e),e.isCollapsed=S(e)):c(e)}}oe.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(re(this),e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;i--;)if(!H(t[i],this._ranges[i]))return!0;return!1}};var se=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,i=n.length;i>o;++o)H(t,n[o])||e.addRange(n[o]);e.rangeCount||c(e)};J&&z?oe.removeRange=function(e){if(this.docSelection.type==M){for(var t,n=this.docSelection.createRange(),o=h(e),i=P(n.item(0)),r=B(i).createControlRange(),s=!1,a=0,l=n.length;l>a;++a)t=n.item(a),t!==o||s?r.add(n.item(a)):s=!0;r.select(),m(this)}else se(this,e)}:oe.removeRange=function(e){se(this,e)};var ae;!j&&F&&$.implementsDomRange?(ae=s,oe.isBackward=function(){return ae(this)}):ae=oe.isBackward=function(){return!1},oe.isBackwards=oe.isBackward,oe.toString=function(){for(var e=[],t=0,n=this.rangeCount;n>t;++t)e[t]=""+this._ranges[t];return e.join("")},oe.collapse=function(t,n){C(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},oe.collapseToStart=function(){if(!this.rangeCount)throw new D("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},oe.collapseToEnd=function(){if(!this.rangeCount)throw new D("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},oe.selectAllChildren=function(t){C(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},oe.deleteFromDocument=function(){if(J&&z&&this.docSelection.type==M){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,i=n.length;i>o;++o)n[o].deleteContents();this.addRange(n[i-1])}}},oe.eachRange=function(e,t){for(var n=0,o=this._ranges.length;o>n;++n)if(e(this.getRangeAt(n)))return t},oe.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},oe.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},oe.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(o){n.push(o[e].apply(o,t))}),n},oe.setStart=x(!0),oe.setEnd=x(!1),e.rangePrototype.select=function(e){ne(this.getDocument()).setSingleRange(this,e)},oe.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},oe.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},oe.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},oe.moveToBookmark=function(t){for(var n,o,i=[],r=0;n=t.rangeBookmarks[r++];)o=e.createRange(this.win),o.moveToBookmark(n),i.push(o);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},oe.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(I.toHtml(t))}),e.join("")},$.implementsTextRange&&(oe.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(f(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),oe.getName=function(){return"WrappedSelection"},oe.inspect=function(){return E(this)},oe.detach=function(){w(this.win,"delete"),v(this)},y.detachAll=function(){w(null,"deleteAll")},y.inspect=E,y.isDirectionBackward=n,e.Selection=y,e.selectionPrototype=oe,e.addShimListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ne(e)}),e=null})}),A)},this),function(e,t){"function"==typeof define&&define.amd?define(["rangy"],e):e(t.rangy)}(function(e){e.createModule("SaveRestore",["WrappedRange"],function(e,t){function n(e,t){return(t||document).getElementById(e)}function o(e,t){var n,o="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),i=p.getDocument(e.startContainer),r=e.cloneRange();return r.collapse(t),n=i.createElement("span"),n.id=o,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(i.createTextNode(m)),r.insertNode(n),n}function i(e,o,i,r){var s=n(i,e);s?(o[r?"setStartBefore":"setEndBefore"](s),s.parentNode.removeChild(s)):t.warn("Marker element has been removed. Cannot restore selection.")}function r(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function s(t,n){var i,r,s=e.DomRange.getRangeDocument(t),a=t.toString();return t.collapsed?(r=o(t,!1),{document:s,markerId:r.id,collapsed:!0}):(r=o(t,!1),i=o(t,!0),{document:s,startMarkerId:i.id,endMarkerId:r.id,collapsed:!1,backward:n,toString:function(){return"original text: '"+a+"', new text: '"+t.toString()+"'"}})}function a(o,r){var s=o.document;"undefined"==typeof r&&(r=!0);var a=e.createRange(s);if(o.collapsed){var l=n(o.markerId,s);if(l){l.style.display="inline";var c=l.previousSibling;c&&3==c.nodeType?(l.parentNode.removeChild(l),a.collapseToPoint(c,c.length)):(a.collapseBefore(l),l.parentNode.removeChild(l))}else t.warn("Marker element has been removed. Cannot restore selection.")}else i(s,a,o.startMarkerId,!0),i(s,a,o.endMarkerId,!1);return r&&a.normalizeBoundaries(),a}function l(t,o){var i,a,l=[];t=t.slice(0),t.sort(r);for(var c=0,d=t.length;d>c;++c)l[c]=s(t[c],o);for(c=d-1;c>=0;--c)i=t[c],a=e.DomRange.getRangeDocument(i),i.collapsed?i.collapseAfter(n(l[c].markerId,a)):(i.setEndBefore(n(l[c].endMarkerId,a)),i.setStartAfter(n(l[c].startMarkerId,a)));return l}function c(n){if(!e.isSelectionValid(n))return t.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var o=e.getSelection(n),i=o.getAllRanges(),r=1==i.length&&o.isBackward(),s=l(i,r);return r?o.setSingleRange(i[0],"backward"):o.setRanges(i),{win:n,rangeInfos:s,restored:!1}}function d(e){for(var t=[],n=e.length,o=n-1;o>=0;o--)t[o]=a(e[o],!0);return t}function u(t,n){if(!t.restored){var o=t.rangeInfos,i=e.getSelection(t.win),r=d(o),s=o.length;1==s&&n&&e.features.selectionHasExtend&&o[0].backward?(i.removeAllRanges(),i.addRange(r[0],!0)):i.setRanges(r),t.restored=!0}}function h(e,t){var o=n(t,e);o&&o.parentNode.removeChild(o)}function f(e){for(var t,n=e.rangeInfos,o=0,i=n.length;i>o;++o)t=n[o],t.collapsed?h(e.doc,t.markerId):(h(e.doc,t.startMarkerId),h(e.doc,t.endMarkerId))}var p=e.dom,m="\ufeff";e.util.extend(e,{saveRange:s,restoreRange:a,saveRanges:l,restoreRanges:d,saveSelection:c,restoreSelection:u,removeMarkerElement:h,removeMarkers:f})})},this);var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=!0;var o=new this;n.call(o,e),o.base=function(){},delete Base._prototyping;var i=o.constructor,r=o.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==r)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||n).call(arguments[0],o)};return r.ancestor=this,r.extend=this.extend,r.forEach=this.forEach,r.implement=this.implement,r.prototype=o,r.toString=this.toString,r.valueOf=function(e){return"object"==e?r:i.valueOf()},n.call(r,t),"function"==typeof r.init&&r.init(),r},Base.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&"function"==typeof t&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var o=t.valueOf();t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=o.apply(this,arguments);return this.base=e,t},t.valueOf=function(e){return"object"==e?t:o},t.toString=Base.toString}this[e]=t}else if(e){var i=Base.prototype.extend;Base._prototyping||"function"==typeof this||(i=this.extend||i);for(var r={toSource:null},s=["constructor","toString","valueOf"],a=Base._prototyping?0:1;l=s[a++];)e[l]!=r[l]&&i.call(this,l,e[l]);for(var l in e)r[l]||i.call(this,l,e[l])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var o in e)void 0===this.prototype[o]&&t.call(n,e[o],o,e)},implement:function(){for(var e=0;e<arguments.length;e++)"function"==typeof arguments[e]?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return String(this.valueOf())}}),wysihtml5.browser=function(){function e(e){return+(/ipad|iphone|ipod/.test(e)&&e.match(/ os (\d+).+? like mac os x/)||[void 0,0])[1]}function t(e){return+(e.match(/android (\d+)/)||[void 0,0])[1]}function n(e,t){var n,o=-1;return"Microsoft Internet Explorer"==navigator.appName?n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"):"Netscape"==navigator.appName&&(n=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")),n&&null!=n.exec(navigator.userAgent)&&(o=parseFloat(RegExp.$1)),-1===o?!1:e?t?"<"===t?o>e:">"===t?e>o:"<="===t?o>=e:">="===t?e>=o:void 0:e===o:!0}var o=navigator.userAgent,i=document.createElement("div"),r=-1!==o.indexOf("Gecko")&&-1===o.indexOf("KHTML"),s=-1!==o.indexOf("AppleWebKit/"),a=-1!==o.indexOf("Chrome/"),l=-1!==o.indexOf("Opera/");return{USER_AGENT:o,supported:function(){var n=this.USER_AGENT.toLowerCase(),o="contentEditable"in i,r=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,s=document.querySelector&&document.querySelectorAll,a=this.isIos()&&e(n)<5||this.isAndroid()&&t(n)<4||-1!==n.indexOf("opera mobi")||-1!==n.indexOf("hpwos/");
return o&&r&&s&&!a},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return n()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return n()},hasCurrentStyleProperty:function(){return"currentStyle"in i},hasHistoryIssue:function(){return r&&"Mac"===navigator.platform.substr(0,3)},insertsLineBreaksOnReturn:function(){return r},supportsPlaceholderAttributeOn:function(e){return"placeholder"in e},supportsEvent:function(e){return"on"+e in i||function(){return i.setAttribute("on"+e,"return;"),"function"==typeof i["on"+e]}()},supportsEventsInIframeCorrectly:function(){return!l},supportsHTML5Tags:function(e){var t=e.createElement("div"),n="<article>foo</article>";return t.innerHTML=n,t.innerHTML.toLowerCase()===n},supportsCommand:function(){var e={formatBlock:n(10,"<="),insertUnorderedList:n(),insertOrderedList:n()},t={insertHTML:r};return function(n,o){var i=e[o];if(!i){try{return n.queryCommandSupported(o)}catch(r){}try{return n.queryCommandEnabled(o)}catch(s){return!!t[o]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return n()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return r||l||s},supportsGetAttributeCorrectly:function(){var e=document.createElement("td");return"1"!=e.getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return r||n()||l},autoScrollsToCaret:function(){return!s},autoClosesUnclosedTags:function(){var e,t,n=i.cloneNode(!1);return n.innerHTML="<p><div></div>",t=n.innerHTML.toLowerCase(),e="<p></p><div></div>"===t||"<p><div></div></p>"===t,this.autoClosesUnclosedTags=function(){return e},e},supportsNativeGetElementsByClassName:function(){return-1!==String(document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return l},supportsSpeechApiOn:function(e){var t=o.match(/Chrome\/(\d+)/)||[void 0,0];return t[1]>=11&&("onwebkitspeechchange"in e||"speech"in e)},crashesWhenDefineProperty:function(e){return n(9)&&("XMLHttpRequest"===e||"XDomainRequest"===e)},doesAsyncFocus:function(){return n()},hasProblemsSettingCaretAfterImg:function(){return n()},hasUndoInContextMenu:function(){return r||a||l},hasInsertNodeIssue:function(){return l},hasIframeFocusIssue:function(){return n()},createsNestedInvalidMarkupAfterPaste:function(){return s},supportsMutationEvents:function(){return"MutationEvent"in window}}}(),wysihtml5.lang.array=function(e){return{contains:function(t){if(Array.isArray(t)){for(var n=t.length;n--;)if(-1!==wysihtml5.lang.array(e).indexOf(t[n]))return!0;return!1}return-1!==wysihtml5.lang.array(e).indexOf(t)},indexOf:function(t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;o>n;n++)if(e[n]===t)return n;return-1},without:function(t){t=wysihtml5.lang.array(t);for(var n=[],o=0,i=e.length;i>o;o++)t.contains(e[o])||n.push(e[o]);return n},get:function(){for(var t=0,n=e.length,o=[];n>t;t++)o.push(e[t]);return o},map:function(t,n){if(Array.prototype.map)return e.map(t,n);for(var o=e.length>>>0,i=new Array(o),r=0;o>r;r++)i[r]=t.call(n,e[r],r,e);return i},unique:function(){for(var t=[],n=e.length,o=0;n>o;)wysihtml5.lang.array(t).contains(e[o])||t.push(e[o]),o++;return t}}},wysihtml5.lang.Dispatcher=Base.extend({on:function(e,t){return this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t),this},off:function(e,t){this.events=this.events||{};var n,o,i=0;if(e){for(n=this.events[e]||[],o=[];i<n.length;i++)n[i]!==t&&t&&o.push(n[i]);this.events[e]=o}else this.events={};return this},fire:function(e,t){this.events=this.events||{};for(var n=this.events[e]||[],o=0;o<n.length;o++)n[o].call(this,t);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),wysihtml5.lang.object=function(e){return{merge:function(t){for(var n in t)e[n]=t[n];return this},get:function(){return e},clone:function(){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(){return"[object Array]"===Object.prototype.toString.call(e)}}},function(){var e=/^\s+/,t=/\s+$/,n=/[&<>"]/g,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};wysihtml5.lang.string=function(i){return i=String(i),{trim:function(){return i.replace(e,"").replace(t,"")},interpolate:function(e){for(var t in e)i=this.replace("#{"+t+"}").by(e[t]);return i},replace:function(e){return{by:function(t){return i.split(e).join(t)}}},escapeHTML:function(){return i.replace(n,function(e){return o[e]})}}}}(),function(e){function t(e,t){return r(e,t)?e:(e===e.ownerDocument.documentElement&&(e=e.ownerDocument.body),s(e,t))}function n(e){return e.replace(l,function(e,t){var n=(t.match(c)||[])[1]||"",o=u[n];t=t.replace(c,""),t.split(o).length>t.split(n).length&&(t+=n,n="");var i=t,r=t;return t.length>d&&(r=r.substr(0,d)+"..."),"www."===i.substr(0,4)&&(i="http://"+i),'<a href="'+i+'">'+r+"</a>"+n})}function o(e){var t=e._wysihtml5_tempElement;return t||(t=e._wysihtml5_tempElement=e.createElement("div")),t}function i(t){var i=t.parentNode,r=e.lang.string(t.data).escapeHTML(),s=o(i.ownerDocument);for(s.innerHTML="<span></span>"+n(r),s.removeChild(s.firstChild);s.firstChild;)i.insertBefore(s.firstChild,t);i.removeChild(t)}function r(t,n){for(var o;t.parentNode;){if(t=t.parentNode,o=t.nodeName,t.className&&e.lang.array(t.className.split(" ")).contains(n))return!0;if(a.contains(o))return!0;if("body"===o)return!1}return!1}function s(t,n){if(!(a.contains(t.nodeName)||t.className&&e.lang.array(t.className.split(" ")).contains(n))){if(t.nodeType===e.TEXT_NODE&&t.data.match(l))return void i(t);for(var o=e.lang.array(t.childNodes).get(),r=o.length,c=0;r>c;c++)s(o[c],n);return t}}var a=e.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),l=/((https?:\/\/|www\.)[^\s<]{3,})/gi,c=/([^\w\/\-](,?))$/i,d=100,u={")":"(","]":"[","}":"{"};e.dom.autoLink=t,e.dom.autoLink.URL_REG_EXP=l}(wysihtml5),function(e){var t=e.dom;t.addClass=function(e,n){var o=e.classList;return o?o.add(n):void(t.hasClass(e,n)||(e.className+=" "+n))},t.removeClass=function(e,t){var n=e.classList;return n?n.remove(t):void(e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))},t.hasClass=function(e,t){var n=e.classList;if(n)return n.contains(t);var o=e.className;return o.length>0&&(o==t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(o))}}(wysihtml5),wysihtml5.dom.contains=function(){var e=document.documentElement;return e.contains?function(e,t){return t.nodeType!==wysihtml5.ELEMENT_NODE&&(t=t.parentNode),e!==t&&e.contains(t)}:e.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:void 0}(),wysihtml5.dom.convertToList=function(){function e(e,t){var n=e.createElement("li");return t.appendChild(n),n}function t(e,t){return e.createElement(t)}function n(n,o,i){if("UL"===n.nodeName||"OL"===n.nodeName||"MENU"===n.nodeName)return n;var r,s,a,l,c,d,u,h,f,p=n.ownerDocument,m=t(p,o),g=n.querySelectorAll("br"),y=g.length;for(f=0;y>f;f++)for(l=g[f];(c=l.parentNode)&&c!==n&&c.lastChild===l;){if("block"===wysihtml5.dom.getStyle("display").from(c)){c.removeChild(l);break}wysihtml5.dom.insert(l).after(l.parentNode)}for(r=wysihtml5.lang.array(n.childNodes).get(),s=r.length,f=0;s>f;f++)h=h||e(p,m),a=r[f],d="block"===wysihtml5.dom.getStyle("display").from(a),u="BR"===a.nodeName,!d||i&&wysihtml5.dom.hasClass(a,i)?u?h=h.firstChild?null:h:h.appendChild(a):(h=h.firstChild?e(p,m):h,h.appendChild(a),h=null);return 0===r.length&&e(p,m),n.parentNode.replaceChild(m,n),m}return n}(),wysihtml5.dom.copyAttributes=function(e){return{from:function(t){return{to:function(n){for(var o,i=0,r=e.length;r>i;i++)o=e[i],"undefined"!=typeof t[o]&&""!==t[o]&&(n[o]=t[o]);return{andTo:arguments.callee}}}}}},function(e){var t=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],n=function(t){return o(t)?parseInt(e.getStyle("width").from(t),10)<t.offsetWidth:!1},o=function(n){for(var o=0,i=t.length;i>o;o++)if("border-box"===e.getStyle(t[o]).from(n))return t[o]};e.copyStyles=function(o){return{from:function(i){n(i)&&(o=wysihtml5.lang.array(o).without(t));for(var r,s="",a=o.length,l=0;a>l;l++)r=o[l],s+=r+":"+e.getStyle(r).from(i)+";";return{to:function(t){return e.setStyles(s).on(t),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(e){e.dom.delegate=function(t,n,o,i){return e.dom.observe(t,o,function(o){for(var r=o.target,s=e.lang.array(t.querySelectorAll(n));r&&r!==t;){if(s.contains(r)){i.call(r,o);break}r=r.parentNode}})}}(wysihtml5),function(e){e.dom.domNode=function(t){var n=[e.ELEMENT_NODE,e.TEXT_NODE],o=function(t){return t.nodeType===e.TEXT_NODE&&/^\s*$/g.test(t.data)};return{prev:function(i){var r=t.previousSibling,s=i&&i.nodeTypes?i.nodeTypes:n;return r?!e.lang.array(s).contains(r.nodeType)||i&&i.ignoreBlankTexts&&o(r)?e.dom.domNode(r).prev(i):r:null},next:function(i){var r=t.nextSibling,s=i&&i.nodeTypes?i.nodeTypes:n;return r?!e.lang.array(s).contains(r.nodeType)||i&&i.ignoreBlankTexts&&o(r)?e.dom.domNode(r).next(i):r:null}}}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var e=function(e,t){var n=t.createElement("div");n.style.display="none",t.body.appendChild(n);try{n.innerHTML=e}catch(o){}return t.body.removeChild(n),n},t=function(e){if(!e._wysihtml5_supportsHTML5Tags){for(var t=0,o=n.length;o>t;t++)e.createElement(n[t]);e._wysihtml5_supportsHTML5Tags=!0}},n=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(n,o){o=o||document;var i;return"object"==typeof n&&n.nodeType?(i=o.createElement("div"),i.appendChild(n)):wysihtml5.browser.supportsHTML5Tags(o)?(i=o.createElement("div"),i.innerHTML=n):(t(o),i=e(n,o)),i}}(),wysihtml5.dom.getParentElement=function(){function e(e,t){return t&&t.length?"string"==typeof t?e===t:wysihtml5.lang.array(t).contains(e):!0}function t(e){return e.nodeType===wysihtml5.ELEMENT_NODE}function n(e,t,n){var o=(e.className||"").match(n)||[];return t?o[o.length-1]===t:!!o.length}function o(e,t,n){var o=(e.getAttribute("style")||"").match(n)||[];return t?o[o.length-1]===t:!!o.length}return function(i,r,s,a){var l=r.cssStyle||r.styleRegExp,c=r.className||r.classRegExp;for(s=s||50;s--&&i&&"BODY"!==i.nodeName&&(!a||i!==a);){if(t(i)&&e(i.nodeName,r.nodeName)&&(!l||o(i,r.cssStyle,r.styleRegExp))&&(!c||n(i,r.className,r.classRegExp)))return i;i=i.parentNode}return null}}(),wysihtml5.dom.getStyle=function(){function e(e){return e.replace(n,function(e){return e.charAt(1).toUpperCase()})}var t={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},n=/\-[a-z]/g;return function(n){return{from:function(o){if(o.nodeType===wysihtml5.ELEMENT_NODE){var i=o.ownerDocument,r=t[n]||e(n),s=o.style,a=o.currentStyle,l=s[r];if(l)return l;if(a)try{return a[r]}catch(c){}var d,u,h=i.defaultView||i.parentWindow,f=("height"===n||"width"===n)&&"TEXTAREA"===o.nodeName;return h.getComputedStyle?(f&&(d=s.overflow,s.overflow="hidden"),u=h.getComputedStyle(o,null).getPropertyValue(n),f&&(s.overflow=d||""),u):void 0}}}}}(),wysihtml5.dom.getTextNodes=function(e,t){var n=[];for(e=e.firstChild;e;e=e.nextSibling)3==e.nodeType?t&&/^\s*$/.test(e.innerText||e.textContent)||n.push(e):n=n.concat(wysihtml5.dom.getTextNodes(e,t));return n},wysihtml5.dom.hasElementWithTagName=function(){function e(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=n++)}var t={},n=1;return function(n,o){var i=e(n)+":"+o,r=t[i];return r||(r=t[i]=n.getElementsByTagName(o)),r.length>0}}(),function(e){function t(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=o++)}var n={},o=1;e.dom.hasElementWithClassName=function(o,i){if(!e.browser.supportsNativeGetElementsByClassName())return!!o.querySelector("."+i);var r=t(o)+":"+i,s=n[r];return s||(s=n[r]=o.getElementsByClassName(i)),s.length>0}}(wysihtml5),wysihtml5.dom.insert=function(e){return{after:function(t){t.parentNode.insertBefore(e,t.nextSibling)},before:function(t){t.parentNode.insertBefore(e,t)},into:function(t){t.appendChild(e)}}},wysihtml5.dom.insertCSS=function(e){return e=e.join("\n"),{into:function(t){var n=t.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(t.createTextNode(e));var o=t.querySelector("head link");if(o)return void o.parentNode.insertBefore(n,o);var i=t.querySelector("head");i&&i.appendChild(n)}}},function(e){e.dom.lineBreaks=function(t){function n(e){return"BR"===e.nodeName}function o(t){return n(t)?!0:"block"===e.dom.getStyle("display").from(t)?!0:!1}return{add:function(n){var i=t.ownerDocument,r=e.dom.domNode(t).next({ignoreBlankTexts:!0}),s=e.dom.domNode(t).prev({ignoreBlankTexts:!0});r&&!o(r)&&e.dom.insert(i.createElement("br")).after(t),s&&!o(s)&&e.dom.insert(i.createElement("br")).before(t)},remove:function(o){var i=e.dom.domNode(t).next({ignoreBlankTexts:!0}),r=e.dom.domNode(t).prev({ignoreBlankTexts:!0});i&&n(i)&&i.parentNode.removeChild(i),r&&n(r)&&r.parentNode.removeChild(r)}}}}(wysihtml5),wysihtml5.dom.observe=function(e,t,n){t="string"==typeof t?[t]:t;for(var o,i,r=0,s=t.length;s>r;r++)i=t[r],e.addEventListener?e.addEventListener(i,n,!1):(o=function(t){"target"in t||(t.target=t.srcElement),t.preventDefault=t.preventDefault||function(){this.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){this.cancelBubble=!0},n.call(e,t)},e.attachEvent("on"+i,o));return{stop:function(){for(var i,r=0,s=t.length;s>r;r++)i=t[r],e.removeEventListener?e.removeEventListener(i,n,!1):e.detachEvent("on"+i,o)}}},wysihtml5.dom.parse=function(){function e(e,n){wysihtml5.lang.object(m).merge(p).merge(n.rules).get();var o,i,r,s=n.context||e.ownerDocument||document,a=s.createDocumentFragment(),l="string"==typeof e,c=!1;for(n.clearInternals===!0&&(c=!0),n.uneditableClass&&(g=n.uneditableClass),o=l?wysihtml5.dom.getAsDom(e,s):e;o.firstChild;)r=o.firstChild,i=t(r,n.cleanUp,c),i&&a.appendChild(i),r!==i&&o.removeChild(r);return o.innerHTML="",o.appendChild(a),l?wysihtml5.quirks.getCorrectInnerHTML(o):o}function t(e,n,o){var i,r,s,a=e.nodeType,l=e.childNodes,c=l.length,d=u[a],f=0;if(g&&1===a&&wysihtml5.dom.hasClass(e,g))return e;if(r=d&&d(e,o),!r){if(r===!1){for(i=e.ownerDocument.createDocumentFragment(),f=c;f--;)l[f]&&(s=t(l[f],n,o),s&&(l[f]===s&&f--,i.insertBefore(s,i.firstChild)));return wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(e.nodeName.toLowerCase())&&e.parentNode.lastChild!==e&&(e.nextSibling&&3===e.nextSibling.nodeType&&/^\s/.test(e.nextSibling.nodeValue)||i.appendChild(e.ownerDocument.createTextNode(" "))),i.normalize&&i.normalize(),i}return null}for(f=0;c>f;f++)l[f]&&(s=t(l[f],n,o),s&&(l[f]===s&&f--,r.appendChild(s)));if(n&&r.nodeName.toLowerCase()===h&&(!r.childNodes.length||/^\s*$/gi.test(r.innerHTML)&&(o||"_wysihtml5-temp-placeholder"!==e.className&&"rangySelectionBoundary"!==e.className)||!r.attributes.length)){for(i=r.ownerDocument.createDocumentFragment();r.firstChild;)i.appendChild(r.firstChild);return i.normalize&&i.normalize(),i}return r.normalize&&r.normalize(),r}function n(e,t){var n,i,a=m.tags,l=e.nodeName.toLowerCase(),c=e.scopeName;if(e._wysihtml5)return null;if(e._wysihtml5=1,"wysihtml5-temp"===e.className)return null;if(c&&"HTML"!=c&&(l=c+":"+l),"outerHTML"in e&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==e.nodeName||"</p>"===e.outerHTML.slice(-4).toLowerCase()||(l="div")),l in a){if(n=a[l],!n||n.remove)return null;if(n.unwrap)return!1;n="string"==typeof n?{rename_tag:n}:n}else{if(!e.firstChild)return null;n={rename_tag:h}}return i=e.ownerDocument.createElement(n.rename_tag||l),s(e,i,n,t),r(e,i,n),n.one_of_type&&!o(e,m,n.one_of_type,t)?n.remove_action&&"unwrap"==n.remove_action?!1:null:(e=null,i.normalize&&i.normalize(),i)}function o(e,t,n,o){var r,s;if("SPAN"===e.nodeName&&!o&&("_wysihtml5-temp-placeholder"===e.className||"rangySelectionBoundary"===e.className))return!0;for(s in n)if(n.hasOwnProperty(s)&&t.type_definitions&&t.type_definitions[s]&&(r=t.type_definitions[s],i(e,r)))return!0;return!1}function i(e,t){var n,o,i,r,s,l=e.getAttribute("class"),c=e.getAttribute("style");if(t.methods)for(var d in t.methods)if(t.methods.hasOwnProperty(d)&&x[d]&&x[d](e))return!0;if(l&&t.classes){l=l.replace(/^\s+/g,"").replace(/\s+$/g,"").split(f),n=l.length;for(var u=0;n>u;u++)if(t.classes[l[u]])return!0}if(c&&t.styles){c=c.split(";");for(o in t.styles)if(t.styles.hasOwnProperty(o))for(var h=c.length;h--;)if(s=c[h].split(":"),s[0].replace(/\s/g,"").toLowerCase()===o&&(t.styles[o]===!0||1===t.styles[o]||wysihtml5.lang.array(t.styles[o]).contains(s[1].replace(/\s/g,"").toLowerCase())))return!0}if(t.attrs)for(i in t.attrs)if(t.attrs.hasOwnProperty(i)&&(r=a(e,i),"string"==typeof r&&r.search(t.attrs[i])>-1))return!0;return!1}function r(e,t,n){var o;if(n&&n.keep_styles)for(o in n.keep_styles)n.keep_styles.hasOwnProperty(o)&&("float"==o?(e.style.styleFloat&&(t.style.styleFloat=e.style.styleFloat),e.style.cssFloat&&(t.style.cssFloat=e.style.cssFloat)):e.style[o]&&(t.style[o]=e.style[o]))}function s(e,t,n,o){var i,r,s,l,c,d,u,h={},p=n.set_class,g=n.add_class,y=n.add_style,v=n.set_attributes,x=n.check_attributes,E=m.classes,N=0,S=[],T=[],_=[],A=[];if(v&&(h=wysihtml5.lang.object(v).clone()),x)for(l in x)d=w[x[l]],d&&(u=a(e,l),(u||"alt"===l&&"IMG"==e.nodeName)&&(c=d(u),"string"==typeof c&&(h[l]=c)));if(p&&S.push(p),g)for(l in g)d=C[g[l]],d&&(s=d(a(e,l)),"string"==typeof s&&S.push(s));if(y)for(l in y)d=b[y[l]],d&&(newStyle=d(a(e,l)),"string"==typeof newStyle&&T.push(newStyle));if("string"==typeof E&&"any"===E&&e.getAttribute("class"))h["class"]=e.getAttribute("class");else{for(o||(E["_wysihtml5-temp-placeholder"]=1,E._rangySelectionBoundary=1,E["wysiwyg-tmp-selected-cell"]=1),A=e.getAttribute("class"),A&&(S=S.concat(A.split(f))),i=S.length;i>N;N++)r=S[N],E[r]&&_.push(r);_.length&&(h["class"]=wysihtml5.lang.array(_).unique().join(" "))}h["class"]&&o&&(h["class"]=h["class"].replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(h["class"])&&delete h["class"]),T.length&&(h.style=wysihtml5.lang.array(T).unique().join(" "));for(l in h)try{t.setAttribute(l,h[l])}catch(R){}h.src&&("undefined"!=typeof h.width&&t.setAttribute("width",h.width),"undefined"!=typeof h.height&&t.setAttribute("height",h.height))}function a(e,t){t=t.toLowerCase();var n=e.nodeName;if("IMG"==n&&"src"==t&&l(e)===!0)return e.src;if(y&&"outerHTML"in e){var o=e.outerHTML.toLowerCase(),i=-1!=o.indexOf(" "+t+"=");return i?e.getAttribute(t):null}return e.getAttribute(t)}function l(e){try{return e.complete&&!e.mozMatchesSelector(":-moz-broken")}catch(t){if(e.complete&&"complete"===e.readyState)return!0}}function c(e){var t=e.nextSibling;if(!t||t.nodeType!==wysihtml5.TEXT_NODE){var n=e.data.replace(v,"");return e.ownerDocument.createTextNode(n)}t.data=e.data.replace(v,"")+t.data.replace(v,"")}function d(e){return m.comments?e.ownerDocument.createComment(e.nodeValue):void 0}var u={1:n,3:c,8:d},h="span",f=/\s+/,p={tags:{},classes:{}},m={},g=!1,y=!wysihtml5.browser.supportsGetAttributeCorrectly(),v=/\uFEFF/g,w={url:function(){var e=/^https?:\/\//i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),src:function(){var e=/^(\/|https?:\/\/)/i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),href:function(){var e=/^(#|\/|https?:\/\/|mailto:)/i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),alt:function(){var e=/[^ a-z0-9_\-]/gi;return function(t){return t?t.replace(e,""):""}}(),numbers:function(){var e=/\D/g;return function(t){return t=(t||"").replace(e,""),t||null}}(),any:function(){return function(e){return e}}()},b={align_text:function(){var e={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(t){return e[String(t).toLowerCase()]}}()},C={align_img:function(){var e={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(t){return e[String(t).toLowerCase()]}}(),align_text:function(){var e={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(t){return e[String(t).toLowerCase()]}}(),clear_br:function(){var e={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(t){return e[String(t).toLowerCase()]}}(),size_font:function(){var e={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(t){return e[String(t).charAt(0)]}}()},x={has_visible_contet:function(){var e,t=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"];return function(n){if(e=(n.innerText||n.textContent).replace(/\s/g,""),e&&e.length>0)return!0;for(var o=t.length;o--;)if(n.querySelector(t[o]))return!0;return n.offsetWidth&&n.offsetWidth>0&&n.offsetHeight&&n.offsetHeight>0?!0:!1}}()};return e}(),wysihtml5.dom.removeEmptyTextNodes=function(e){for(var t,n=wysihtml5.lang.array(e.childNodes).get(),o=n.length,i=0;o>i;i++)t=n[i],t.nodeType===wysihtml5.TEXT_NODE&&""===t.data&&t.parentNode.removeChild(t)},wysihtml5.dom.renameElement=function(e,t){for(var n,o=e.ownerDocument.createElement(t);n=e.firstChild;)o.appendChild(n);return wysihtml5.dom.copyAttributes(["align","className"]).from(e).to(o),e.parentNode.replaceChild(o,e),o},wysihtml5.dom.replaceWithChildNodes=function(e){if(e.parentNode){if(!e.firstChild)return void e.parentNode.removeChild(e);for(var t=e.ownerDocument.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e),e=t=null}},function(e){function t(t){return"block"===e.getStyle("display").from(t)}function n(e){return"BR"===e.nodeName}function o(e){var t=e.ownerDocument.createElement("br");e.appendChild(t)}function i(e,i){if(e.nodeName.match(/^(MENU|UL|OL)$/)){var r,s,a,l,c,d,u=e.ownerDocument,h=u.createDocumentFragment(),f=wysihtml5.dom.domNode(e).prev({ignoreBlankTexts:!0});if(i)for(!f||t(f)||n(f)||o(h);d=e.firstElementChild||e.firstChild;){for(s=d.lastChild;r=d.firstChild;)a=r===s,l=a&&!t(r)&&!n(r),h.appendChild(r),l&&o(h);d.parentNode.removeChild(d)}else for(;d=e.firstElementChild||e.firstChild;){if(d.querySelector&&d.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;r=d.firstChild;)h.appendChild(r);else{for(c=u.createElement("p");r=d.firstChild;)c.appendChild(r);h.appendChild(c)}d.parentNode.removeChild(d)}e.parentNode.replaceChild(h,e)}}e.resolveList=i}(wysihtml5.dom),function(e){var t=document,n=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],o=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],i=["referrer","write","open","close"];e.dom.Sandbox=Base.extend({constructor:function(t,n){this.callback=t||e.EMPTY_FUNCTION,this.config=e.lang.object({}).merge(n).get(),this.editableArea=this._createIframe()},insertInto:function(e){"string"==typeof e&&(e=t.getElementById(e)),e.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var e=this.getIframe();e.parentNode.removeChild(e)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var n=this,o=t.createElement("iframe");return o.className="wysihtml5-sandbox",e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(o),e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(o.src="javascript:'<html></html>'"),o.onload=function(){o.onreadystatechange=o.onload=null,n._onLoadIframe(o)},o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&(o.onreadystatechange=o.onload=null,n._onLoadIframe(o))},o},_onLoadIframe:function(r){if(e.dom.contains(t.documentElement,r)){var s=this,a=r.contentWindow,l=r.contentWindow.document,c=t.characterSet||t.charset||"utf-8",d=this._getHtml({charset:c,stylesheets:this.config.stylesheets});if(l.open("text/html","replace"),l.write(d),l.close(),this.getWindow=function(){return r.contentWindow},this.getDocument=function(){return r.contentWindow.document},a.onerror=function(e,t,n){throw new Error("wysihtml5.Sandbox: "+e,t,n)},!e.browser.supportsSandboxedIframes()){var u,h;for(u=0,h=n.length;h>u;u++)this._unset(a,n[u]);for(u=0,h=o.length;h>u;u++)this._unset(a,o[u],e.EMPTY_FUNCTION);for(u=0,h=i.length;h>u;u++)this._unset(l,i[u]);this._unset(l,"cookie","",!0)}this.loaded=!0,setTimeout(function(){s.callback(s)},0)}},_getHtml:function(t){var n,o=t.stylesheets,i="",r=0;if(o="string"==typeof o?[o]:o)for(n=o.length;n>r;r++)i+='<link rel="stylesheet" href="'+o[r]+'">';return t.stylesheets=i,e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(t)},_unset:function(t,n,o,i){try{t[n]=o}catch(r){}try{t.__defineGetter__(n,function(){return o})}catch(r){}if(i)try{t.__defineSetter__(n,function(){})}catch(r){}if(!e.browser.crashesWhenDefineProperty(n))try{var s={get:function(){return o}};i&&(s.set=function(){}),Object.defineProperty(t,n,s)}catch(r){}}})}(wysihtml5),function(e){var t=document;e.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(t,n,o){this.callback=t||e.EMPTY_FUNCTION,this.config=e.lang.object({}).merge(n).get(),o?this.element=this._bindElement(o):this.element=this._createElement()},_createElement:function(){var e=t.createElement("div");return e.className="wysihtml5-sandbox",this._loadElement(e),e},_bindElement:function(e){return e.className=e.className&&""!=e.className?e.className+" wysihtml5-sandbox":"wysihtml5-sandbox",this._loadElement(e,!0),e},_loadElement:function(e,t){var n=this;if(!t){var o=this._getHtml();e.innerHTML=o}this.getWindow=function(){return e.ownerDocument.defaultView},this.getDocument=function(){return e.ownerDocument},this.loaded=!0,setTimeout(function(){n.callback(n)},0)},_getHtml:function(e){return""}})}(wysihtml5),function(){var e={className:"class"};wysihtml5.dom.setAttributes=function(t){return{on:function(n){for(var o in t)n.setAttribute(e[o]||o,t[o])}}}}(),wysihtml5.dom.setStyles=function(e){return{on:function(t){var n=t.style;if("string"==typeof e)return void(n.cssText+=";"+e);for(var o in e)"float"===o?(n.cssFloat=e[o],n.styleFloat=e[o]):n[o]=e[o]}}},function(e){e.simulatePlaceholder=function(t,n,o){var i="placeholder",r=function(){var t=n.element.offsetWidth>0&&n.element.offsetHeight>0;n.hasPlaceholderSet()&&(n.clear(),n.element.focus(),t&&setTimeout(function(){var e=n.selection.getSelection();e.focusNode&&e.anchorNode||n.selection.selectNode(n.element.firstChild||n.element)},0)),n.placeholderSet=!1,e.removeClass(n.element,i)},s=function(){n.isEmpty()&&(n.placeholderSet=!0,n.setValue(o),e.addClass(n.element,i))};t.on("set_placeholder",s).on("unset_placeholder",r).on("focus:composer",r).on("paste:composer",r).on("blur:composer",s),s()}}(wysihtml5.dom),function(e){var t=document.documentElement;"textContent"in t?(e.setTextContent=function(e,t){e.textContent=t},e.getTextContent=function(e){return e.textContent}):"innerText"in t?(e.setTextContent=function(e,t){e.innerText=t},e.getTextContent=function(e){return e.innerText}):(e.setTextContent=function(e,t){e.nodeValue=t},e.getTextContent=function(e){return e.nodeValue})}(wysihtml5.dom),wysihtml5.dom.getAttribute=function(e,t){var n=!wysihtml5.browser.supportsGetAttributeCorrectly();t=t.toLowerCase();var o=e.nodeName;if("IMG"==o&&"src"==t&&_isLoadedImage(e)===!0)return e.src;if(n&&"outerHTML"in e){var i=e.outerHTML.toLowerCase(),r=-1!=i.indexOf(" "+t+"=");return r?e.getAttribute(t):null}return e.getAttribute(t)},function(e){function t(e,t){for(var n,o=[],i=0,r=e.length;r>i;i++)if(n=e[i].querySelectorAll(t))for(var s=n.length;s--;o.unshift(n[s]));return o}function n(e){e.parentNode.removeChild(e)}function o(e,t){e.parentNode.insertBefore(t,e.nextSibling)}function i(e,t){for(var n=e.nextSibling;1!=n.nodeType;)if(n=n.nextSibling,!t||t==n.tagName.toLowerCase())return n;return null}var r=e.dom,s=function(e){this.el=e,this.isColspan=!1,this.isRowspan=!1,this.firstCol=!0,this.lastCol=!0,this.firstRow=!0,this.lastRow=!0,this.isReal=!0,this.spanCollection=[],this.modified=!1},a=function(e,t){e?(this.cell=e,this.table=r.getParentElement(e,{nodeName:["TABLE"]})):t&&(this.table=t,this.cell=this.table.querySelectorAll("th, td")[0])};a.prototype={addSpannedCellToMap:function(e,t,n,o,i,r){for(var a=[],l=n+(r?parseInt(r,10)-1:0),c=o+(i?parseInt(i,10)-1:0),d=n;l>=d;d++){"undefined"==typeof t[d]&&(t[d]=[]);for(var u=o;c>=u;u++)t[d][u]=new s(e),t[d][u].isColspan=i&&parseInt(i,10)>1,t[d][u].isRowspan=r&&parseInt(r,10)>1,t[d][u].firstCol=u==o,t[d][u].lastCol=u==c,t[d][u].firstRow=d==n,t[d][u].lastRow=d==l,t[d][u].isReal=u==o&&d==n,t[d][u].spanCollection=a,a.push(t[d][u])}},setCellAsModified:function(e){if(e.modified=!0,e.spanCollection.length>0)for(var t=0,n=e.spanCollection.length;n>t;t++)e.spanCollection[t].modified=!0},setTableMap:function(){var e,t,n,o,i,a,l,c,d=[],u=this.getTableRows();for(e=0;e<u.length;e++)for(t=u[e],n=this.getRowCells(t),a=0,"undefined"==typeof d[e]&&(d[e]=[]),o=0;o<n.length;o++){for(i=n[o];"undefined"!=typeof d[e][a];)a++;l=r.getAttribute(i,"colspan"),c=r.getAttribute(i,"rowspan"),l||c?(this.addSpannedCellToMap(i,d,e,a,l,c),a+=l?parseInt(l,10):1):(d[e][a]=new s(i),a++)}return this.map=d,d},getRowCells:function(n){var o=this.table.querySelectorAll("table"),i=o?t(o,"th, td"):[],r=n.querySelectorAll("th, td"),s=i.length>0?e.lang.array(r).without(i):r;return s},getTableRows:function(){var n=this.table.querySelectorAll("table"),o=n?t(n,"tr"):[],i=this.table.querySelectorAll("tr"),r=o.length>0?e.lang.array(i).without(o):i;return r},getMapIndex:function(e){for(var t=this.map.length,n=this.map&&this.map[0]?this.map[0].length:0,o=0;t>o;o++)for(var i=0;n>i;i++)if(this.map[o][i].el===e)return{row:o,col:i};return!1},getElementAtIndex:function(e){return this.setTableMap(),this.map[e.row]&&this.map[e.row][e.col]&&this.map[e.row][e.col].el?this.map[e.row][e.col].el:null},getMapElsTo:function(e){var t=[];if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(e),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var n=this.idx_start;this.idx_start=this.idx_end,this.idx_end=n}if(this.idx_start.col>this.idx_end.col){var o=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=o}if(null!=this.idx_start&&null!=this.idx_end)for(var i=this.idx_start.row,r=this.idx_end.row;r>=i;i++)for(var s=this.idx_start.col,a=this.idx_end.col;a>=s;s++)t.push(this.map[i][s].el);return t},orderSelectionEnds:function(e){if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(e),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){
var t=this.idx_start;this.idx_start=this.idx_end,this.idx_end=t}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=n}return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(e,t,n){for(var o,i=this.table.ownerDocument,r=i.createDocumentFragment(),s=0;t>s;s++){if(o=i.createElement(e),n)for(var a in n)n.hasOwnProperty(a)&&o.setAttribute(a,n[a]);o.appendChild(document.createTextNode(" ")),r.appendChild(o)}return r},correctColIndexForUnreals:function(e,t){for(var n=this.map[t],o=-1,i=0;e>i;i++)n[i].isReal&&o++;return o},getLastNewCellOnRow:function(e,t){for(var n,o,i=this.getRowCells(e),r=0,s=i.length;s>r;r++)if(n=i[r],o=this.getMapIndex(n),o===!1||"undefined"!=typeof t&&o.row!=t)return n;return null},removeEmptyTable:function(){var e=this.table.querySelectorAll("td, th");return e&&0!=e.length?!1:(n(this.table),!0)},splitRowToCells:function(e){if(e.isColspan){var t=parseInt(r.getAttribute(e.el,"colspan")||1,10),n=e.el.tagName.toLowerCase();if(t>1){var i=this.createCells(n,t-1);o(e.el,i)}e.el.removeAttribute("colspan")}},getRealRowEl:function(e,t){var n=null,o=null;t=t||this.idx;for(var i=0,s=this.map[t.row].length;s>i;i++)if(o=this.map[t.row][i],o.isReal&&(n=r.getParentElement(o.el,{nodeName:["TR"]})))return n;return null===n&&e&&(n=r.getParentElement(this.map[t.row][t.col].el,{nodeName:["TR"]})||null),n},injectRowAt:function(e,t,n,i,s){var a=this.getRealRowEl(!1,{row:e,col:t}),l=this.createCells(i,n);if(a){var c=this.correctColIndexForUnreals(t,e);c>=0?o(this.getRowCells(a)[c],l):a.insertBefore(l,a.firstChild)}else{var d=this.table.ownerDocument.createElement("tr");d.appendChild(l),o(r.getParentElement(s.el,{nodeName:["TR"]}),d)}},canMerge:function(e){if(this.to=e,this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(this.to),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var t=this.idx_start;this.idx_start=this.idx_end,this.idx_end=t}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=n}for(var o=this.idx_start.row,i=this.idx_end.row;i>=o;o++)for(var r=this.idx_start.col,s=this.idx_end.col;s>=r;r++)if(this.map[o][r].isColspan||this.map[o][r].isRowspan)return!1;return!0},decreaseCellSpan:function(e,t){var n=parseInt(r.getAttribute(e.el,t),10)-1;n>=1?e.el.setAttribute(t,n):(e.el.removeAttribute(t),"colspan"==t&&(e.isColspan=!1),"rowspan"==t&&(e.isRowspan=!1),e.firstCol=!0,e.lastCol=!0,e.firstRow=!0,e.lastRow=!0,e.isReal=!0)},removeSurplusLines:function(){var e,t,o,i,s,a,l;if(this.setTableMap(),this.map){for(o=0,i=this.map.length;i>o;o++){for(e=this.map[o],l=!0,s=0,a=e.length;a>s;s++)if(t=e[s],!(r.getAttribute(t.el,"rowspan")&&parseInt(r.getAttribute(t.el,"rowspan"),10)>1&&t.firstRow!==!0)){l=!1;break}if(l)for(s=0;a>s;s++)this.decreaseCellSpan(e[s],"rowspan")}var c=this.getTableRows();for(o=0,i=c.length;i>o;o++)e=c[o],0==e.childNodes.length&&/^\s*$/.test(e.textContent||e.innerText)&&n(e)}},fillMissingCells:function(){var e=0,t=0,n=null;if(this.setTableMap(),this.map){e=this.map.length;for(var i=0;e>i;i++)this.map[i].length>t&&(t=this.map[i].length);for(var r=0;e>r;r++)for(var a=0;t>a;a++)this.map[r]&&!this.map[r][a]&&a>0&&(this.map[r][a]=new s(this.createCells("td",1)),n=this.map[r][a-1],n&&n.el&&n.el.parent&&o(this.map[r][a-1].el,this.map[r][a].el))}},rectify:function(){return this.removeEmptyTable()?!1:(this.removeSurplusLines(),this.fillMissingCells(),!0)},unmerge:function(){if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx)){var e=this.map[this.idx.row][this.idx.col],t=r.getAttribute(e.el,"colspan")?parseInt(r.getAttribute(e.el,"colspan"),10):1,n=e.el.tagName.toLowerCase();if(e.isRowspan){var o=parseInt(r.getAttribute(e.el,"rowspan"),10);if(o>1)for(var i=1,s=o-1;s>=i;i++)this.injectRowAt(this.idx.row+i,this.idx.col,t,n,e);e.el.removeAttribute("rowspan")}this.splitRowToCells(e)}},merge:function(e){if(this.rectify())if(this.canMerge(e)){for(var t=this.idx_end.row-this.idx_start.row+1,o=this.idx_end.col-this.idx_start.col+1,i=this.idx_start.row,r=this.idx_end.row;r>=i;i++)for(var s=this.idx_start.col,a=this.idx_end.col;a>=s;s++)i==this.idx_start.row&&s==this.idx_start.col?(t>1&&this.map[i][s].el.setAttribute("rowspan",t),o>1&&this.map[i][s].el.setAttribute("colspan",o)):(/^\s*<br\/?>\s*$/.test(this.map[i][s].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[i][s].el.innerHTML),n(this.map[i][s].el));this.rectify()}else window.console},collapseCellToNextRow:function(e){var t=this.getMapIndex(e.el),n=t.row+1,i={row:n,col:t.col};if(n<this.map.length){var s=this.getRealRowEl(!1,i);if(null!==s){var a=this.correctColIndexForUnreals(i.col,i.row);if(a>=0)o(this.getRowCells(s)[a],e.el);else{var l=this.getLastNewCellOnRow(s,n);null!==l?o(l,e.el):s.insertBefore(e.el,s.firstChild)}parseInt(r.getAttribute(e.el,"rowspan"),10)>2?e.el.setAttribute("rowspan",parseInt(r.getAttribute(e.el,"rowspan"),10)-1):e.el.removeAttribute("rowspan")}}},removeRowCell:function(e){e.isReal?e.isRowspan?this.collapseCellToNextRow(e):n(e.el):parseInt(r.getAttribute(e.el,"rowspan"),10)>2?e.el.setAttribute("rowspan",parseInt(r.getAttribute(e.el,"rowspan"),10)-1):e.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var e=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx!==!1)for(var t=this.map[this.idx.row],n=0,o=t.length;o>n;n++)t[n].isReal&&e.push(t[n].el);return e},getColumnElementsByCell:function(){var e=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx!==!1)for(var t=0,n=this.map.length;n>t;t++)this.map[t][this.idx.col]&&this.map[t][this.idx.col].isReal&&e.push(this.map[t][this.idx.col].el);return e},removeRow:function(){var e=r.getParentElement(this.cell,{nodeName:["TR"]});if(e){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx!==!1)for(var t=this.map[this.idx.row],o=0,i=t.length;i>o;o++)t[o].modified||(this.setCellAsModified(t[o]),this.removeRowCell(t[o]));n(e)}},removeColCell:function(e){e.isColspan?parseInt(r.getAttribute(e.el,"colspan"),10)>2?e.el.setAttribute("colspan",parseInt(r.getAttribute(e.el,"colspan"),10)-1):e.el.removeAttribute("colspan"):e.isReal&&n(e.el)},removeColumn:function(){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx!==!1)for(var e=0,t=this.map.length;t>e;e++)this.map[e][this.idx.col].modified||(this.setCellAsModified(this.map[e][this.idx.col]),this.removeColCell(this.map[e][this.idx.col]))},remove:function(e){if(this.rectify()){switch(e){case"row":this.removeRow();break;case"column":this.removeColumn()}this.rectify()}},addRow:function(e){var t=this.table.ownerDocument;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"below"==e&&r.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(r.getAttribute(this.cell,"rowspan"),10)-1),this.idx!==!1){for(var n=this.map[this.idx.row],i=t.createElement("tr"),s=0,a=n.length;a>s;s++)n[s].modified||(this.setCellAsModified(n[s]),this.addRowCell(n[s],i,e));switch(e){case"below":o(this.getRealRowEl(!0),i);break;case"above":var l=r.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]});l&&l.parentNode.insertBefore(i,l)}}},addRowCell:function(e,t,n){var o=e.isColspan?{colspan:r.getAttribute(e.el,"colspan")}:null;e.isReal?"above"!=n&&e.isRowspan?e.el.setAttribute("rowspan",parseInt(r.getAttribute(e.el,"rowspan"),10)+1):t.appendChild(this.createCells("td",1,o)):"above"!=n&&e.isRowspan&&e.lastRow?t.appendChild(this.createCells("td",1,o)):c.isRowspan&&e.el.attr("rowspan",parseInt(r.getAttribute(e.el,"rowspan"),10)+1)},add:function(e){this.rectify()&&(("below"==e||"above"==e)&&this.addRow(e),("before"==e||"after"==e)&&this.addColumn(e))},addColCell:function(e,t,n){var i,s=e.el.tagName.toLowerCase();switch(n){case"before":i=!e.isColspan||e.firstCol;break;case"after":i=!e.isColspan||e.lastCol||e.isColspan&&c.el==this.cell}if(i){switch(n){case"before":e.el.parentNode.insertBefore(this.createCells(s,1),e.el);break;case"after":o(e.el,this.createCells(s,1))}e.isRowspan&&this.handleCellAddWithRowspan(e,t+1,n)}else e.el.setAttribute("colspan",parseInt(r.getAttribute(e.el,"colspan"),10)+1)},addColumn:function(e){var t,n;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"after"==e&&r.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(r.getAttribute(this.cell,"colspan"),10)-1),this.idx!==!1)for(var o=0,i=this.map.length;i>o;o++)t=this.map[o],t[this.idx.col]&&(n=t[this.idx.col],n.modified||(this.setCellAsModified(n),this.addColCell(n,o,e)))},handleCellAddWithRowspan:function(e,t,n){for(var s,a,l,c=parseInt(r.getAttribute(this.cell,"rowspan"),10)-1,d=r.getParentElement(e.el,{nodeName:["TR"]}),u=e.el.tagName.toLowerCase(),h=this.table.ownerDocument,f=0;c>f;f++)if(s=this.correctColIndexForUnreals(this.idx.col,t+f),d=i(d,"tr"))if(s>0)switch(n){case"before":a=this.getRowCells(d),s>0&&this.map[t+f][this.idx.col].el!=a[s]&&s==a.length-1?o(a[s],this.createCells(u,1)):a[s].parentNode.insertBefore(this.createCells(u,1),a[s]);break;case"after":o(this.getRowCells(d)[s],this.createCells(u,1))}else d.insertBefore(this.createCells(u,1),d.firstChild);else l=h.createElement("tr"),l.appendChild(this.createCells(u,1)),this.table.appendChild(l)}},r.table={getCellsBetween:function(e,t){var n=new a(e);return n.getMapElsTo(t)},addCells:function(e,t){var n=new a(e);n.add(t)},removeCells:function(e,t){var n=new a(e);n.remove(t)},mergeCellsBetween:function(e,t){var n=new a(e);n.merge(t)},unmergeCell:function(e){var t=new a(e);t.unmerge()},orderSelectionEnds:function(e,t){var n=new a(e);return n.orderSelectionEnds(t)},indexOf:function(e){var t=new a(e);return t.setTableMap(),t.getMapIndex(e)},findCell:function(e,t){var n=new a(null,e);return n.getElementAtIndex(t)},findRowByCell:function(e){var t=new a(e);return t.getRowElementsByCell()},findColumnByCell:function(e){var t=new a(e);return t.getColumnElementsByCell()},canMerge:function(e,t){var n=new a(e);return n.canMerge(t)}}}(wysihtml5),wysihtml5.dom.query=function(e,t){var n,o=[];e.nodeType&&(e=[e]);for(var i=0,r=e.length;r>i;i++)if(n=e[i].querySelectorAll(t))for(var s=n.length;s--;o.unshift(n[s]));return o},wysihtml5.dom.compareDocumentPosition=function(){var e=document.documentElement;return e.compareDocumentPosition?function(e,t){return e.compareDocumentPosition(t)}:function(e,t){var n,o;if(n=9===e.nodeType?e:e.ownerDocument,o=9===t.nodeType?t:t.ownerDocument,e===t)return 0;if(e===t.ownerDocument)return 20;if(e.ownerDocument===t)return 10;if(n!==o)return 1;if(2===e.nodeType&&e.childNodes&&-1!==wysihtml5.lang.array(e.childNodes).indexOf(t))return 20;if(2===t.nodeType&&t.childNodes&&-1!==wysihtml5.lang.array(t.childNodes).indexOf(e))return 10;for(var i=e,r=[],s=null;i;){if(i==t)return 10;r.push(i),i=i.parentNode}for(i=t,s=null;i;){if(i==e)return 20;var a=wysihtml5.lang.array(r).indexOf(i);if(-1!==a){var l=r[a],c=wysihtml5.lang.array(l.childNodes).indexOf(r[a-1]),d=wysihtml5.lang.array(l.childNodes).indexOf(s);return c>d?2:4}s=i,i=i.parentNode}return 1}}(),wysihtml5.dom.unwrap=function(e){if(e.parentNode){for(;e.lastChild;)wysihtml5.dom.insert(e.lastChild).after(e);e.parentNode.removeChild(e)}},wysihtml5.quirks.cleanPastedHTML=function(){function e(e,n,o){n=n||t,o=o||e.ownerDocument||document;var i,r,s,a,l,c,d="string"==typeof e,u=0;i=d?wysihtml5.dom.getAsDom(e,o):e;for(l in n)for(s=i.querySelectorAll(l),r=n[l],a=s.length;a>u;u++)r(s[u]);var h=wysihtml5.dom.getTextNodes(i);for(c=h.length;c--;)h[c].nodeValue=h[c].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ");return s=e=n=null,d?i.innerHTML:i}var t={"a u":wysihtml5.dom.replaceWithChildNodes};return e}(),wysihtml5.quirks.ensureProperClearing=function(){var e=function(){var e=this;setTimeout(function(){var t=e.innerHTML.toLowerCase();("<p>&nbsp;</p>"==t||"<p>&nbsp;</p><p>&nbsp;</p>"==t)&&(e.innerHTML="")},0)};return function(t){wysihtml5.dom.observe(t.element,["cut","keydown"],e)}}(),function(e){var t="%7E";e.quirks.getCorrectInnerHTML=function(n){var o=n.innerHTML;if(-1===o.indexOf(t))return o;var i,r,s,a,l=n.querySelectorAll("[href*='~'], [src*='~']");for(a=0,s=l.length;s>a;a++)i=l[a].href||l[a].src,r=e.lang.string(i).replace("~").by(t),o=e.lang.string(o).replace(r).by(i);return o}}(wysihtml5),function(e){var t="wysihtml5-quirks-redraw";e.quirks.redraw=function(n){e.dom.addClass(n,t),e.dom.removeClass(n,t);try{var o=n.ownerDocument;o.execCommand("italic",!1,null),o.execCommand("italic",!1,null)}catch(i){}}}(wysihtml5),wysihtml5.quirks.tableCellsSelection=function(e,t){function n(){return d.observe(e,"mousedown",function(e){var t=wysihtml5.dom.getParentElement(e.target,{nodeName:["TD","TH"]});t&&o(t)}),u}function o(n){u.start=n,u.end=n,u.cells=[n],u.table=d.getParentElement(u.start,{nodeName:["TABLE"]}),u.table&&(i(),d.addClass(n,h),f=d.observe(e,"mousemove",s),p=d.observe(e,"mouseup",a),t.fire("tableselectstart").fire("tableselectstart:composer"))}function i(){if(e){var t=e.querySelectorAll("."+h);if(t.length>0)for(var n=0;n<t.length;n++)d.removeClass(t[n],h)}}function r(e){for(var t=0;t<e.length;t++)d.addClass(e[t],h)}function s(e){var n,o=null,s=d.getParentElement(e.target,{nodeName:["TD","TH"]});s&&u.table&&u.start&&(o=d.getParentElement(s,{nodeName:["TABLE"]}),o&&o===u.table&&(i(),n=u.end,u.end=s,u.cells=d.table.getCellsBetween(u.start,s),u.cells.length>1&&t.composer.selection.deselect(),r(u.cells),u.end!==n&&t.fire("tableselectchange").fire("tableselectchange:composer")))}function a(e){f.stop(),p.stop(),t.fire("tableselect").fire("tableselect:composer"),setTimeout(function(){l()},0)}function l(){var n=d.observe(e.ownerDocument,"click",function(e){n.stop(),d.getParentElement(e.target,{nodeName:["TABLE"]})!=u.table&&(i(),u.table=null,u.start=null,u.end=null,t.fire("tableunselect").fire("tableunselect:composer"))})}function c(e,n){u.start=e,u.end=n,u.table=d.getParentElement(u.start,{nodeName:["TABLE"]}),selectedCells=d.table.getCellsBetween(u.start,u.end),r(selectedCells),l(),t.fire("tableselect").fire("tableselect:composer")}var d=wysihtml5.dom,u={table:null,start:null,end:null,cells:null,select:c},h="wysiwyg-tmp-selected-cell",f=null,p=null;return n()},function(e){var t=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,n=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,o=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,i=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,r=function(e){return new RegExp("(^|\\s|;)"+e+"\\s*:\\s*[^;$]+","gi")};e.quirks.styleParser={parseColor:function(s,a){var l,c,d=r(a),u=s.match(d),h=10;if(u){for(var f=u.length;f--;)u[f]=e.lang.string(u[f].split(":")[1]).trim();if(l=u[u.length-1],t.test(l))c=l.match(t);else if(n.test(l))c=l.match(n);else if(o.test(l))c=l.match(o),h=16;else if(i.test(l))return c=l.match(i),c.shift(),c.push(1),e.lang.array(c).map(function(e,t){return 3>t?16*parseInt(e,16)+parseInt(e,16):parseFloat(e)});if(c)return c.shift(),c[3]||c.push(1),e.lang.array(c).map(function(e,t){return 3>t?parseInt(e,h):parseFloat(e)})}return!1},unparseColor:function(e,t){if(t){if("hex"==t)return e[0].toString(16).toUpperCase()+e[1].toString(16).toUpperCase()+e[2].toString(16).toUpperCase();if("hash"==t)return"#"+e[0].toString(16).toUpperCase()+e[1].toString(16).toUpperCase()+e[2].toString(16).toUpperCase();if("rgb"==t)return"rgb("+e[0]+","+e[1]+","+e[2]+")";if("rgba"==t)return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")";if("csv"==t)return e[0]+","+e[1]+","+e[2]+","+e[3]}return e[3]&&1!==e[3]?"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")":"rgb("+e[0]+","+e[1]+","+e[2]+")"},parseFontSize:function(t){var n=t.match(r("font-size"));return n?e.lang.string(n[n.length-1].split(":")[1]).trim():!1}}}(wysihtml5),function(e){function t(e){var t=0;if(e.parentNode)do t+=e.offsetTop||0,e=e.offsetParent;while(e);return t}function n(e,t){for(var n=0;t!==e;)if(n++,t=t.parentNode,!t)throw new Error("not a descendant of ancestor!");return n}function o(e){if(!e.canSurroundContents())for(var t=e.commonAncestorContainer,o=n(t,e.startContainer),i=n(t,e.endContainer);!e.canSurroundContents();)o>i?(e.setStartBefore(e.startContainer),o=n(t,e.startContainer)):(e.setEndAfter(e.endContainer),i=n(t,e.endContainer))}var i=e.dom;e.Selection=Base.extend({constructor:function(e,t,n){window.rangy.init(),this.editor=e,this.composer=e.composer,this.doc=this.composer.doc,this.contain=t,this.unselectableClass=n||!1},getBookmark:function(){var e=this.getRange();return e&&o(e),e&&e.cloneRange()},setBookmark:function(e){e&&this.setSelection(e)},setBefore:function(e){var t=rangy.createRange(this.doc);return t.setStartBefore(e),t.setEndBefore(e),this.setSelection(t)},setAfter:function(e){var t=rangy.createRange(this.doc);return t.setStartAfter(e),t.setEndAfter(e),this.setSelection(t)},selectNode:function(t,n){var o=rangy.createRange(this.doc),r=t.nodeType===e.ELEMENT_NODE,s="canHaveHTML"in t?t.canHaveHTML:"IMG"!==t.nodeName,a=r?t.innerHTML:t.data,l=""===a||a===e.INVISIBLE_SPACE,c=i.getStyle("display").from(t),d="block"===c||"list-item"===c;if(l&&r&&s&&!n)try{t.innerHTML=e.INVISIBLE_SPACE}catch(u){}s?o.selectNodeContents(t):o.selectNode(t),s&&l&&r?o.collapse(d):s&&l&&(o.setStartAfter(t),o.setEndAfter(t)),this.setSelection(o)},getSelectedNode:function(e){var t,n;return e&&this.doc.selection&&"Control"===this.doc.selection.type&&(n=this.doc.selection.createRange(),n&&n.length)?n.item(0):(t=this.getSelection(this.doc),t.focusNode===t.anchorNode?t.focusNode:(n=this.getRange(this.doc),n?n.commonAncestorContainer:this.doc.body))},fixSelBorders:function(){var e=this.getRange();o(e),this.setSelection(e)},getSelectedOwnNodes:function(e){for(var t=this.getOwnRanges(),n=[],o=0,i=t.length;i>o;o++)n.push(t[o].commonAncestorContainer||this.doc.body);return n},findNodesInSelection:function(t){for(var n,o=this.getOwnRanges(),i=[],r=0,s=o.length;s>r;r++)n=o[r].getNodes([1],function(n){return e.lang.array(t).contains(n.nodeName)}),i=i.concat(n);return i},containsUneditable:function(){for(var e=this.getOwnUneditables(),t=this.getSelection(),n=0,o=e.length;o>n;n++)if(t.containsNode(e[n]))return!0;return!1},deleteContents:function(){for(var e=this.getOwnRanges(),t=e.length;t--;)e[t].deleteContents();this.setSelection(e[0])},getPreviousNode:function(t,n){if(!t){var o=this.getSelection();t=o.anchorNode}if(t===this.contain)return!1;var i,r=t.previousSibling;return r===this.contain?!1:(r&&3!==r.nodeType&&1!==r.nodeType?r=this.getPreviousNode(r,n):r&&3===r.nodeType&&/^\s*$/.test(r.textContent)?r=this.getPreviousNode(r,n):n&&r&&1===r.nodeType&&!e.lang.array(["BR","HR","IMG"]).contains(r.nodeName)&&/^[\s]*$/.test(r.innerHTML)?r=this.getPreviousNode(r,n):r||t===this.contain||(i=t.parentNode,i!==this.contain&&(r=this.getPreviousNode(i,n))),r!==this.contain?r:!1)},getSelectionParentsByTag:function(t){for(var n,o=this.getSelectedOwnNodes(),i=[],r=0,s=o.length;s>r;r++)n=o[r].nodeName&&"LI"===o[r].nodeName?o[r]:e.dom.getParentElement(o[r],{nodeName:["LI"]},!1,this.contain),n&&i.push(n);return i.length?i:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var e=this.getRange(),t=e.startContainer,n=e.startOffset,o=rangy.createRange(this.doc);return o.selectNodeContents(t),o.setStart(t,n),o}},caretIsLastInSelection:function(){var e=(rangy.createRange(this.doc),this.getSelection(),this.getRangeToNodeEnd().cloneContents()),t=e.textContent;return/^\s*$/.test(t)},caretIsFirstInSelection:function(){var t=rangy.createRange(this.doc),n=this.getSelection(),o=this.getRange(),i=o.startContainer;return i.nodeType===e.TEXT_NODE?this.isCollapsed()&&i.nodeType===e.TEXT_NODE&&/^\s*$/.test(i.data.substr(0,o.startOffset)):(t.selectNodeContents(this.getRange().commonAncestorContainer),t.collapse(!0),this.isCollapsed()&&(t.startContainer===n.anchorNode||t.endContainer===n.anchorNode)&&t.startOffset===n.anchorOffset)},caretIsInTheBeginnig:function(t){var n=this.getSelection(),o=n.anchorNode,i=n.anchorOffset;return t?0===i&&(o.nodeName&&o.nodeName===t.toUpperCase()||e.dom.getParentElement(o.parentNode,{nodeName:t},1)):0===i&&!this.getPreviousNode(o,!0)},caretIsBeforeUneditable:function(){var e=this.getSelection(),t=e.anchorNode,n=e.anchorOffset;if(0===n){var o=this.getPreviousNode(t,!0);if(o)for(var i=this.getOwnUneditables(),r=0,s=i.length;s>r;r++)if(o===i[r])return i[r]}return!1},executeAndRestoreRangy:function(e,t){var n=this.doc.defaultView||this.doc.parentWindow,o=rangy.saveSelection(n);if(o)try{e()}catch(i){setTimeout(function(){throw i},0)}else e();rangy.restoreSelection(o)},executeAndRestore:function(t,n){var o,r,s,a,l,c,d,u,h=this.doc.body,f=n&&h.scrollTop,p=n&&h.scrollLeft,m="_wysihtml5-temp-placeholder",g='<span class="'+m+'">'+e.INVISIBLE_SPACE+"</span>",y=this.getRange(!0);if(!y)return void t(h,h);y.collapsed||(d=y.cloneRange(),c=d.createContextualFragment(g),d.collapse(!1),d.insertNode(c),d.detach()),l=y.createContextualFragment(g),y.insertNode(l),c&&(o=this.contain.querySelectorAll("."+m),y.setStartBefore(o[0]),y.setEndAfter(o[o.length-1])),this.setSelection(y);try{t(y.startContainer,y.endContainer)}catch(v){setTimeout(function(){throw v},0)}if(o=this.contain.querySelectorAll("."+m),o&&o.length){u=rangy.createRange(this.doc),s=o[0].nextSibling,o.length>1&&(a=o[o.length-1].previousSibling),a&&s?(u.setStartBefore(s),u.setEndAfter(a)):(r=this.doc.createTextNode(e.INVISIBLE_SPACE),i.insert(r).after(o[0]),u.setStartBefore(r),u.setEndAfter(r)),this.setSelection(u);for(var w=o.length;w--;)o[w].parentNode.removeChild(o[w])}else this.contain.focus();n&&(h.scrollTop=f,h.scrollLeft=p);try{o.parentNode.removeChild(o)}catch(b){}},set:function(e,t){var n=rangy.createRange(this.doc);n.setStart(e,t||0),this.setSelection(n)},insertHTML:function(e){var t=rangy.createRange(this.doc),n=t.createContextualFragment(e),o=n.lastChild;this.insertNode(n),o&&this.setAfter(o)},insertNode:function(e){var t=this.getRange();t&&t.insertNode(e)},surround:function(e){var t,n=this.getOwnRanges(),o=[];if(0==n.length)return o;for(var i=n.length;i--;){t=this.doc.createElement(e.nodeName),o.push(t),e.className&&(t.className=e.className),e.cssStyle&&t.setAttribute("style",e.cssStyle);try{n[i].surroundContents(t),this.selectNode(t)}catch(r){t.appendChild(n[i].extractContents()),n[i].insertNode(t)}}return o},deblockAndSurround:function(t){var n,o,i,r=this.doc.createElement("div"),s=rangy.createRange(this.doc);if(r.className=t.className,this.composer.commands.exec("formatBlock",t.nodeName,t.className),n=this.contain.querySelectorAll("."+t.className),n[0])for(n[0].parentNode.insertBefore(r,n[0]),s.setStartBefore(n[0]),s.setEndAfter(n[n.length-1]),o=s.extractContents();o.firstChild;)if(i=o.firstChild,1==i.nodeType&&e.dom.hasClass(i,t.className)){for(;i.firstChild;)r.appendChild(i.firstChild);"BR"!==i.nodeName&&r.appendChild(this.doc.createElement("br")),o.removeChild(i)}else r.appendChild(i);else r=null;return r},scrollIntoView:function(){var n,o=this.doc,i=5,r=o.documentElement.scrollHeight>o.documentElement.offsetHeight,s=o._wysihtml5ScrollIntoViewElement=o._wysihtml5ScrollIntoViewElement||function(){var t=o.createElement("span");return t.innerHTML=e.INVISIBLE_SPACE,t}();r&&(this.insertNode(s),n=t(s),s.parentNode.removeChild(s),n>=o.body.scrollTop+o.documentElement.offsetHeight-i&&(o.body.scrollTop=n))},selectLine:function(){e.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var e=this.doc.defaultView,t=e.getSelection();t.modify("move","left","lineboundary"),t.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var e,t,n,o,i,r=this.doc.selection.createRange(),s=r.boundingTop,a=this.doc.body.scrollWidth;if(r.moveToPoint){for(0===s&&(n=this.doc.createElement("span"),this.insertNode(n),s=n.offsetTop,n.parentNode.removeChild(n)),s+=1,o=-10;a>o;o+=2)try{r.moveToPoint(o,s);break}catch(l){}for(e=s,t=this.doc.selection.createRange(),i=a;i>=0;i--)try{t.moveToPoint(i,e);break}catch(c){}r.setEndPoint("EndToEnd",t),r.select()}},getText:function(){var e=this.getSelection();return e?e.toString():""},getNodes:function(e,t){var n=this.getRange();return n?n.getNodes([e],t):[]},fixRangeOverflow:function(e){if(this.contain&&this.contain.firstChild&&e){var t=e.compareNode(this.contain);if(2!==t)1===t&&e.setStartBefore(this.contain.firstChild),0===t&&e.setEndAfter(this.contain.lastChild),3===t&&(e.setStartBefore(this.contain.firstChild),e.setEndAfter(this.contain.lastChild));else if(this._detectInlineRangeProblems(e)){var n=e.endContainer.previousElementSibling;n&&e.setEnd(n,this._endOffsetForNode(n))}}},_endOffsetForNode:function(e){var t=document.createRange();return t.selectNodeContents(e),t.endOffset},_detectInlineRangeProblems:function(e){var t=i.compareDocumentPosition(e.startContainer,e.endContainer);return 0==e.endOffset&&4&t},getRange:function(e){var t=this.getSelection(),n=t&&t.rangeCount&&t.getRangeAt(0);return e!==!0&&this.fixRangeOverflow(n),n},getOwnUneditables:function(){var t=i.query(this.contain,"."+this.unselectableClass),n=i.query(t,"."+this.unselectableClass);return e.lang.array(t).without(n)},getOwnRanges:function(){var e,t=[],n=this.getRange();if(n&&t.push(n),this.unselectableClass&&this.contain&&n){var o,i=this.getOwnUneditables();if(i.length>0)for(var r=0,s=i.length;s>r;r++){e=[];for(var a=0,l=t.length;l>a;a++){if(t[a])switch(t[a].compareNode(i[r])){case 2:break;case 3:o=t[a].cloneRange(),o.setEndBefore(i[r]),e.push(o),o=t[a].cloneRange(),o.setStartAfter(i[r]),e.push(o);break;default:e.push(t[a])}t=e}}}return t},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(e){var t=this.doc.defaultView||this.doc.parentWindow,n=rangy.getSelection(t);return n.setSingleRange(e)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},isEndToEndInNode:function(t){var n=this.getRange(),o=n.commonAncestorContainer,i=n.startContainer,r=n.endContainer;if(o.nodeType===e.TEXT_NODE&&(o=o.parentNode),i.nodeType===e.TEXT_NODE&&!/^\s*$/.test(i.data.substr(n.startOffset)))return!1;if(r.nodeType===e.TEXT_NODE&&!/^\s*$/.test(r.data.substr(n.endOffset)))return!1;for(;i&&i!==o;){if(i.nodeType!==e.TEXT_NODE&&!e.dom.contains(o,i))return!1;if(e.dom.domNode(i).prev({ignoreBlankTexts:!0}))return!1;i=i.parentNode}for(;r&&r!==o;){if(r.nodeType!==e.TEXT_NODE&&!e.dom.contains(o,r))return!1;if(e.dom.domNode(r).next({ignoreBlankTexts:!0}))return!1;r=r.parentNode}return e.lang.array(t).contains(o.nodeName)?o:!1},deselect:function(){var e=this.getSelection();e&&e.removeAllRanges()}})}(wysihtml5),function(e,t){function n(e,t,n){if(!e.className)return!1;var o=e.className.match(n)||[];return o[o.length-1]===t}function o(e,t){if(!e.getAttribute||!e.getAttribute("style"))return!1;e.getAttribute("style").match(t);return e.getAttribute("style").match(t)?!0:!1}function i(e,t,n){e.getAttribute("style")?(a(e,n),e.getAttribute("style")&&!/^\s*$/.test(e.getAttribute("style"))?e.setAttribute("style",t+";"+e.getAttribute("style")):e.setAttribute("style",t)):e.setAttribute("style",t)}function r(e,t,n){e.className?(s(e,n),e.className+=" "+t):e.className=t}function s(e,t){e.className&&(e.className=e.className.replace(t,""))}function a(e,t){var n,o=[];if(e.getAttribute("style")){n=e.getAttribute("style").split(";");for(var i=n.length;i--;)n[i].match(t)||/^\s*$/.test(n[i])||o.push(n[i]);o.length?e.setAttribute("style",o.join(";")):e.removeAttribute("style")}}function l(e,t){var n=[],o=t.split(";"),i=e.getAttribute("style");if(i){i=i.replace(/\s/gi,"").toLowerCase(),n.push(new RegExp("(^|\\s|;)"+t.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var r=o.length;r-- >0;)/^\s*$/.test(o[r])||n.push(new RegExp("(^|\\s|;)"+o[r].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var s=0,a=n.length;a>s;s++)if(i.match(n[s]))return n[s]}return!1}function c(n,o,i,r){return i?l(n,i):r?e.dom.hasClass(n,r):t.dom.arrayContains(o,n.tagName.toLowerCase())}function d(e,t,n,o){for(var i=e.length;i--;)if(!c(e[i],t,n,o))return!1;return e.length?!0:!1}function u(e,t,n){var o=l(e,t);return o?(a(e,o),"remove"):(i(e,t,n),"change")}function h(e,t){return e.className.replace(b," ")==t.className.replace(b," ")}function f(e){for(var t=e.parentNode;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}function p(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,o,i,r=0,s=e.attributes.length;s>r;++r)if(n=e.attributes[r],i=n.name,"class"!=i){if(o=t.attributes.getNamedItem(i),n.specified!=o.specified)return!1;if(n.specified&&n.nodeValue!==o.nodeValue)return!1}return!0}function m(e,n){return t.dom.isCharacterDataNode(e)?0==n?!!e.previousSibling:n==e.length?!!e.nextSibling:!0:n>0&&n<e.childNodes.length}function g(e,n,o,i){var r;if(t.dom.isCharacterDataNode(n)&&(0==o?(o=t.dom.getNodeIndex(n),n=n.parentNode):o==n.length?(o=t.dom.getNodeIndex(n)+1,n=n.parentNode):r=t.dom.splitDataNode(n,o)),!(r||i&&n===i)){r=n.cloneNode(!1),r.id&&r.removeAttribute("id");for(var s;s=n.childNodes[o];)r.appendChild(s);t.dom.insertAfter(r,n)}return n==e?r:g(e,r.parentNode,t.dom.getNodeIndex(r),i)}function y(t){this.isElementMerge=t.nodeType==e.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?t.lastChild:t,this.textNodes=[this.firstTextNode]}function v(e,t,n,o,i,r,s){this.tagNames=e||[w],this.cssClass=t||(t===!1?!1:""),this.similarClassRegExp=n,this.cssStyle=i||"",this.similarStyleRegExp=r,this.normalize=o,this.applyToAnyTagName=!1,this.container=s}var w="span",b=/\s+/g;y.prototype={doMerge:function(){for(var e,t,n,o=[],i=0,r=this.textNodes.length;r>i;++i)e=this.textNodes[i],t=e.parentNode,o[i]=e.data,i&&(t.removeChild(e),t.hasChildNodes()||t.parentNode.removeChild(t));return this.firstTextNode.data=n=o.join(""),n},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;n>t;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}},v.prototype={getAncestorWithClass:function(o){for(var i;o;){if(i=this.cssClass?n(o,this.cssClass,this.similarClassRegExp):""!==this.cssStyle?!1:!0,o.nodeType==e.ELEMENT_NODE&&"false"!=o.getAttribute("contenteditable")&&t.dom.arrayContains(this.tagNames,o.tagName.toLowerCase())&&i)return o;o=o.parentNode}return!1},getAncestorWithStyle:function(n){for(var i;n;){if(i=this.cssStyle?o(n,this.similarStyleRegExp):!1,n.nodeType==e.ELEMENT_NODE&&"false"!=n.getAttribute("contenteditable")&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&i)return n;n=n.parentNode}return!1},getMatchingAncestor:function(e){var t=this.getAncestorWithClass(e),n=!1;return t?this.cssStyle&&(n="class"):(t=this.getAncestorWithStyle(e),t&&(n="style")),{element:t,type:n}},postApply:function(e,t){for(var n,o,i,r=e[0],s=e[e.length-1],a=[],l=r,c=s,d=0,u=s.length,h=0,f=e.length;f>h;++h)o=e[h],i=null,o&&o.parentNode&&(i=this.getAdjacentMergeableTextNode(o.parentNode,!1)),i?(n||(n=new y(i),a.push(n)),n.textNodes.push(o),o===r&&(l=n.firstTextNode,d=l.length),o===s&&(c=n.firstTextNode,u=n.getLength())):n=null;if(s&&s.parentNode){var p=this.getAdjacentMergeableTextNode(s.parentNode,!0);p&&(n||(n=new y(s),a.push(n)),n.textNodes.push(p))}if(a.length){for(h=0,f=a.length;f>h;++h)a[h].doMerge();t.setStart(l,d),t.setEnd(c,u)}},getAdjacentMergeableTextNode:function(t,n){var o,i=t.nodeType==e.TEXT_NODE,r=i?t.parentNode:t,s=n?"nextSibling":"previousSibling";if(i){if(o=t[s],o&&o.nodeType==e.TEXT_NODE)return o}else if(o=r[s],o&&this.areElementsMergeable(t,o))return o[n?"firstChild":"lastChild"];return null},areElementsMergeable:function(e,n){
return t.dom.arrayContains(this.tagNames,(e.tagName||"").toLowerCase())&&t.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&h(e,n)&&p(e,n)},createContainer:function(e){var t=e.createElement(this.tagNames[0]);return this.cssClass&&(t.className=this.cssClass),this.cssStyle&&t.setAttribute("style",this.cssStyle),t},applyToTextNode:function(e){var n=e.parentNode;if(1==n.childNodes.length&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase()))this.cssClass&&r(n,this.cssClass,this.similarClassRegExp),this.cssStyle&&i(n,this.cssStyle,this.similarStyleRegExp);else{var o=this.createContainer(t.dom.getDocument(e));e.parentNode.insertBefore(o,e),o.appendChild(e)}},isRemovable:function(n){return t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&""===e.lang.string(n.className).trim()&&(!n.getAttribute("style")||""===e.lang.string(n.getAttribute("style")).trim())},undoToTextNode:function(e,t,n,o){var i=n?!1:!0,r=n||o,a=!1;if(!t.containsNode(r)){var l=t.cloneRange();l.selectNode(r),l.isPointInRange(t.endContainer,t.endOffset)&&m(t.endContainer,t.endOffset)&&(g(r,t.endContainer,t.endOffset,this.container),t.setEndAfter(r)),l.isPointInRange(t.startContainer,t.startOffset)&&m(t.startContainer,t.startOffset)&&(r=g(r,t.startContainer,t.startOffset,this.container))}!i&&this.similarClassRegExp&&s(r,this.similarClassRegExp),i&&this.similarStyleRegExp&&(a="change"===u(r,this.cssStyle,this.similarStyleRegExp)),this.isRemovable(r)&&!a&&f(r)},applyToRange:function(t){for(var n,o=t.length;o--;){if(n=t[o].getNodes([e.TEXT_NODE]),!n.length)try{var i=this.createContainer(t[o].endContainer.ownerDocument);return t[o].surroundContents(i),void this.selectNode(t[o],i)}catch(r){}if(t[o].splitBoundaries(),n=t[o].getNodes([e.TEXT_NODE]),n.length){for(var s,a=0,l=n.length;l>a;++a)s=n[a],this.getMatchingAncestor(s).element||this.applyToTextNode(s);t[o].setStart(n[0],0),s=n[n.length-1],t[o].setEnd(s,s.length),this.normalize&&this.postApply(n,t[o])}}},undoToRange:function(t){for(var n,o,i,r=t.length;r--;){if(n=t[r].getNodes([e.TEXT_NODE]),n.length)t[r].splitBoundaries(),n=t[r].getNodes([e.TEXT_NODE]);else{var s=t[r].endContainer.ownerDocument,a=s.createTextNode(e.INVISIBLE_SPACE);t[r].insertNode(a),t[r].selectNode(a),n=[a]}for(var l=0,c=n.length;c>l;++l)t[r].isValid()&&(o=n[l],i=this.getMatchingAncestor(o),"style"===i.type?this.undoToTextNode(o,t[r],!1,i.element):i.element&&this.undoToTextNode(o,t[r],i.element));1==c?this.selectNode(t[r],n[0]):(t[r].setStart(n[0],0),o=n[n.length-1],t[r].setEnd(o,o.length),this.normalize&&this.postApply(n,t[r]))}},selectNode:function(t,n){var o=n.nodeType===e.ELEMENT_NODE,i="canHaveHTML"in n?n.canHaveHTML:!0,r=o?n.innerHTML:n.data,s=""===r||r===e.INVISIBLE_SPACE;if(s&&o&&i)try{n.innerHTML=e.INVISIBLE_SPACE}catch(a){}t.selectNodeContents(n),s&&o?t.collapse(!1):s&&(t.setStartAfter(n),t.setEndAfter(n))},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var o=n.intersection(t),i=o?o.toString():"";return n.detach(),i},isAppliedToRange:function(t){for(var n,o,i=[],r="full",s=t.length;s--;){if(o=t[s].getNodes([e.TEXT_NODE]),!o.length)return n=this.getMatchingAncestor(t[s].startContainer).element,n?{elements:[n],coverage:r}:!1;for(var a,l=0,c=o.length;c>l;++l)a=this.getTextSelectedByRange(o[l],t[s]),n=this.getMatchingAncestor(o[l]).element,n&&""!=a?(i.push(n),1===e.dom.getTextNodes(n,!0).length?r="full":"full"===r&&(r="inline")):n||(r="partial")}return i.length?{elements:i,coverage:r}:!1},toggleRange:function(e){var t,n=this.isAppliedToRange(e);n?"full"===n.coverage?this.undoToRange(e):"inline"===n.coverage?(t=d(n.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(e),t||this.applyToRange(e)):(d(n.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(e),this.applyToRange(e)):this.applyToRange(e)}},e.selection.HTMLApplier=v}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},support:function(e){return wysihtml5.browser.supportsCommand(this.doc,e)},exec:function(e,t){var n=wysihtml5.commands[e],o=wysihtml5.lang.array(arguments).get(),i=n&&n.exec,r=null;if(this.editor.fire("beforecommand:composer"),i)o.unshift(this.composer),r=i.apply(n,o);else try{r=this.doc.execCommand(e,!1,t)}catch(s){}return this.editor.fire("aftercommand:composer"),r},state:function(e,t){var n=wysihtml5.commands[e],o=wysihtml5.lang.array(arguments).get(),i=n&&n.state;if(i)return o.unshift(this.composer),i.apply(n,o);try{return this.doc.queryCommandState(e)}catch(r){return!1}},stateValue:function(e){var t=wysihtml5.commands[e],n=wysihtml5.lang.array(arguments).get(),o=t&&t.stateValue;return o?(n.unshift(this.composer),o.apply(t,n)):!1}}),wysihtml5.commands.bold={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"b")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"b")}},function(e){function t(t,n){var s,a,l,c,d,u,h,f,p,m=t.doc,g="_wysihtml5-temp-"+ +new Date,y=/non-matching-class/g,v=0;for(e.commands.formatInline.exec(t,o,i,g,y,o,o,!0,!0),a=m.querySelectorAll(i+"."+g),s=a.length;s>v;v++){l=a[v],l.removeAttribute("class");for(p in n)"text"!==p&&l.setAttribute(p,n[p])}u=l,1===s&&(h=r.getTextContent(l),c=!!l.querySelector("*"),d=""===h||h===e.INVISIBLE_SPACE,!c&&d&&(r.setTextContent(l,n.text||l.href),f=m.createTextNode(" "),t.selection.setAfter(l),r.insert(f).after(l),u=f)),t.selection.setAfter(u)}function n(e,t,n){for(var o,i=t.length;i--;){o=t[i].attributes;for(var r=o.length;r--;)t[i].removeAttribute(o.item(r).name);for(var s in n)n.hasOwnProperty(s)&&t[i].setAttribute(s,n[s])}}var o,i="A",r=e.dom;e.commands.createLink={exec:function(e,o,i){var r=this.state(e,o);r?e.selection.executeAndRestore(function(){n(e,r,i)}):(i="object"==typeof i?i:{href:i},t(e,i))},state:function(t,n){return e.commands.formatInline.state(t,n,"A")}}}(wysihtml5),function(e){function t(e,t){for(var o,i,r,s=t.length,a=0;s>a;a++)o=t[a],i=n.getParentElement(o,{nodeName:"code"}),r=n.getTextContent(o),r.match(n.autoLink.URL_REG_EXP)&&!i?i=n.renameElement(o,"code"):n.replaceWithChildNodes(o)}var n=e.dom;e.commands.removeLink={exec:function(e,n){var o=this.state(e,n);o&&e.selection.executeAndRestore(function(){t(e,o)})},state:function(t,n){return e.commands.formatInline.state(t,n,"A")}}}(wysihtml5),function(e){var t=/wysiwyg-font-size-[0-9a-z\-]+/g;e.commands.fontSize={exec:function(n,o,i){e.commands.formatInline.execWithToggle(n,o,"span","wysiwyg-font-size-"+i,t)},state:function(n,o,i){return e.commands.formatInline.state(n,o,"span","wysiwyg-font-size-"+i,t)}}}(wysihtml5),function(e){var t=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;e.commands.fontSizeStyle={exec:function(n,o,i){i="object"==typeof i?i.size:i,/^\s*$/.test(i)||e.commands.formatInline.execWithToggle(n,o,"span",!1,!1,"font-size:"+i,t)},state:function(n,o,i){return e.commands.formatInline.state(n,o,"span",!1,!1,"font-size",t)},stateValue:function(t,n){var o,i=this.state(t,n);return i&&e.lang.object(i).isArray()&&(i=i[0]),i&&(o=i.getAttribute("style"))?e.quirks.styleParser.parseFontSize(o):!1}}}(wysihtml5),function(e){var t=/wysiwyg-color-[0-9a-z]+/g;e.commands.foreColor={exec:function(n,o,i){e.commands.formatInline.execWithToggle(n,o,"span","wysiwyg-color-"+i,t)},state:function(n,o,i){return e.commands.formatInline.state(n,o,"span","wysiwyg-color-"+i,t)}}}(wysihtml5),function(e){var t=/(\s|^)color\s*:\s*[^;\s]+;?/gi;e.commands.foreColorStyle={exec:function(n,o,i){var r,s=e.quirks.styleParser.parseColor("object"==typeof i?"color:"+i.color:"color:"+i,"color");s&&(r="color: rgb("+s[0]+","+s[1]+","+s[2]+");",1!==s[3]&&(r+="color: rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+");"),e.commands.formatInline.execWithToggle(n,o,"span",!1,!1,r,t))},state:function(n,o){return e.commands.formatInline.state(n,o,"span",!1,!1,"color",t)},stateValue:function(t,n,o){var i,r=this.state(t,n);return r&&e.lang.object(r).isArray()&&(r=r[0]),r&&(i=r.getAttribute("style"),i&&i)?(val=e.quirks.styleParser.parseColor(i,"color"),e.quirks.styleParser.unparseColor(val,o)):!1}}}(wysihtml5),function(e){var t=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;e.commands.bgColorStyle={exec:function(n,o,i){var r,s=e.quirks.styleParser.parseColor("object"==typeof i?"background-color:"+i.color:"background-color:"+i,"background-color");s&&(r="background-color: rgb("+s[0]+","+s[1]+","+s[2]+");",1!==s[3]&&(r+="background-color: rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+");"),e.commands.formatInline.execWithToggle(n,o,"span",!1,!1,r,t))},state:function(n,o){return e.commands.formatInline.state(n,o,"span",!1,!1,"background-color",t)},stateValue:function(t,n,o){var i,r=this.state(t,n),s=!1;return r&&e.lang.object(r).isArray()&&(r=r[0]),r&&(i=r.getAttribute("style"))?(s=e.quirks.styleParser.parseColor(i,"background-color"),e.quirks.styleParser.unparseColor(s,o)):!1}}}(wysihtml5),function(e){function t(t,n,i){t.className?(o(t,i),t.className=e.lang.string(t.className+" "+n).trim()):t.className=n}function n(t,n,o){i(t,o),t.getAttribute("style")?t.setAttribute("style",e.lang.string(t.getAttribute("style")+" "+n).trim()):t.setAttribute("style",n)}function o(t,n){var o=n.test(t.className);return t.className=t.className.replace(n,""),""==e.lang.string(t.className).trim()&&t.removeAttribute("class"),o}function i(t,n){var o=n.test(t.getAttribute("style"));return t.setAttribute("style",(t.getAttribute("style")||"").replace(n,"")),""==e.lang.string(t.getAttribute("style")||"").trim()&&t.removeAttribute("style"),o}function r(e){var t=e.lastChild;t&&s(t)&&t.parentNode.removeChild(t)}function s(e){return"BR"===e.nodeName}function a(t,n){t.selection.isCollapsed()&&t.selection.selectLine();for(var o=t.selection.surround(n),i=0,s=o.length;s>i;i++)e.dom.lineBreaks(o[i]).remove(),r(o[i])}function l(t){return!!e.lang.string(t.className).trim()}function c(t){return!!e.lang.string(t.getAttribute("style")||"").trim()}var d=e.dom,u=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];e.commands.formatBlock={exec:function(r,s,h,f,p,m,g){var y,v,w,b,C,x=(r.doc,this.state(r,s,h,f,p,m,g)),E=r.config.useLineBreaks,N=E?"DIV":"P";return h="string"==typeof h?h.toUpperCase():h,x.length?void r.selection.executeAndRestoreRangy(function(){for(var t=x.length;t--;){if(p&&(v=o(x[t],p)),g&&(b=i(x[t],g)),(b||v)&&null===h&&x[t].nodeName!=N)return;var n=l(x[t]),r=c(x[t]);n||r||!E&&"P"!==h?d.renameElement(x[t],"P"===h?"DIV":N):(e.dom.lineBreaks(x[t]).add(),d.replaceWithChildNodes(x[t]))}}):void((null!==h&&!e.lang.array(u).contains(h)||(y=r.selection.findNodesInSelection(u).concat(r.selection.getSelectedOwnNodes()),r.selection.executeAndRestoreRangy(function(){for(var e=y.length;e--;)C=d.getParentElement(y[e],{nodeName:u}),C==r.element&&(C=null),C&&(h&&(C=d.renameElement(C,h)),f&&t(C,f,p),m&&n(C,m,g),w=!0)}),!w))&&a(r,{nodeName:h||N,className:f||null,cssStyle:m||null}))},state:function(t,n,o,i,r,s,a){var l,c=t.selection.getSelectedOwnNodes(),u=[];o="string"==typeof o?o.toUpperCase():o;for(var h=0,f=c.length;f>h;h++)l=d.getParentElement(c[h],{nodeName:o,className:i,classRegExp:r,cssStyle:s,styleRegExp:a}),l&&-1==e.lang.array(u).indexOf(l)&&u.push(l);return 0==u.length?!1:u}}}(wysihtml5),wysihtml5.commands.formatCode={exec:function(e,t,n){var o,i,r,s=this.state(e);s?e.selection.executeAndRestore(function(){o=s.querySelector("code"),wysihtml5.dom.replaceWithChildNodes(s),o&&wysihtml5.dom.replaceWithChildNodes(o)}):(i=e.selection.getRange(),r=i.extractContents(),s=e.doc.createElement("pre"),o=e.doc.createElement("code"),n&&(o.className=n),s.appendChild(o),o.appendChild(r),i.insertNode(s),e.selection.selectNode(s))},state:function(e){var t=e.selection.getSelectedNode();return t&&t.nodeName&&"PRE"==t.nodeName&&t.firstChild&&t.firstChild.nodeName&&"CODE"==t.firstChild.nodeName?t:wysihtml5.dom.getParentElement(t,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(t,{nodeName:"PRE"})}},function(e){function t(e){var t=o[e];return t?[e.toLowerCase(),t.toLowerCase()]:[e.toLowerCase()]}function n(n,o,r,s,a,l){var c=n;return o&&(c+=":"+o),s&&(c+=":"+s),i[c]||(i[c]=new e.selection.HTMLApplier(t(n),o,r,!0,s,a,l)),i[c]}var o={strong:"b",em:"i",b:"strong",i:"em"},i={};e.commands.formatInline={exec:function(e,t,o,i,r,s,a,l,c){var d=e.selection.createRange(),u=e.selection.getOwnRanges();return u&&0!=u.length?(e.selection.getSelection().removeAllRanges(),n(o,i,r,s,a,e.element).toggleRange(u),void(l?c||e.cleanUp():(d.setStart(u[0].startContainer,u[0].startOffset),d.setEnd(u[u.length-1].endContainer,u[u.length-1].endOffset),e.selection.setSelection(d),e.selection.executeAndRestore(function(){c||e.cleanUp()},!0,!0)))):!1},execWithToggle:function(t,n,o,i,r,s,a){var l=this;if(this.state(t,n,o,i,r,s,a)&&t.selection.isCollapsed()&&!t.selection.caretIsLastInSelection()&&!t.selection.caretIsFirstInSelection()){var c=l.state(t,n,o,i,r)[0];t.selection.executeAndRestoreRangy(function(){c.parentNode;t.selection.selectNode(c,!0),e.commands.formatInline.exec(t,n,o,i,r,s,a,!0,!0)})}else this.state(t,n,o,i,r,s,a)&&!t.selection.isCollapsed()?t.selection.executeAndRestoreRangy(function(){e.commands.formatInline.exec(t,n,o,i,r,s,a,!0,!0)}):e.commands.formatInline.exec(t,n,o,i,r,s,a)},state:function(t,i,r,s,a,l,c){var d,u,h=t.doc,f=o[r]||r;return e.dom.hasElementWithTagName(h,r)||e.dom.hasElementWithTagName(h,f)?s&&!e.dom.hasElementWithClassName(h,s)?!1:(d=t.selection.getOwnRanges(),d&&0!==d.length?(u=n(r,s,a,l,c,t.element).isAppliedToRange(d),u&&u.elements?u.elements:!1):!1):!1}}}(wysihtml5),function(e){e.commands.insertBlockQuote={exec:function(t,n){var o=this.state(t,n),i=t.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]);t.selection.executeAndRestore(function(){if(o)t.config.useLineBreaks&&e.dom.lineBreaks(o).add(),e.dom.unwrap(o);else if(t.selection.isCollapsed()&&t.selection.selectLine(),i){var n=i.ownerDocument.createElement("blockquote");e.dom.insert(n).after(i),n.appendChild(i)}else t.selection.surround({nodeName:"blockquote"})})},state:function(t,n){var o=t.selection.getSelectedNode(),i=e.dom.getParentElement(o,{nodeName:"BLOCKQUOTE"},!1,t.element);return i?i:!1}}}(wysihtml5),wysihtml5.commands.insertHTML={exec:function(e,t,n){e.commands.support(t)?e.doc.execCommand(t,!1,n):e.selection.insertHTML(n)},state:function(){return!1}},function(e){var t="IMG";e.commands.insertImage={exec:function(n,o,i){i="object"==typeof i?i:{src:i};var r,s,a=n.doc,l=this.state(n);if(l)return n.selection.setBefore(l),s=l.parentNode,s.removeChild(l),e.dom.removeEmptyTextNodes(s),"A"!==s.nodeName||s.firstChild||(n.selection.setAfter(s),s.parentNode.removeChild(s)),void e.quirks.redraw(n.element);l=a.createElement(t);for(var c in i)l.setAttribute("className"===c?"class":c,i[c]);n.selection.insertNode(l),e.browser.hasProblemsSettingCaretAfterImg()?(r=a.createTextNode(e.INVISIBLE_SPACE),n.selection.insertNode(r),n.selection.setAfter(r)):n.selection.setAfter(l)},state:function(n){var o,i,r,s=n.doc;return e.dom.hasElementWithTagName(s,t)&&(o=n.selection.getSelectedNode())?o.nodeName===t?o:o.nodeType!==e.ELEMENT_NODE?!1:(i=n.selection.getText(),(i=e.lang.string(i).trim())?!1:(r=n.selection.getNodes(e.ELEMENT_NODE,function(e){return"IMG"===e.nodeName}),1!==r.length?!1:r[0])):!1}}}(wysihtml5),function(e){var t="<br>"+(e.browser.needsSpaceAfterLineBreak()?" ":"");e.commands.insertLineBreak={exec:function(n,o){n.commands.support(o)?(n.doc.execCommand(o,!1,null),e.browser.autoScrollsToCaret()||n.selection.scrollIntoView()):n.commands.exec("insertHTML",t)},state:function(){return!1}}}(wysihtml5),wysihtml5.commands.insertOrderedList={exec:function(e,t){wysihtml5.commands.insertList.exec(e,t,"OL")},state:function(e,t){return wysihtml5.commands.insertList.state(e,t,"OL")}},wysihtml5.commands.insertUnorderedList={exec:function(e,t){wysihtml5.commands.insertList.exec(e,t,"UL")},state:function(e,t){return wysihtml5.commands.insertList.state(e,t,"UL")}},wysihtml5.commands.insertList=function(e){var t=function(e,t){if(e&&e.nodeName){"string"==typeof t&&(t=[t]);for(var n=t.length;n--;)if(e.nodeName===t[n])return!0}return!1},n=function(n,o,i){var r={el:null,other:!1};if(n){var s=e.dom.getParentElement(n,{nodeName:"LI"}),a="UL"===o?"OL":"UL";t(n,o)?r.el=n:t(n,a)?r={el:n,other:!0}:s&&(t(s.parentNode,o)?r.el=s.parentNode:t(s.parentNode,a)&&(r={el:s.parentNode,other:!0}))}return r.el&&!i.element.contains(r.el)&&(r.el=null),r},o=function(t,n,o){var i,s="UL"===n?"OL":"UL";o.selection.executeAndRestore(function(){var a=r(s,o);if(a.length)for(var l=a.length;l--;)e.dom.renameElement(a[l],n.toLowerCase());else{i=r(["OL","UL"],o);for(var c=i.length;c--;)e.dom.resolveList(i[c],o.config.useLineBreaks);e.dom.resolveList(t,o.config.useLineBreaks)}})},i=function(t,n,o){var i="UL"===n?"OL":"UL";o.selection.executeAndRestore(function(){for(var s=[t].concat(r(i,o)),a=s.length;a--;)e.dom.renameElement(s[a],n.toLowerCase())})},r=function(e,n){for(var o=n.selection.getOwnRanges(),i=[],r=o.length;r--;)i=i.concat(o[r].getNodes([1],function(n){return t(n,e)}));return i},s=function(t,n){n.selection.executeAndRestoreRangy(function(){var o,i,r="_wysihtml5-temp-"+(new Date).getTime(),s=n.selection.deblockAndSurround({nodeName:"div",className:r}),a=/\uFEFF/g;s.innerHTML=s.innerHTML.replace(a,""),s&&(o=e.lang.array(["","<br>",e.INVISIBLE_SPACE]).contains(s.innerHTML),i=e.dom.convertToList(s,t.toLowerCase(),n.parent.config.uneditableContainerClassname),o&&n.selection.selectNode(i.querySelector("li"),!0))})};return{exec:function(e,t,r){var a=e.doc,l="OL"===r?"insertOrderedList":"insertUnorderedList",c=e.selection.getSelectedNode(),d=n(c,r,e);d.el?d.other?i(d.el,r,e):o(d.el,r,e):e.commands.support(l)?a.execCommand(l,!1,null):s(r,e)},state:function(e,t,o){var i=e.selection.getSelectedNode(),r=n(i,o,e);return r.el&&!r.other?r.el:!1}}}(wysihtml5),wysihtml5.commands.italic={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"i")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"i")}},function(e){var t="wysiwyg-text-align-center",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyCenter={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-left",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyLeft={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-right",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyRight={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-justify",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyFull={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="text-align: right;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;e.commands.alignRightStyle={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,null,null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,null,null,t,n)}}}(wysihtml5),function(e){var t="text-align: left;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;e.commands.alignLeftStyle={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,null,null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,null,null,t,n)}}}(wysihtml5),function(e){var t="text-align: center;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;e.commands.alignCenterStyle={exec:function(o,i){return e.commands.formatBlock.exec(o,"formatBlock",null,null,null,t,n)},state:function(o,i){return e.commands.formatBlock.state(o,"formatBlock",null,null,null,t,n)}}}(wysihtml5),wysihtml5.commands.redo={exec:function(e){return e.undoManager.redo()},state:function(e){return!1}},wysihtml5.commands.underline={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"u")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"u")}},wysihtml5.commands.undo={exec:function(e){return e.undoManager.undo()},state:function(e){return!1}},wysihtml5.commands.createTable={exec:function(e,t,n){var o,i,r;if(n&&n.cols&&n.rows&&parseInt(n.cols,10)>0&&parseInt(n.rows,10)>0){for(r=n.tableStyle?'<table style="'+n.tableStyle+'">':"<table>",r+="<tbody>",i=0;i<n.rows;i++){for(r+="<tr>",o=0;o<n.cols;o++)r+="<td>&nbsp;</td>";r+="</tr>"}r+="</tbody></table>",e.commands.exec("insertHTML",r)}},state:function(e,t){return!1}},wysihtml5.commands.mergeTableCells={exec:function(e,t){e.tableSelection&&e.tableSelection.start&&e.tableSelection.end&&(this.state(e,t)?wysihtml5.dom.table.unmergeCell(e.tableSelection.start):wysihtml5.dom.table.mergeCellsBetween(e.tableSelection.start,e.tableSelection.end))},state:function(e,t){if(e.tableSelection){var n=e.tableSelection.start,o=e.tableSelection.end;if(n&&o&&n==o&&(wysihtml5.dom.getAttribute(n,"colspan")&&parseInt(wysihtml5.dom.getAttribute(n,"colspan"),10)>1||wysihtml5.dom.getAttribute(n,"rowspan")&&parseInt(wysihtml5.dom.getAttribute(n,"rowspan"),10)>1))return[n]}return!1}},wysihtml5.commands.addTableCells={exec:function(e,t,n){if(e.tableSelection&&e.tableSelection.start&&e.tableSelection.end){var o=wysihtml5.dom.table.orderSelectionEnds(e.tableSelection.start,e.tableSelection.end);"before"==n||"above"==n?wysihtml5.dom.table.addCells(o.start,n):("after"==n||"below"==n)&&wysihtml5.dom.table.addCells(o.end,n),setTimeout(function(){e.tableSelection.select(o.start,o.end)},0)}},state:function(e,t){return!1}},wysihtml5.commands.deleteTableCells={exec:function(e,t,n){if(e.tableSelection&&e.tableSelection.start&&e.tableSelection.end){var o,i=wysihtml5.dom.table.orderSelectionEnds(e.tableSelection.start,e.tableSelection.end),r=wysihtml5.dom.table.indexOf(i.start),s=e.tableSelection.table;wysihtml5.dom.table.removeCells(i.start,n),setTimeout(function(){o=wysihtml5.dom.table.findCell(s,r),o||("row"==n&&(o=wysihtml5.dom.table.findCell(s,{row:r.row-1,col:r.col})),"column"==n&&(o=wysihtml5.dom.table.findCell(s,{row:r.row,col:r.col-1}))),o&&e.tableSelection.select(o,o)},0)}},state:function(e,t){return!1}},wysihtml5.commands.indentList={exec:function(e,t,n){var o=e.selection.getSelectionParentsByTag("LI");return o?this.tryToPushLiLevel(o,e.selection):!1},state:function(e,t){return!1},tryToPushLiLevel:function(e,t){var n,o,i,r,s,a=!1;return t.executeAndRestoreRangy(function(){for(var t=e.length;t--;)r=e[t],n="OL"===r.parentNode.nodeName?"OL":"UL",o=r.ownerDocument.createElement(n),i=wysihtml5.dom.domNode(r).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]}),s=i?i.querySelector("ul, ol"):null,i&&(s?s.appendChild(r):(o.appendChild(r),i.appendChild(o)),a=!0)}),a}},wysihtml5.commands.outdentList={exec:function(e,t,n){var o=e.selection.getSelectionParentsByTag("LI");return o?this.tryToPullLiLevel(o,e):!1},state:function(e,t){return!1},tryToPullLiLevel:function(e,t){var n,o,i,r,s,a=!1,l=this;return t.selection.executeAndRestoreRangy(function(){for(var c=e.length;c--;)if(r=e[c],r.parentNode&&(n=r.parentNode,"OL"===n.tagName||"UL"===n.tagName)){if(a=!0,o=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["OL","UL"]},!1,t.element),i=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["LI"]},!1,t.element),o&&i)r.nextSibling&&(s=l.getAfterList(n,r),r.appendChild(s)),o.insertBefore(r,i.nextSibling);else{r.nextSibling&&(s=l.getAfterList(n,r),r.appendChild(s));for(var d=r.childNodes.length;d--;)n.parentNode.insertBefore(r.childNodes[d],n.nextSibling);n.parentNode.insertBefore(document.createElement("br"),n.nextSibling),r.parentNode.removeChild(r)}0===n.childNodes.length&&n.parentNode.removeChild(n)}}),a},getAfterList:function(e,t){for(var n=e.nodeName,o=document.createElement(n);t.nextSibling;)o.appendChild(t.nextSibling);return o}},function(e){var t=90,n=89,o=8,i=46,r=25,s="data-wysihtml5-selection-node",a="data-wysihtml5-selection-offset",l=('<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",'<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",e.dom);e.UndoManager=e.lang.Dispatcher.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var e,r=this;this.composer.sandbox.getDocument();l.observe(this.element,"keydown",function(e){if(!e.altKey&&(e.ctrlKey||e.metaKey)){var o=e.keyCode,i=o===t&&!e.shiftKey,s=o===t&&e.shiftKey||o===n;i?(r.undo(),e.preventDefault()):s&&(r.redo(),e.preventDefault())}}),l.observe(this.element,"keydown",function(t){var n=t.keyCode;n!==e&&(e=n,(n===o||n===i)&&r.transact())}),this.editor.on("newword:composer",function(){r.transact()}).on("beforecommand:composer",function(){r.transact()})},transact:function(){var t,n,o,i,l,c=this.historyStr[this.position-1],d=this.composer.getValue(!1,!1),u=this.element.offsetWidth>0&&this.element.offsetHeight>0;if(d!==c){var h=this.historyStr.length=this.historyDom.length=this.position;h>r&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++,u&&(t=this.composer.selection.getRange(),n=t&&t.startContainer?t.startContainer:this.element,o=t&&t.startOffset?t.startOffset:0,n.nodeType===e.ELEMENT_NODE?i=n:(i=n.parentNode,l=this.getChildNodeIndex(i,n)),i.setAttribute(a,o),"undefined"!=typeof l&&i.setAttribute(s,l));var f=this.element.cloneNode(!!d);this.historyDom.push(f),this.historyStr.push(d),i&&(i.removeAttribute(a),i.removeAttribute(s))}},undo:function(){this.transact(),this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(e){this.element.innerHTML="";for(var t=0,n=e.childNodes,o=e.childNodes.length;o>t;t++)this.element.appendChild(n[t].cloneNode(!0));var i,r,l;e.hasAttribute(a)?(i=e.getAttribute(a),l=e.getAttribute(s),r=this.element):(r=this.element.querySelector("["+a+"]")||this.element,i=r.getAttribute(a),l=r.getAttribute(s),r.removeAttribute(a),r.removeAttribute(s)),null!==l&&(r=this.getChildNodeByIndex(r,+l)),this.composer.selection.set(r,i)},getChildNodeIndex:function(e,t){for(var n=0,o=e.childNodes,i=o.length;i>n;n++)if(o[n]===t)return n},getChildNodeByIndex:function(e,t){return e.childNodes[t]}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(e,t,n){this.parent=e,this.element=t,this.config=n,this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var e=this;this.parent.on("beforeload",function(){e.parent.on("change_view",function(t){t===e.name?(e.parent.currentView=e,e.show(),setTimeout(function(){e.focus()},0)):e.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(e){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(e){var t=e.dom,n=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,t,n){this.base(e,t,n),this.config.noTextarea?this.editableArea=t:this.textarea=this.parent.textarea,this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=n.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(t,n){var o=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);return t!==!1&&(o=this.parent.parse(o,n===!1?!1:!0)),o},setValue:function(e,t){t&&(e=this.parent.parse(e));try{this.element.innerHTML=e}catch(n){this.element.innerText=e}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"",this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=t.getStyle("display").from(this.editableArea),"none"===this._displayStyle&&(this._displayStyle=null),this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(t){e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var n=this.element.lastChild;t&&n&&this.selection&&("BR"===n.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return t.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(e)||""===e||"<br>"===e||"<p></p>"===e||"<p><br></p>"===e||this.hasPlaceholderSet()},_initContentEditableArea:function(){var e=this;this.config.noTextarea?this.sandbox=new t.ContentEditableArea(function(){e._create()},{},this.editableArea):(this.sandbox=new t.ContentEditableArea(function(){e._create()}),this.editableArea=this.sandbox.getContentEditable(),t.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var e=this;this.sandbox=new t.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets}),this.editableArea=this.sandbox.getIframe();var n=this.textarea.element;t.insert(this.editableArea).after(n),this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var e=document.createElement("input");e.type="hidden",e.name="_wysihtml5_mode",e.value=1,t.insert(e).after(this.textarea.element)}},_create:function(){var o=this;this.doc=this.sandbox.getDocument(),this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body,this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1)),this.selection=new e.Selection(this.parent,this.element,this.config.uneditableContainerClassname),this.commands=new e.Commands(this.parent),this.config.noTextarea||t.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),t.addClass(this.element,this.config.composerClassName),this.config.style&&!this.config.contentEditableMode&&this.style(),this.observe();var i=this.config.name;i&&(t.addClass(this.element,i),this.config.contentEditableMode||t.addClass(this.editableArea,i)),this.enable(),!this.config.noTextarea&&this.textarea.element.disabled&&this.disable();var r="string"==typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder");r&&t.simulatePlaceholder(this.parent,this,r),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||n.isIos()||setTimeout(function(){o.focus(!0)},100),n.clearsContentEditableCorrectly()||e.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.config.noTextarea||this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){
var o=this,i=n.canDisableAutoLinking(),r=n.doesAutoLinkingInContentEditable();if(i&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink){(!r||r&&i)&&(this.parent.on("newword:composer",function(){t.getTextContent(o.element).match(t.autoLink.URL_REG_EXP)&&o.selection.executeAndRestore(function(n,i){for(var r=o.element.querySelectorAll("."+o.config.uneditableContainerClassname),s=!1,a=r.length;a--;)e.dom.contains(r[a],i)&&(s=!0);s||t.autoLink(i.parentNode,[o.config.uneditableContainerClassname])})}),t.observe(this.element,"blur",function(){t.autoLink(o.element,[o.config.uneditableContainerClassname])}));var s=this.sandbox.getDocument().getElementsByTagName("a"),a=t.autoLink.URL_REG_EXP,l=function(n){var o=e.lang.string(t.getTextContent(n)).trim();return"www."===o.substr(0,4)&&(o="http://"+o),o};t.observe(this.element,"keydown",function(e){if(s.length){var n,i=o.selection.getSelectedNode(e.target.ownerDocument),r=t.getParentElement(i,{nodeName:"A"},4);r&&(n=l(r),setTimeout(function(){var e=l(r);e!==n&&e.match(a)&&r.setAttribute("href",e)},0))}})}},_initObjectResizing:function(){if(this.commands.exec("enableObjectResizing",!0),n.supportsEvent("resizeend")){var o=["width","height"],i=o.length,r=this.element;t.observe(r,"resizeend",function(t){var n,s=t.target||t.srcElement,a=s.style,l=0;if("IMG"===s.nodeName){for(;i>l;l++)n=o[l],a[n]&&(s.setAttribute(n,parseInt(a[n],10)),a[n]="");e.quirks.redraw(r)}})}},_initUndoManager:function(){this.undoManager=new e.UndoManager(this.parent)},_initLineBreaking:function(){function o(e){var n=t.getParentElement(e,{nodeName:["P","DIV"]},2);n&&t.contains(i.element,n)&&i.selection.executeAndRestore(function(){i.config.useLineBreaks?t.replaceWithChildNodes(n):"P"!==n.nodeName&&t.renameElement(n,"p")})}var i=this,r=["LI","P","H1","H2","H3","H4","H5","H6"],s=["UL","OL","MENU"];this.config.useLineBreaks||t.observe(this.element,["focus","keydown"],function(){if(i.isEmpty()){var e=i.doc.createElement("P");i.element.innerHTML="",i.element.appendChild(e),n.displaysCaretInEmptyContentEditableCorrectly()?i.selection.selectNode(e,!0):(e.innerHTML="<br>",i.selection.setBefore(e.firstChild))}}),t.observe(this.element,"keydown",function(n){var a=n.keyCode;if(!n.shiftKey&&(a===e.ENTER_KEY||a===e.BACKSPACE_KEY)){var l=t.getParentElement(i.selection.getSelectedNode(),{nodeName:r},4);return l?void setTimeout(function(){var n,r=i.selection.getSelectedNode();if("LI"===l.nodeName){if(!r)return;n=t.getParentElement(r,{nodeName:s},2),n||o(r)}a===e.ENTER_KEY&&l.nodeName.match(/^H[1-6]$/)&&o(r)},0):void(i.config.useLineBreaks&&a===e.ENTER_KEY&&!e.browser.insertsLineBreaksOnReturn()&&(n.preventDefault(),i.commands.exec("insertLineBreak")))}})}})}(wysihtml5),function(e){var t=e.dom,n=document,o=window,i=n.createElement("div"),r=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],s=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],a=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",e.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],l=function(e){if(e.setActive)try{e.setActive()}catch(i){}else{var r=e.style,s=n.documentElement.scrollTop||n.body.scrollTop,a=n.documentElement.scrollLeft||n.body.scrollLeft,l={position:r.position,top:r.top,left:r.left,WebkitUserSelect:r.WebkitUserSelect};t.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(e),e.focus(),t.setStyles(l).on(e),o.scrollTo&&o.scrollTo(a,s)}};e.views.Composer.prototype.style=function(){var o,c=this,d=n.querySelector(":focus"),u=this.textarea.element,h=u.hasAttribute("placeholder"),f=h&&u.getAttribute("placeholder"),p=u.style.display,m=u.disabled;this.focusStylesHost=i.cloneNode(!1),this.blurStylesHost=i.cloneNode(!1),this.disabledStylesHost=i.cloneNode(!1),h&&u.removeAttribute("placeholder"),u===d&&u.blur(),u.disabled=!1,u.style.display=o="none",(u.getAttribute("rows")&&"auto"===t.getStyle("height").from(u)||u.getAttribute("cols")&&"auto"===t.getStyle("width").from(u))&&(u.style.display=o=p),t.copyStyles(s).from(u).to(this.editableArea).andTo(this.blurStylesHost),t.copyStyles(r).from(u).to(this.element).andTo(this.blurStylesHost),t.insertCSS(a).into(this.element.ownerDocument),u.disabled=!0,t.copyStyles(s).from(u).to(this.disabledStylesHost),t.copyStyles(r).from(u).to(this.disabledStylesHost),u.disabled=m,u.style.display=p,l(u),u.style.display=o,t.copyStyles(s).from(u).to(this.focusStylesHost),t.copyStyles(r).from(u).to(this.focusStylesHost),u.style.display=p,t.copyStyles(["display"]).from(u).to(this.editableArea);var g=e.lang.array(s).without(["display"]);return d?d.focus():u.blur(),h&&u.setAttribute("placeholder",f),this.parent.on("focus:composer",function(){t.copyStyles(g).from(c.focusStylesHost).to(c.editableArea),t.copyStyles(r).from(c.focusStylesHost).to(c.element)}),this.parent.on("blur:composer",function(){t.copyStyles(g).from(c.blurStylesHost).to(c.editableArea),t.copyStyles(r).from(c.blurStylesHost).to(c.element)}),this.parent.observe("disable:composer",function(){t.copyStyles(g).from(c.disabledStylesHost).to(c.editableArea),t.copyStyles(r).from(c.disabledStylesHost).to(c.element)}),this.parent.observe("enable:composer",function(){t.copyStyles(g).from(c.blurStylesHost).to(c.editableArea),t.copyStyles(r).from(c.blurStylesHost).to(c.element)}),this}}(wysihtml5),function(e){var t=e.dom,n=e.browser,o={66:"bold",73:"italic",85:"underline"},i=function(e,t,n){var o=e.getPreviousNode(t,!0),i=e.getSelectedNode();if(1!==i.nodeType&&i.parentNode!==n&&(i=i.parentNode),o)if(1==i.nodeType){var r=i.firstChild;if(1==o.nodeType)for(;i.firstChild;)o.appendChild(i.firstChild);else for(;i.firstChild;)t.parentNode.insertBefore(i.firstChild,t);i.parentNode&&i.parentNode.removeChild(i),e.setBefore(r)}else 1==o.nodeType?o.appendChild(i):t.parentNode.insertBefore(i,t),e.setBefore(i)},r=function(e,t,n,o){if(t.isCollapsed())if(t.caretIsInTheBeginnig("LI"))e.preventDefault(),o.commands.exec("outdentList");else if(t.caretIsInTheBeginnig())e.preventDefault();else{if(t.caretIsFirstInSelection()&&t.getPreviousNode()&&t.getPreviousNode().nodeName&&/^H\d$/gi.test(t.getPreviousNode().nodeName)){var r=t.getPreviousNode();if(e.preventDefault(),/^\s*$/.test(r.textContent||r.innerText))r.parentNode.removeChild(r);else{var s=r.ownerDocument.createRange();s.selectNodeContents(r),s.collapse(!1),t.setSelection(s)}}var a=t.caretIsBeforeUneditable();a&&(e.preventDefault(),i(t,a,n))}else t.containsUneditable()&&(e.preventDefault(),t.deleteContents())},s=function(e,t){if(e.selection.isCollapsed()){if(e.selection.caretIsInTheBeginnig("LI")&&e.commands.exec("indentList"))return}else e.selection.deleteContents();e.commands.exec("insertHTML","&emsp;")};e.views.Composer.prototype.observe=function(){var i=this,a=this.getValue(!1,!1),l=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),c=this.element,d=n.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?c:this.sandbox.getWindow(),u=["drop","paste"],h=["drop","paste","mouseup","focus","keyup"];if(t.observe(l,"DOMNodeRemoved",function(){clearInterval(f),i.parent.fire("destroy:composer")}),!n.supportsMutationEvents())var f=setInterval(function(){t.contains(document.documentElement,l)||(clearInterval(f),i.parent.fire("destroy:composer"))},250);t.observe(d,h,function(){setTimeout(function(){i.parent.fire("interaction").fire("interaction:composer")},0)}),this.config.handleTables&&(!this.tableClickHandle&&this.doc.execCommand&&e.browser.supportsCommand(this.doc,"enableObjectResizing")&&e.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?this.tableClickHandle=t.observe(l,["focus","mouseup","mouseover"],function(){i.doc.execCommand("enableObjectResizing",!1,"false"),i.doc.execCommand("enableInlineTableEditing",!1,"false"),i.tableClickHandle.stop()}):setTimeout(function(){i.doc.execCommand("enableObjectResizing",!1,"false"),i.doc.execCommand("enableInlineTableEditing",!1,"false")},0)),this.tableSelection=e.quirks.tableCellsSelection(c,i.parent)),t.observe(d,"focus",function(e){i.parent.fire("focus",e).fire("focus:composer",e),setTimeout(function(){a=i.getValue(!1,!1)},0)}),t.observe(d,"blur",function(e){if(a!==i.getValue(!1,!1)){var t=e;"function"==typeof Object.create&&(t=Object.create(e,{type:{value:"change"}})),i.parent.fire("change",t).fire("change:composer",t)}i.parent.fire("blur",e).fire("blur:composer",e)}),t.observe(c,"dragenter",function(){i.parent.fire("unset_placeholder")}),t.observe(c,u,function(e){setTimeout(function(){i.parent.fire(e.type,e).fire(e.type+":composer",e)},0)}),t.observe(c,"keyup",function(t){var n=t.keyCode;(n===e.SPACE_KEY||n===e.ENTER_KEY)&&i.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){i.parent.fire("newword:composer")},0)}),n.canSelectImagesInContentEditable()||t.observe(c,"mousedown",function(t){var n=t.target,o=c.querySelectorAll("img"),r=c.querySelectorAll("."+i.config.uneditableContainerClassname+" img"),s=e.lang.array(o).without(r);"IMG"===n.nodeName&&e.lang.array(s).contains(n)&&i.selection.selectNode(n)}),n.canSelectImagesInContentEditable()||t.observe(c,"drop",function(e){setTimeout(function(){i.selection.getSelection().removeAllRanges()},0)}),n.hasHistoryIssue()&&n.supportsSelectionModify()&&t.observe(c,"keydown",function(e){if(e.metaKey||e.ctrlKey){var t=e.keyCode,n=c.ownerDocument.defaultView,o=n.getSelection();(37===t||39===t)&&(37===t&&(o.modify("extend","left","lineboundary"),e.shiftKey||o.collapseToStart()),39===t&&(o.modify("extend","right","lineboundary"),e.shiftKey||o.collapseToEnd()),e.preventDefault())}}),t.observe(c,"keydown",function(e){var t=e.keyCode,n=o[t];(e.ctrlKey||e.metaKey)&&!e.altKey&&n&&(i.commands.exec(n),e.preventDefault()),8===t?r(e,i.selection,c,i):i.config.handleTabKey&&9===t&&(e.preventDefault(),s(i,c))}),t.observe(c,"keydown",function(t){var n,o=i.selection.getSelectedNode(!0),r=t.keyCode;!o||"IMG"!==o.nodeName||r!==e.BACKSPACE_KEY&&r!==e.DELETE_KEY||(n=o.parentNode,n.removeChild(o),"A"!==n.nodeName||n.firstChild||n.parentNode.removeChild(n),setTimeout(function(){e.quirks.redraw(c)},0),t.preventDefault())}),!this.config.contentEditableMode&&n.hasIframeFocusIssue()&&(t.observe(l,"focus",function(){setTimeout(function(){i.doc.querySelector(":focus")!==i.element&&i.focus()},0)}),t.observe(this.element,"blur",function(){setTimeout(function(){i.selection.getSelection().removeAllRanges()},0)}));var p={IMG:"Image: ",A:"Link: "};t.observe(c,"mouseover",function(e){var t,n=e.target,o=n.nodeName;if("A"===o||"IMG"===o){var i=n.hasAttribute("title");i||(t=p[o]+(n.getAttribute("href")||n.getAttribute("src")),n.setAttribute("title",t))}})}}(wysihtml5),function(e){var t=400;e.views.Synchronizer=Base.extend({constructor:function(e,t,n){this.editor=e,this.textarea=t,this.composer=n,this._observe()},fromComposerToTextarea:function(t){this.textarea.setValue(e.lang.string(this.composer.getValue(!1,!1)).trim(),t)},fromTextareaToComposer:function(e){var t=this.textarea.getValue(!1,!1);t?this.composer.setValue(t,e):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(e){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(e):this.fromComposerToTextarea(e)},_observe:function(){var n,o=this,i=this.textarea.element.form,r=function(){n=setInterval(function(){o.fromComposerToTextarea()},t)},s=function(){clearInterval(n),n=null};r(),i&&(e.dom.observe(i,"submit",function(){o.sync(!0)}),e.dom.observe(i,"reset",function(){setTimeout(function(){o.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(e){"composer"!==e||n?"textarea"===e&&(o.fromComposerToTextarea(!0),s()):(o.fromTextareaToComposer(!0),r())}),this.editor.on("destroy:composer",s)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,t,n){this.base(e,t,n),this._observe()},clear:function(){this.element.value=""},getValue:function(e){var t=this.isEmpty()?"":this.element.value;return e!==!1&&(t=this.parent.parse(t)),t},setValue:function(e,t){t&&(e=this.parent.parse(e)),this.element.value=e},cleanUp:function(){var e=this.parent.parse(this.element.value);this.element.value=e},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),t=this.element.getAttribute("placeholder")||null,n=this.element.value,o=!n;return e&&o||n===t},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var e=this.element,t=this.parent,n={focusin:"focus",focusout:"blur"},o=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];t.on("beforeload",function(){wysihtml5.dom.observe(e,o,function(e){var o=n[e.type]||e.type;t.fire(o).fire(o+":textarea")}),wysihtml5.dom.observe(e,["paste","drop"],function(){setTimeout(function(){t.fire("paste").fire("paste:textarea")},0)})})}}),function(e){var t,n={name:t,style:!0,toolbar:t,showToolbarAfterInit:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:e.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:t,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,uneditableContainerClassname:"wysihtml5-uneditable-container"};e.Editor=e.lang.Dispatcher.extend({constructor:function(t,o){if(this.editableElement="string"==typeof t?document.getElementById(t):t,this.config=e.lang.object({}).merge(n).merge(o).get(),this._isCompatible=e.browser.supported(),"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0),this.config.noTextarea||(this.textarea=new e.views.Textarea(this,this.editableElement,this.config),this.currentView=this.textarea),!this._isCompatible||!this.config.supportTouchDevices&&e.browser.isTouchDevice()){var i=this;return void setTimeout(function(){i.fire("beforeload").fire("load")},0)}e.dom.addClass(document.body,this.config.bodyClassName),this.composer=new e.views.Composer(this,this.editableElement,this.config),this.currentView=this.composer,"function"==typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea||(this.synchronizer=new e.views.Synchronizer(this,this.textarea,this.composer)),this.config.toolbar&&(this.toolbar=new e.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(e,t){return this.currentView.getValue(e,t)},setValue:function(e,t){return this.fire("unset_placeholder"),e?(this.currentView.setValue(e,t),this):this.clear()},cleanUp:function(){this.currentView.cleanUp()},focus:function(e){return this.currentView.focus(e),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(t,n){var o=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,i=this.config.parser(t,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:o,uneditableClass:this.config.uneditableContainerClassname,clearInternals:n});return"object"==typeof t&&e.quirks.redraw(t),i},_initParser:function(){this.on("paste:composer",function(){var t=!0,n=this;n.composer.selection.executeAndRestore(function(){e.quirks.cleanPastedHTML(n.composer.element),n.parse(n.composer.element)},t)})}})}(wysihtml5),function(e){var t=e.dom,n="wysihtml5-command-dialog-opened",o="input, select, textarea",i="[data-wysihtml5-dialog-field]",r="data-wysihtml5-dialog-field";e.toolbar.Dialog=e.lang.Dispatcher.extend({constructor:function(e,t){this.link=e,this.container=t},_observe:function(){if(!this._observed){var i=this,r=function(e){var t=i._serialize();t==i.elementToChange?i.fire("edit",t):i.fire("save",t),i.hide(),e.preventDefault(),e.stopPropagation()};t.observe(i.link,"click",function(){t.hasClass(i.link,n)&&setTimeout(function(){i.hide()},0)}),t.observe(this.container,"keydown",function(t){var n=t.keyCode;n===e.ENTER_KEY&&r(t),n===e.ESCAPE_KEY&&(i.fire("cancel"),i.hide())}),t.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",r),t.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){i.fire("cancel"),i.hide(),e.preventDefault(),e.stopPropagation()});for(var s=this.container.querySelectorAll(o),a=0,l=s.length,c=function(){clearInterval(i.interval)};l>a;a++)t.observe(s[a],"change",c);this._observed=!0}},_serialize:function(){for(var e=this.elementToChange||{},t=this.container.querySelectorAll(i),n=t.length,o=0;n>o;o++)e[t[o].getAttribute(r)]=t[o].value;return e},_interpolate:function(e){for(var t,n,o,s=document.querySelector(":focus"),a=this.container.querySelectorAll(i),l=a.length,c=0;l>c;c++)t=a[c],t!==s&&(e&&"hidden"===t.type||(n=t.getAttribute(r),o=this.elementToChange&&"boolean"!=typeof this.elementToChange?this.elementToChange.getAttribute(n)||"":t.defaultValue,t.value=o))},show:function(e){if(!t.hasClass(this.link,n)){var i=this,r=this.container.querySelector(o);if(this.elementToChange=e,this._observe(),this._interpolate(),e&&(this.interval=setInterval(function(){i._interpolate(!0)},500)),t.addClass(this.link,n),this.container.style.display="",this.fire("show"),r&&!e)try{r.focus()}catch(s){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,t.removeClass(this.link,n),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(e){var t=e.dom,n={position:"relative"},o={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},i={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},r={"x-webkit-speech":"",speech:""};e.toolbar.Speech=function(s,a){var l=document.createElement("input");if(!e.browser.supportsSpeechApiOn(l))return void(a.style.display="none");var c=s.editor.textarea.element.getAttribute("lang");c&&(r.lang=c);var d=document.createElement("div");e.lang.object(o).merge({width:a.offsetWidth+"px",height:a.offsetHeight+"px"}),t.insert(l).into(d),t.insert(d).into(a),t.setStyles(i).on(l),t.setAttributes(r).on(l),t.setStyles(o).on(d),t.setStyles(n).on(a);var u="onwebkitspeechchange"in l?"webkitspeechchange":"speechchange";t.observe(l,u,function(){s.execCommand("insertText",l.value),l.value=""}),t.observe(l,"click",function(e){t.hasClass(a,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}}(wysihtml5),function(e){var t="wysihtml5-command-disabled",n="wysihtml5-commands-disabled",o="wysihtml5-command-active",i="wysihtml5-action-active",r=e.dom;e.toolbar.Toolbar=Base.extend({constructor:function(t,n,o){this.editor=t,this.container="string"==typeof n?document.getElementById(n):n,this.composer=t.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),o&&this.show();for(var i=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),r=i.length,s=0;r>s;s++)new e.toolbar.Speech(this,i[s])},_getLinks:function(t){for(var n,o,i,r,s,a=this[t+"Links"]=e.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+t+"]")).get(),l=a.length,c=0,d=this[t+"Mapping"]={};l>c;c++)n=a[c],i=n.getAttribute("data-wysihtml5-"+t),r=n.getAttribute("data-wysihtml5-"+t+"-value"),o=this.container.querySelector("[data-wysihtml5-"+t+"-group='"+i+"']"),s=this._getDialog(n,i),d[i+":"+r]={link:n,group:o,name:i,value:r,dialog:s,state:!1}},_getDialog:function(t,n){var o,i,r=this,s=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']");return s&&(o=e.toolbar["Dialog_"+n]?new e.toolbar["Dialog_"+n](t,s):new e.toolbar.Dialog(t,s),o.on("show",function(){i=r.composer.selection.getBookmark(),r.editor.fire("show:dialog",{command:n,dialogContainer:s,commandLink:t})}),o.on("save",function(e){i&&r.composer.selection.setBookmark(i),r._execCommand(n,e),r.editor.fire("save:dialog",{command:n,dialogContainer:s,commandLink:t})}),o.on("cancel",function(){r.editor.focus(!1),r.editor.fire("cancel:dialog",{command:n,dialogContainer:s,commandLink:t})})),o},execCommand:function(e,t){if(!this.commandsDisabled){var n=this.commandMapping[e+":"+t];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(e,t)}},_execCommand:function(e,t){this.editor.focus(!1),this.composer.commands.exec(e,t),this._updateLinkStates()},execAction:function(e){var t=this.editor;"change_view"===e&&t.textarea&&(t.currentView===t.textarea?t.fire("change_view","composer"):t.fire("change_view","textarea")),"showSource"==e&&t.fire("showSource")},_observe:function(){for(var e=this,t=this.editor,o=this.container,i=this.commandLinks.concat(this.actionLinks),s=i.length,a=0;s>a;a++)"A"===i[a].nodeName?r.setAttributes({href:"javascript:;",unselectable:"on"}).on(i[a]):r.setAttributes({unselectable:"on"}).on(i[a]);r.delegate(o,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(e){e.preventDefault()}),r.delegate(o,"[data-wysihtml5-command]","click",function(t){var n=this,o=n.getAttribute("data-wysihtml5-command"),i=n.getAttribute("data-wysihtml5-command-value");e.execCommand(o,i),t.preventDefault()}),r.delegate(o,"[data-wysihtml5-action]","click",function(t){var n=this.getAttribute("data-wysihtml5-action");e.execAction(n),t.preventDefault()}),t.on("interaction:composer",function(){e._updateLinkStates()}),t.on("focus:composer",function(){e.bookmark=null}),this.editor.config.handleTables&&(t.on("tableselect:composer",function(){e.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),t.on("tableunselect:composer",function(){e.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})),t.on("change_view",function(i){t.textarea&&setTimeout(function(){e.commandsDisabled="composer"!==i,e._updateLinkStates(),e.commandsDisabled?r.addClass(o,n):r.removeClass(o,n)},0)})},_updateLinkStates:function(){var n,s,a,l,c=this.commandMapping,d=this.actionMapping;for(n in c)l=c[n],this.commandsDisabled?(s=!1,r.removeClass(l.link,o),l.group&&r.removeClass(l.group,o),l.dialog&&l.dialog.hide()):(s=this.composer.commands.state(l.name,l.value),r.removeClass(l.link,t),l.group&&r.removeClass(l.group,t)),l.state!==s&&(l.state=s,s?(r.addClass(l.link,o),l.group&&r.addClass(l.group,o),l.dialog&&("object"==typeof s||e.lang.object(s).isArray()?(!l.dialog.multiselect&&e.lang.object(s).isArray()&&(s=1===s.length?s[0]:!0,l.state=s),l.dialog.show(s)):l.dialog.hide())):(r.removeClass(l.link,o),l.group&&r.removeClass(l.group,o),l.dialog&&l.dialog.hide()));for(n in d)a=d[n],"change_view"===a.name&&(a.state=this.editor.currentView===this.editor.textarea,a.state?r.addClass(a.link,i):r.removeClass(a.link,i))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(e){e.toolbar.Dialog_createTable=e.toolbar.Dialog.extend({show:function(e){this.base(e)}})}(wysihtml5),function(e){var t=(e.dom,"[data-wysihtml5-dialog-field]"),n="data-wysihtml5-dialog-field";e.toolbar.Dialog_foreColorStyle=e.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var e={},o=this.container.querySelectorAll(t),i=o.length,r=0;i>r;r++)e[o[r].getAttribute(n)]=o[r].value;return e},_interpolate:function(o){for(var i,r=document.querySelector(":focus"),s=this.container.querySelectorAll(t),a=s.length,l=0,c=this.elementToChange?e.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,d=c?c.getAttribute("style"):null,u=d?e.quirks.styleParser.parseColor(d,"color"):null;a>l;l++)i=s[l],i!==r&&(o&&"hidden"===i.type||"color"===i.getAttribute(n)&&(u?u[3]&&1!=u[3]?i.value="rgba("+u[0]+","+u[1]+","+u[2]+","+u[3]+");":i.value="rgb("+u[0]+","+u[1]+","+u[2]+");":i.value="rgb(0,0,0);"))}})}(wysihtml5),function(e){e.dom;e.toolbar.Dialog_fontSizeStyle=e.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(t){var n=document.querySelector(":focus"),o=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),i=this.elementToChange?e.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,r=i?i.getAttribute("style"):null,s=r?e.quirks.styleParser.parseFontSize(r):null;o&&o!==n&&s&&!/^\s*$/.test(s)&&(o.value=s)}})}(wysihtml5);var Handlebars=function(){var e=function(){"use strict";function e(e){this.string=e}var t;return e.prototype.toString=function(){return""+this.string},t=e}(),t=function(e){"use strict";function t(e){return a[e]||"&amp;"}function n(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function o(e){return e instanceof s?e.toString():e||0===e?(e=""+e,c.test(e)?e.replace(l,t):e):""}function i(e){return e||0===e?h(e)&&0===e.length?!0:!1:!0}var r={},s=e,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,c=/[&<>"'`]/;r.extend=n;var d=Object.prototype.toString;r.toString=d;var u=function(e){return"function"==typeof e};u(/x/)&&(u=function(e){return"function"==typeof e&&"[object Function]"===d.call(e)});var u;r.isFunction=u;var h=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===d.call(e):!1};return r.isArray=h,r.escapeExpression=o,r.isEmpty=i,r}(e),n=function(){"use strict";function e(e,t){var o;t&&t.firstLine&&(o=t.firstLine,e+=" - "+o+":"+t.firstColumn);for(var i=Error.prototype.constructor.call(this,e),r=0;r<n.length;r++)this[n[r]]=i[n[r]];o&&(this.lineNumber=o,this.column=t.firstColumn)}var t,n=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,t=e}(),o=function(e,t){"use strict";function n(e,t){this.helpers=e||{},this.partials=t||{},o(this)}function o(e){e.registerHelper("helperMissing",function(e){if(2!==arguments.length)throw new a("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var o=n.inverse||function(){},i=n.fn;return h(t)&&(t=t.call(this)),t===!0?i(this):t===!1||null==t?o(this):u(t)?t.length>0?e.helpers.each(t,n):o(this):i(t)}),e.registerHelper("each",function(e,t){var n,o=t.fn,i=t.inverse,r=0,s="";if(h(e)&&(e=e.call(this)),t.data&&(n=g(t.data)),e&&"object"==typeof e)if(u(e))for(var a=e.length;a>r;r++)n&&(n.index=r,n.first=0===r,n.last=r===e.length-1),s+=o(e[r],{data:n});else for(var l in e)e.hasOwnProperty(l)&&(n&&(n.key=l,n.index=r,n.first=0===r),s+=o(e[l],{data:n}),r++);return 0===r&&(s=i(this)),s}),e.registerHelper("if",function(e,t){return h(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||s.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){return h(e)&&(e=e.call(this)),s.isEmpty(e)?void 0:t.fn(e)}),e.registerHelper("log",function(t,n){var o=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(o,t)})}function i(e,t){m.log(e,t)}var r={},s=e,a=t,l="1.3.0";r.VERSION=l;var c=4;r.COMPILER_REVISION=c;var d={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};r.REVISION_CHANGES=d;var u=s.isArray,h=s.isFunction,f=s.toString,p="[object Object]";r.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:m,log:i,registerHelper:function(e,t,n){if(f.call(e)===p){if(n||t)throw new a("Arg not supported with multiple helpers");s.extend(this.helpers,e)}else n&&(t.not=n),this.helpers[e]=t},registerPartial:function(e,t){f.call(e)===p?s.extend(this.partials,e):this.partials[e]=t}};var m={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(m.level<=e){var n=m.methodMap[e];"undefined"!=typeof console&&console[n]&&void 0}}};r.logger=m,r.log=i;var g=function(e){var t={};return s.extend(t,e),t};return r.createFrame=g,r}(t,n),i=function(e,t,n){"use strict";function o(e){var t=e&&e[0]||1,n=h;if(t!==n){if(n>t){var o=f[n],i=f[t];throw new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+o+") or downgrade your runtime to an older version ("+i+").")}throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function i(e,t){if(!t)throw new u("No environment passed to template");var n=function(e,n,o,i,r,s){var a=t.VM.invokePartial.apply(this,arguments);if(null!=a)return a;if(t.compile){var l={helpers:i,partials:r,data:s};return r[n]=t.compile(e,{data:void 0!==s},t),r[n](o,l)}throw new u("The partial "+n+" could not be compiled when running in runtime-only mode")},o={escapeExpression:d.escapeExpression,invokePartial:n,programs:[],program:function(e,t,n){var o=this.programs[e];return n?o=s(e,t,n):o||(o=this.programs[e]=s(e,t)),o},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n={},d.extend(n,t),d.extend(n,e)),n},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop,compilerInfo:null};return function(n,i){i=i||{};var r,s,a=i.partial?i:t;i.partial||(r=i.helpers,s=i.partials);var l=e.call(o,a,n,r,s,i.data);return i.partial||t.VM.checkRevision(o.compilerInfo),l}}function r(e,t,n){var o=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(o))};return i.program=e,i.depth=o.length,i}function s(e,t,n){var o=function(e,o){return o=o||{},t(e,o.data||n)};return o.program=e,o.depth=0,o}function a(e,t,n,o,i,r){var s={partial:!0,helpers:o,partials:i,data:r};if(void 0===e)throw new u("The partial "+t+" could not be found");return e instanceof Function?e(n,s):void 0}function l(){return""}var c={},d=e,u=t,h=n.COMPILER_REVISION,f=n.REVISION_CHANGES;return c.checkRevision=o,c.template=i,c.programWithDepth=r,c.program=s,c.invokePartial=a,c.noop=l,c}(t,n,o),r=function(e,t,n,o,i){"use strict";var r,s=e,a=t,l=n,c=o,d=i,u=function(){var e=new s.HandlebarsEnvironment;return c.extend(e,s),e.SafeString=a,e.Exception=l,e.Utils=c,e.VM=d,e.template=function(t){return d.template(t,e)},e},h=u();return h.create=u,r=h}(o,e,n,t,i);return r}();this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.blockquote=Handlebars.template(function(e,t,n,o,i){
function r(e,t){var n,o="";return o+="btn-"+u((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===d?n.apply(e):n))}function s(e,t){return' \n      <span class="fa fa-quote-left"></span>\n    '}function a(e,t){return'\n      <span class="glyphicon glyphicon-quote"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var l,c="",d="function",u=this.escapeExpression,h=this;return c+='<li>\n  <a class="btn ',l=n["if"].call(t,(l=t&&t.options,l=null==l||l===!1?l:l.toolbar,null==l||l===!1?l:l.size),{hash:{},inverse:h.noop,fn:h.program(1,r,i),data:i}),(l||0===l)&&(c+=l),c+=' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n    ',l=n["if"].call(t,(l=t&&t.options,l=null==l||l===!1?l:l.toolbar,null==l||l===!1?l:l.fa),{hash:{},inverse:h.program(5,a,i),fn:h.program(3,s,i),data:i}),(l||0===l)&&(c+=l),c+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.color=Handlebars.template(function(e,t,n,o,i){function r(e,t){var n,o="";return o+="btn-"+c((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===l?n.apply(e):n))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,a="",l="function",c=this.escapeExpression,d=this;return a+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',s=n["if"].call(t,(s=t&&t.options,s=null==s||s===!1?s:s.toolbar,null==s||s===!1?s:s.size),{hash:{},inverse:d.noop,fn:d.program(1,r,i),data:i}),(s||0===s)&&(a+=s),a+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.black,typeof s===l?s.apply(t):s))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.black,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.silver,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.gray,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.maroon,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.red,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.purple,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.green,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.olive,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.navy,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.blue,typeof s===l?s.apply(t):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+c((s=t&&t.locale,s=null==s||s===!1?s:s.colours,s=null==s||s===!1?s:s.orange,typeof s===l?s.apply(t):s))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.emphasis=Handlebars.template(function(e,t,n,o,i){function r(e,t){var n,o="";return o+="btn-"+d((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===c?n.apply(e):n))}function s(e,t){var o,i="";return i+='\n    <a class="btn ',o=n["if"].call(e,(o=e&&e.options,o=null==o||o===!1?o:o.toolbar,null==o||o===!1?o:o.size),{hash:{},inverse:u.noop,fn:u.program(1,r,t),data:t}),(o||0===o)&&(i+=o),i+=' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+d((o=e&&e.locale,o=null==o||o===!1?o:o.emphasis,o=null==o||o===!1?o:o.small,typeof o===c?o.apply(e):o))+"</a>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var a,l="",c="function",d=this.escapeExpression,u=this;return l+='<li>\n  <div class="btn-group">\n    <a class="btn ',a=n["if"].call(t,(a=t&&t.options,a=null==a||a===!1?a:a.toolbar,null==a||a===!1?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,r,i),data:i}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+d((a=t&&t.locale,a=null==a||a===!1?a:a.emphasis,a=null==a||a===!1?a:a.bold,typeof a===c?a.apply(t):a))+'</a>\n    <a class="btn ',a=n["if"].call(t,(a=t&&t.options,a=null==a||a===!1?a:a.toolbar,null==a||a===!1?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,r,i),data:i}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+d((a=t&&t.locale,a=null==a||a===!1?a:a.emphasis,a=null==a||a===!1?a:a.italic,typeof a===c?a.apply(t):a))+'</a>\n    <a class="btn ',a=n["if"].call(t,(a=t&&t.options,a=null==a||a===!1?a:a.toolbar,null==a||a===!1?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,r,i),data:i}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+d((a=t&&t.locale,a=null==a||a===!1?a:a.emphasis,a=null==a||a===!1?a:a.underline,typeof a===c?a.apply(t):a))+"</a>\n    ",a=n["if"].call(t,(a=t&&t.options,a=null==a||a===!1?a:a.toolbar,a=null==a||a===!1?a:a.emphasis,null==a||a===!1?a:a.small),{hash:{},inverse:u.noop,fn:u.program(3,s,i),data:i}),(a||0===a)&&(l+=a),l+="\n  </div>\n</li>\n"}),this.wysihtml5.tpl["font-styles"]=Handlebars.template(function(e,t,n,o,i){function r(e,t){var n,o="";return o+="btn-"+u((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===d?n.apply(e):n))}function s(e,t){return'\n      <span class="fa fa-font"></span>\n    '}function a(e,t){return'\n      <span class="glyphicon glyphicon-font"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var l,c="",d="function",u=this.escapeExpression,h=this;return c+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',l=n["if"].call(t,(l=t&&t.options,l=null==l||l===!1?l:l.toolbar,null==l||l===!1?l:l.size),{hash:{},inverse:h.noop,fn:h.program(1,r,i),data:i}),(l||0===l)&&(c+=l),c+='" data-toggle="dropdown">\n    ',l=n["if"].call(t,(l=t&&t.options,l=null==l||l===!1?l:l.toolbar,null==l||l===!1?l:l.fa),{hash:{},inverse:h.program(5,a,i),fn:h.program(3,s,i),data:i}),(l||0===l)&&(c+=l),c+='\n    <span class="current-font">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.normal,typeof l===d?l.apply(t):l))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.normal,typeof l===d?l.apply(t):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.h1,typeof l===d?l.apply(t):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.h2,typeof l===d?l.apply(t):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.h3,typeof l===d?l.apply(t):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.h4,typeof l===d?l.apply(t):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.h5,typeof l===d?l.apply(t):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+u((l=t&&t.locale,l=null==l||l===!1?l:l.font_styles,l=null==l||l===!1?l:l.h6,typeof l===d?l.apply(t):l))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.html=Handlebars.template(function(e,t,n,o,i){function r(e,t){var n,o="";return o+="btn-"+u((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===d?n.apply(e):n))}function s(e,t){return'\n        <span class="fa fa-pencil"></span>\n      '}function a(e,t){return'\n        <span class="glyphicon glyphicon-pencil"></span>\n      '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var l,c="",d="function",u=this.escapeExpression,h=this;return c+='<li>\n  <div class="btn-group">\n    <a class="btn ',l=n["if"].call(t,(l=t&&t.options,l=null==l||l===!1?l:l.toolbar,null==l||l===!1?l:l.size),{hash:{},inverse:h.noop,fn:h.program(1,r,i),data:i}),(l||0===l)&&(c+=l),c+=' btn-default" data-wysihtml5-action="change_view" title="'+u((l=t&&t.locale,l=null==l||l===!1?l:l.html,l=null==l||l===!1?l:l.edit,typeof l===d?l.apply(t):l))+'" tabindex="-1">\n      ',l=n["if"].call(t,(l=t&&t.options,l=null==l||l===!1?l:l.toolbar,null==l||l===!1?l:l.fa),{hash:{},inverse:h.program(5,a,i),fn:h.program(3,s,i),data:i}),(l||0===l)&&(c+=l),c+="\n    </a>\n  </div>\n</li>\n"}),this.wysihtml5.tpl.image=Handlebars.template(function(e,t,n,o,i){function r(e,t){return"modal-sm"}function s(e,t){var n,o="";return o+="btn-"+h((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===u?n.apply(e):n))}function a(e,t){return'\n      <span class="fa fa-file-image-o"></span>\n    '}function l(e,t){return'\n      <span class="glyphicon glyphicon-picture"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var c,d="",u="function",h=this.escapeExpression,f=this;return d+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog ',c=n["if"].call(t,(c=t&&t.options,c=null==c||c===!1?c:c.toolbar,null==c||c===!1?c:c.smallmodals),{hash:{},inverse:f.noop,fn:f.program(1,r,i),data:i}),(c||0===c)&&(d+=c),d+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+h((c=t&&t.locale,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.insert,typeof c===u?c.apply(t):c))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+h((c=t&&t.locale,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.cancel,typeof c===u?c.apply(t):c))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+h((c=t&&t.locale,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.insert,typeof c===u?c.apply(t):c))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',c=n["if"].call(t,(c=t&&t.options,c=null==c||c===!1?c:c.toolbar,null==c||c===!1?c:c.size),{hash:{},inverse:f.noop,fn:f.program(3,s,i),data:i}),(c||0===c)&&(d+=c),d+=' btn-default" data-wysihtml5-command="insertImage" title="'+h((c=t&&t.locale,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.insert,typeof c===u?c.apply(t):c))+'" tabindex="-1">\n    ',c=n["if"].call(t,(c=t&&t.options,c=null==c||c===!1?c:c.toolbar,null==c||c===!1?c:c.fa),{hash:{},inverse:f.program(7,l,i),fn:f.program(5,a,i),data:i}),(c||0===c)&&(d+=c),d+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.link=Handlebars.template(function(e,t,n,o,i){function r(e,t){return"modal-sm"}function s(e,t){var n,o="";return o+="btn-"+h((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===u?n.apply(e):n))}function a(e,t){return'\n      <span class="fa fa-share-square-o"></span>\n    '}function l(e,t){return'\n      <span class="glyphicon glyphicon-share"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var c,d="",u="function",h=this.escapeExpression,f=this;return d+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog ',c=n["if"].call(t,(c=t&&t.options,c=null==c||c===!1?c:c.toolbar,null==c||c===!1?c:c.smallmodals),{hash:{},inverse:f.noop,fn:f.program(1,r,i),data:i}),(c||0===c)&&(d+=c),d+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+h((c=t&&t.locale,c=null==c||c===!1?c:c.link,c=null==c||c===!1?c:c.insert,typeof c===u?c.apply(t):c))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+h((c=t&&t.locale,c=null==c||c===!1?c:c.link,c=null==c||c===!1?c:c.target,typeof c===u?c.apply(t):c))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+h((c=t&&t.locale,c=null==c||c===!1?c:c.link,c=null==c||c===!1?c:c.cancel,typeof c===u?c.apply(t):c))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+h((c=t&&t.locale,c=null==c||c===!1?c:c.link,c=null==c||c===!1?c:c.insert,typeof c===u?c.apply(t):c))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',c=n["if"].call(t,(c=t&&t.options,c=null==c||c===!1?c:c.toolbar,null==c||c===!1?c:c.size),{hash:{},inverse:f.noop,fn:f.program(3,s,i),data:i}),(c||0===c)&&(d+=c),d+=' btn-default" data-wysihtml5-command="createLink" title="'+h((c=t&&t.locale,c=null==c||c===!1?c:c.link,c=null==c||c===!1?c:c.insert,typeof c===u?c.apply(t):c))+'" tabindex="-1">\n    ',c=n["if"].call(t,(c=t&&t.options,c=null==c||c===!1?c:c.toolbar,null==c||c===!1?c:c.fa),{hash:{},inverse:f.program(7,l,i),fn:f.program(5,a,i),data:i}),(c||0===c)&&(d+=c),d+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.lists=Handlebars.template(function(e,t,n,o,i){function r(e,t){var n,o="";return o+="btn-"+y((n=e&&e.options,n=null==n||n===!1?n:n.toolbar,n=null==n||n===!1?n:n.size,typeof n===g?n.apply(e):n))}function s(e,t){return'\n      <span class="fa fa-list-ul"></span>\n    '}function a(e,t){return'\n      <span class="glyphicon glyphicon-list"></span>\n    '}function l(e,t){return'\n      <span class="fa fa-list-ol"></span>\n    '}function c(e,t){return'\n      <span class="glyphicon glyphicon-th-list"></span>\n    '}function d(e,t){return'\n      <span class="fa fa-outdent"></span>\n    '}function u(e,t){return'\n      <span class="glyphicon glyphicon-indent-right"></span>\n    '}function h(e,t){return'\n      <span class="fa fa-indent"></span>\n    '}function f(e,t){return'\n      <span class="glyphicon glyphicon-indent-left"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var p,m="",g="function",y=this.escapeExpression,v=this;return m+='<li>\n  <div class="btn-group">\n    <a class="btn ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,r,i),data:i}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+y((p=t&&t.locale,p=null==p||p===!1?p:p.lists,p=null==p||p===!1?p:p.unordered,typeof p===g?p.apply(t):p))+'" tabindex="-1">\n    ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.fa),{hash:{},inverse:v.program(5,a,i),fn:v.program(3,s,i),data:i}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,r,i),data:i}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+y((p=t&&t.locale,p=null==p||p===!1?p:p.lists,p=null==p||p===!1?p:p.ordered,typeof p===g?p.apply(t):p))+'" tabindex="-1">\n    ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.fa),{hash:{},inverse:v.program(9,c,i),fn:v.program(7,l,i),data:i}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,r,i),data:i}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="Outdent" title="'+y((p=t&&t.locale,p=null==p||p===!1?p:p.lists,p=null==p||p===!1?p:p.outdent,typeof p===g?p.apply(t):p))+'" tabindex="-1">\n    ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.fa),{hash:{},inverse:v.program(13,u,i),fn:v.program(11,d,i),data:i}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,r,i),data:i}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="Indent" title="'+y((p=t&&t.locale,p=null==p||p===!1?p:p.lists,p=null==p||p===!1?p:p.indent,typeof p===g?p.apply(t):p))+'" tabindex="-1">\n    ',p=n["if"].call(t,(p=t&&t.options,p=null==p||p===!1?p:p.toolbar,null==p||p===!1?p:p.fa),{hash:{},inverse:v.program(17,f,i),fn:v.program(15,h,i),data:i}),(p||0===p)&&(m+=p),m+="\n    </a>\n  </div>\n</li>\n"}),function(e){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],e):e(jQuery,wysihtml5)}(function(e,t){var n=function(e,t){"use strict";var n=function(e,n,o){return t.tpl[e]?t.tpl[e]({locale:n,options:o}):void 0},o=function(n,o){this.el=n;var i=e.extend(!0,{},r,o);for(var s in i.customTemplates)t.tpl[s]=i.customTemplates[s];this.toolbar=this.createToolbar(n,i),this.editor=this.createEditor(i)};o.prototype={constructor:o,createEditor:function(n){n=n||{},n=e.extend(!0,{},n),n.toolbar=this.toolbar[0];var o=new t.Editor(this.el[0],n);if(o.composer.editableArea.contentDocument?this.addMoreShortcuts(o,o.composer.editableArea.contentDocument.body||o.composer.editableArea.contentDocument,n.shortcuts):this.addMoreShortcuts(o,o.composer.editableArea,n.shortcuts),n&&n.events)for(var i in n.events)o.on(i,n.events[i]);return o.on("beforeload",this.syncBootstrapDialogEvents),o},syncBootstrapDialogEvents:function(){var t=this;e.map(this.toolbar.commandMapping,function(e,t){return[e]}).filter(function(e,t,n){return e.dialog}).map(function(e,t,n){return e.dialog}).forEach(function(n,o,i){n.on("show",function(t){e(this.container).modal("show")}),n.on("hide",function(n){e(this.container).modal("hide"),t.composer.focus()}),e(n.container).on("shown.bs.modal",function(){e(this).find("input, select, textarea").first().focus()})})},createToolbar:function(t,o){var i=this,a=e("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),l=o.locale||r.locale||"en";s.hasOwnProperty(l)||(l="en");var c=e.extend(!0,{},s.en,s[l]);for(var d in o.toolbar)o.toolbar[d]&&(a.append(n(d,c,o)),"html"===d&&this.initHtml(a));return a.find('a[data-wysihtml5-command="formatBlock"]').click(function(t){var n=t.delegateTarget||t.target||t.srcElement,o=e(n),r=o.data("wysihtml5-display-format-name"),s=o.data("wysihtml5-format-name")||o.html();(void 0===r||"true"===r)&&i.toolbar.find(".current-font").text(s)}),a.find('a[data-wysihtml5-command="foreColor"]').click(function(t){var n=t.target||t.srcElement,o=e(n);i.toolbar.find(".current-color").text(o.html())}),this.el.before(a),a},initHtml:function(e){var t='a[data-wysihtml5-action="change_view"]';e.find(t).click(function(n){e.find("a.btn").not(t).toggleClass("disabled")})},addMoreShortcuts:function(e,n,o){t.dom.observe(n,"keydown",function(n){var i=n.keyCode,r=o[i];if((n.ctrlKey||n.metaKey||n.altKey)&&r&&t.commands[r]){var s=e.toolbar.commandMapping[r+":null"];s&&s.dialog&&!s.state?s.dialog.show():t.commands[r].exec(e.composer,r),n.preventDefault()}})}};var i={resetDefaults:function(){e.fn.wysihtml5.defaultOptions=e.extend(!0,{},e.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(t){return this.each(function(){var n=e(this);n.data("wysihtml5",new o(n,t))})},shallowExtend:function(t){var n=e.extend({},e.fn.wysihtml5.defaultOptions,t||{},e(this).data()),o=this;return i.bypassDefaults.apply(o,[n])},deepExtend:function(t){var n=e.extend(!0,{},e.fn.wysihtml5.defaultOptions,t||{}),o=this;return i.bypassDefaults.apply(o,[n])},init:function(e){var t=this;return i.shallowExtend.apply(t,[e])}};e.fn.wysihtml5=function(t){return i[t]?i[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.wysihtml5"):i.init.apply(this,arguments)},e.fn.wysihtml5.Constructor=o;var r=e.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":!0,color:!1,emphasis:{small:!0},blockquote:!0,lists:!0,html:!1,link:!0,image:!0,smallmodals:!1},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{83:"small"}};"undefined"==typeof e.fn.wysihtml5.defaultOptionsCache&&(e.fn.wysihtml5.defaultOptionsCache=e.extend(!0,{},e.fn.wysihtml5.defaultOptions));var s=e.fn.wysihtml5.locale={}};n(e,t)}),function(e){e.commands.small={exec:function(t,n){return e.commands.formatInline.exec(t,n,"small")},state:function(t,n){return e.commands.formatInline.state(t,n,"small")}}}(wysihtml5),function(e){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],e):e(jQuery)}(function(e){e.fn.wysihtml5.locale.en=e.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var t;return function(){if(!t||!t.requirejs){t?n=t:t={};var e,n,o;!function(t){function i(e,t){return b.call(e,t)}function r(e,t){var n,o,i,r,s,a,l,c,d,u,h,f=t&&t.split("/"),p=v.map,m=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),s=e.length-1,v.nodeIdCompat&&x.test(e[s])&&(e[s]=e[s].replace(x,"")),e=f.slice(0,f.length-1).concat(e),d=0;d<e.length;d+=1)if(h=e[d],"."===h)e.splice(d,1),d-=1;else if(".."===h){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||m)&&p){for(n=e.split("/"),d=n.length;d>0;d-=1){if(o=n.slice(0,d).join("/"),f)for(u=f.length;u>0;u-=1)if(i=p[f.slice(0,u).join("/")],i&&(i=i[o])){r=i,a=d;break}if(r)break;!l&&m&&m[o]&&(l=m[o],c=d)}!r&&l&&(r=l,a=c),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function s(e,n){return function(){var o=C.call(arguments,0);return"string"!=typeof o[0]&&1===o.length&&o.push(null),f.apply(t,o.concat([e,n]))}}function a(e){return function(t){return r(t,e)}}function l(e){return function(t){g[e]=t}}function c(e){if(i(y,e)){var n=y[e];delete y[e],w[e]=!0,h.apply(t,n)}if(!i(g,e)&&!i(w,e))throw new Error("No "+e);return g[e]}function d(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return function(){return v&&v.config&&v.config[e]||{}}}var h,f,p,m,g={},y={},v={},w={},b=Object.prototype.hasOwnProperty,C=[].slice,x=/\.js$/;p=function(e,t){var n,o=d(e),i=o[0];return e=o[1],i&&(i=r(i,t),n=c(i)),i?e=n&&n.normalize?n.normalize(e,a(t)):r(e,t):(e=r(e,t),o=d(e),i=o[0],e=o[1],i&&(n=c(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},m={require:function(e){return s(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:u(e)}}},h=function(e,n,o,r){var a,d,u,h,f,v,b=[],C=typeof o;if(r=r||e,"undefined"===C||"function"===C){for(n=!n.length&&o.length?["require","exports","module"]:n,f=0;f<n.length;f+=1)if(h=p(n[f],r),d=h.f,"require"===d)b[f]=m.require(e);else if("exports"===d)b[f]=m.exports(e),v=!0;else if("module"===d)a=b[f]=m.module(e);else if(i(g,d)||i(y,d)||i(w,d))b[f]=c(d);else{if(!h.p)throw new Error(e+" missing "+d);h.p.load(h.n,s(r,!0),l(d),{}),b[f]=g[d]}u=o?o.apply(g[e],b):void 0,e&&(a&&a.exports!==t&&a.exports!==g[e]?g[e]=a.exports:u===t&&v||(g[e]=u))}else e&&(g[e]=o)},e=n=f=function(e,n,o,i,r){if("string"==typeof e)return m[e]?m[e](n):c(p(e,n).f);if(!e.splice){if(v=e,v.deps&&f(v.deps,v.callback),!n)return;n.splice?(e=n,n=o,o=null):e=t}return n=n||function(){},"function"==typeof o&&(o=i,i=r),i?h(t,e,n,o):setTimeout(function(){h(t,e,n,o)},4),f},f.config=function(e){return f(e)},e._defined=g,o=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),i(g,e)||i(y,e)||(y[e]=[e,t,n])},o.amd={jQuery:!0}}(),t.requirejs=e,t.require=n,t.define=o}}(),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||$;return null==t&&console&&console.error,t}),t.define("select2/utils",["jquery"],function(e){function t(e){var t=e.prototype,n=[];for(var o in t){var i=t[o];"function"==typeof i&&"constructor"!==o&&n.push(o)}return n}var n={};n.Extend=function(e,t){function n(){this.constructor=e}var o={}.hasOwnProperty;for(var i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},n.Decorate=function(e,n){function o(){var t=Array.prototype.unshift,o=n.prototype.constructor.length,i=e.prototype.constructor;o>0&&(t.call(arguments,e.prototype.constructor),i=n.prototype.constructor),i.apply(this,arguments)}function i(){this.constructor=o}var r=t(n),s=t(e);n.displayName=e.displayName,o.prototype=new i;for(var a=0;a<s.length;a++){var l=s[a];o.prototype[l]=e.prototype[l]}for(var c=(function(e){var t=function(){};e in o.prototype&&(t=o.prototype[e]);var i=n.prototype[e];return function(){var e=Array.prototype.unshift;return e.call(arguments,t),i.apply(this,arguments)}}),d=0;d<r.length;d++){var u=r[d];o.prototype[u]=c(u)}return o};var o=function(){this.listeners={}};return o.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},o.prototype.trigger=function(e){var t=Array.prototype.slice;this.listeners=this.listeners||{},e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},o.prototype.invoke=function(e,t){for(var n=0,o=e.length;o>n;n++)e[n].apply(this,t)},n.Observable=o,n.generateChars=function(e){for(var t="",n=0;e>n;n++){var o=Math.floor(36*Math.random());t+=o.toString(36)}return t},n.bind=function(e,t){return function(){e.apply(t,arguments)}},n._convertData=function(e){for(var t in e){var n=t.split("-"),o=e;if(1!==n.length){for(var i=0;i<n.length;i++){var r=n[i];r=r.substring(0,1).toLowerCase()+r.substring(1),r in o||(o[r]={}),i==n.length-1&&(o[r]=e[t]),o=o[r]}delete e[t]}}return e},n.hasScroll=function(t,n){var o=e(n),i=n.style.overflowX,r=n.style.overflowY;return i!==r||"hidden"!==r&&"visible"!==r?"scroll"===i||"scroll"===r?!0:o.innerHeight()<n.scrollHeight||o.innerWidth()<n.scrollWidth:!1},n.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},n.appendMany=function(t,n){if("1.7"===e.fn.jquery.substr(0,3)){var o=e();e.map(n,function(e){o=o.add(e)}),n=o}t.append(n)},n}),t.define("select2/results",["jquery","./utils"],function(e,t){function n(e,t,o){this.$element=e,this.data=o,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},n.prototype.clear=function(){this.$results.empty()},n.prototype.displayMessage=function(t){var n=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var o=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(t.message);o.append(n(i(t.args))),o[0].className+=" select2-results__message",this.$results.append(o)},n.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},n.prototype.append=function(e){this.hideLoading();var t=[];if(null==e.results||0===e.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var o=e.results[n],i=this.option(o);
t.push(i)}this.$results.append(t)},n.prototype.position=function(e,t){var n=t.find(".select2-results");n.append(e)},n.prototype.sort=function(e){var t=this.options.get("sorter");return t(e)},n.prototype.setClasses=function(){var t=this;this.data.current(function(n){var o=e.map(n,function(e){return e.id.toString()}),i=t.$results.find(".select2-results__option[aria-selected]");i.each(function(){var t=e(this),n=e.data(this,"data"),i=""+n.id;null!=n.element&&n.element.selected||null==n.element&&e.inArray(i,o)>-1?t.attr("aria-selected","true"):t.attr("aria-selected","false")});var r=i.filter("[aria-selected=true]");r.length>0?r.first().trigger("mouseenter"):i.first().trigger("mouseenter")})},n.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),n={disabled:!0,loading:!0,text:t(e)},o=this.option(n);o.className+=" loading-results",this.$results.prepend(o)},n.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},n.prototype.option=function(t){var n=document.createElement("li");n.className="select2-results__option";var o={role:"treeitem","aria-selected":"false"};t.disabled&&(delete o["aria-selected"],o["aria-disabled"]="true"),null==t.id&&delete o["aria-selected"],null!=t._resultId&&(n.id=t._resultId),t.title&&(n.title=t.title),t.children&&(o.role="group",o["aria-label"]=t.text,delete o["aria-selected"]);for(var i in o){var r=o[i];n.setAttribute(i,r)}if(t.children){var s=e(n),a=document.createElement("strong");a.className="select2-results__group";e(a);this.template(t,a);for(var l=[],c=0;c<t.children.length;c++){var d=t.children[c],u=this.option(d);l.push(u)}var h=e("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});h.append(l),s.append(a),s.append(h)}else this.template(t,n);return e.data(n,"data",t),n},n.prototype.bind=function(t,n){var o=this,i=t.id+"-results";this.$results.attr("id",i),t.on("results:all",function(e){o.clear(),o.append(e.data),t.isOpen()&&o.setClasses()}),t.on("results:append",function(e){o.append(e.data),t.isOpen()&&o.setClasses()}),t.on("query",function(e){o.hideMessages(),o.showLoading(e)}),t.on("select",function(){t.isOpen()&&o.setClasses()}),t.on("unselect",function(){t.isOpen()&&o.setClasses()}),t.on("open",function(){o.$results.attr("aria-expanded","true"),o.$results.attr("aria-hidden","false"),o.setClasses(),o.ensureHighlightVisible()}),t.on("close",function(){o.$results.attr("aria-expanded","false"),o.$results.attr("aria-hidden","true"),o.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=o.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=o.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?o.trigger("close",{}):o.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=o.getHighlightedResults(),t=o.$results.find("[aria-selected]"),n=t.index(e);if(0!==n){var i=n-1;0===e.length&&(i=0);var r=t.eq(i);r.trigger("mouseenter");var s=o.$results.offset().top,a=r.offset().top,l=o.$results.scrollTop()+(a-s);0===i?o.$results.scrollTop(0):0>a-s&&o.$results.scrollTop(l)}}),t.on("results:next",function(){var e=o.getHighlightedResults(),t=o.$results.find("[aria-selected]"),n=t.index(e),i=n+1;if(!(i>=t.length)){var r=t.eq(i);r.trigger("mouseenter");var s=o.$results.offset().top+o.$results.outerHeight(!1),a=r.offset().top+r.outerHeight(!1),l=o.$results.scrollTop()+a-s;0===i?o.$results.scrollTop(0):a>s&&o.$results.scrollTop(l)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){o.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=o.$results.scrollTop(),n=o.$results.get(0).scrollHeight-o.$results.scrollTop()+e.deltaY,i=e.deltaY>0&&t-e.deltaY<=0,r=e.deltaY<0&&n<=o.$results.height();i?(o.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):r&&(o.$results.scrollTop(o.$results.get(0).scrollHeight-o.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var n=e(this),i=n.data("data");return"true"===n.attr("aria-selected")?void(o.options.get("multiple")?o.trigger("unselect",{originalEvent:t,data:i}):o.trigger("close",{})):void o.trigger("select",{originalEvent:t,data:i})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(t){var n=e(this).data("data");o.getHighlightedResults().removeClass("select2-results__option--highlighted"),o.trigger("results:focus",{data:n,element:e(this)})})},n.prototype.getHighlightedResults=function(){var e=this.$results.find(".select2-results__option--highlighted");return e},n.prototype.destroy=function(){this.$results.remove()},n.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),n=t.index(e),o=this.$results.offset().top,i=e.offset().top,r=this.$results.scrollTop()+(i-o),s=i-o;r-=2*e.outerHeight(!1),2>=n?this.$results.scrollTop(0):(s>this.$results.outerHeight()||0>s)&&this.$results.scrollTop(r)}},n.prototype.template=function(t,n){var o=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),r=o(t,n);null==r?n.style.display="none":"string"==typeof r?n.innerHTML=i(r):e(n).append(r)},n}),t.define("select2/keys",[],function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return e}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,n){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,t.Observable),o.prototype.render=function(){var t=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},o.prototype.bind=function(e,t){var o=this,i=(e.id+"-container",e.id+"-results");this.container=e,this.$selection.on("focus",function(e){o.trigger("focus",e)}),this.$selection.on("blur",function(e){o._handleBlur(e)}),this.$selection.on("keydown",function(e){o.trigger("keypress",e),e.which===n.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){o.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){o.update(e.data)}),e.on("open",function(){o.$selection.attr("aria-expanded","true"),o.$selection.attr("aria-owns",i),o._attachCloseHandler(e)}),e.on("close",function(){o.$selection.attr("aria-expanded","false"),o.$selection.removeAttr("aria-activedescendant"),o.$selection.removeAttr("aria-owns"),o.$selection.focus(),o._detachCloseHandler(e)}),e.on("enable",function(){o.$selection.attr("tabindex",o._tabindex)}),e.on("disable",function(){o.$selection.attr("tabindex","-1")})},o.prototype._handleBlur=function(t){var n=this;window.setTimeout(function(){document.activeElement==n.$selection[0]||e.contains(n.$selection[0],document.activeElement)||n.trigger("blur",t)},1)},o.prototype._attachCloseHandler=function(t){e(document.body).on("mousedown.select2."+t.id,function(t){var n=e(t.target),o=n.closest(".select2"),i=e(".select2.select2-container--open");i.each(function(){var t=e(this);if(this!=o[0]){var n=t.data("element");n.select2("close")}})})},o.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},o.prototype.position=function(e,t){var n=t.find(".selection");n.append(e)},o.prototype.destroy=function(){this._detachCloseHandler(this.container)},o.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},o}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,o){function i(){i.__super__.constructor.apply(this,arguments)}return n.Extend(i,t),i.prototype.render=function(){var e=i.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},i.prototype.bind=function(e,t){var n=this;i.__super__.bind.apply(this,arguments);var o=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",o),this.$selection.attr("aria-labelledby",o),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),e.on("selection:update",function(e){n.update(e.data)})},i.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},i.prototype.display=function(e,t){var n=this.options.get("templateSelection"),o=this.options.get("escapeMarkup");return o(n(e,t))},i.prototype.selectionContainer=function(){return e("<span></span>")},i.prototype.update=function(e){if(0===e.length)return void this.clear();var t=e[0],n=this.$selection.find(".select2-selection__rendered"),o=this.display(t,n);n.empty().append(o),n.prop("title",t.title||t.text)},i}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,n){function o(e,t){o.__super__.constructor.apply(this,arguments)}return n.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},o.prototype.bind=function(t,n){var i=this;o.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){i.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(t){if(!i.options.get("disabled")){var n=e(this),o=n.parent(),r=o.data("data");i.trigger("unselect",{originalEvent:t,data:r})}})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection"),o=this.options.get("escapeMarkup");return o(n(e,t))},o.prototype.selectionContainer=function(){var t=e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return t},o.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],o=0;o<e.length;o++){var i=e[o],r=this.selectionContainer(),s=this.display(i,r);r.append(s),r.prop("title",i.title||i.text),r.data("data",i),t.push(r)}var a=this.$selection.find(".select2-selection__rendered");n.appendMany(a,t)}},o}),t.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id,o=t.length>1;if(o||n)return e.call(this,t);this.clear();var i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},t}),t.define("select2/selection/allowClear",["jquery","../keys"],function(e,t){function n(){}return n.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error,this.$selection.on("mousedown",".select2-selection__clear",function(e){o._handleClear(e)}),t.on("keypress",function(e){o._handleKeyboardClear(e,t)})},n.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();for(var o=n.data("data"),i=0;i<o.length;i++){var r={data:o[i]};if(this.trigger("unselect",r),r.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},n.prototype._handleKeyboardClear=function(e,n,o){o.isOpen()||(n.which==t.DELETE||n.which==t.BACKSPACE)&&this._handleClear(n)},n.prototype.update=function(t,n){if(t.call(this,n),!(this.$selection.find(".select2-selection__placeholder").length>0||0===n.length)){var o=e('<span class="select2-selection__clear">&times;</span>');o.data("data",n),this.$selection.find(".select2-selection__rendered").prepend(o)}},n}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,n){function o(e,t,n){e.call(this,t,n)}return o.prototype.render=function(t){var n=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=n,this.$search=n.find("input");var o=t.call(this);return this._transferTabIndex(),o},o.prototype.bind=function(e,t,o){var i=this;e.call(this,t,o),t.on("open",function(){i.$search.trigger("focus")}),t.on("close",function(){i.$search.val(""),i.$search.removeAttr("aria-activedescendant"),i.$search.trigger("focus")}),t.on("enable",function(){i.$search.prop("disabled",!1),i._transferTabIndex()}),t.on("disable",function(){i.$search.prop("disabled",!0)}),t.on("focus",function(e){i.$search.trigger("focus")}),t.on("results:focus",function(e){i.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){i.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){i._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){e.stopPropagation(),i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented();var t=e.which;if(t===n.BACKSPACE&&""===i.$search.val()){var o=i.$searchContainer.prev(".select2-selection__choice");if(o.length>0){var r=o.data("data");i.searchRemoveChoice(r),e.preventDefault()}}});var r=document.documentMode,s=r&&11>=r;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){return s?void i.$selection.off("input.search input.searchcheck"):void i.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(s&&"input"===e.type)return void i.$selection.off("input.search input.searchcheck");var t=e.which;t!=n.SHIFT&&t!=n.CTRL&&t!=n.ALT&&t!=n.TAB&&i.handleSearch(e)})},o.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},o.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},o.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.focus()},o.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},o.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},o.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").innerWidth();else{var t=this.$search.val().length+1;e=.75*t+"em"}this.$search.css("width",e)},o}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,n,o){var i=this,r=["open","opening","close","closing","select","selecting","unselect","unselecting"],s=["opening","closing","selecting","unselecting"];t.call(this,n,o),n.on("*",function(t,n){if(-1!==e.inArray(t,r)){n=n||{};var o=e.Event("select2:"+t,{params:n});i.$element.trigger(o),-1!==e.inArray(t,s)&&(n.prevented=o.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function n(e){this.dict=e||{}}return n.prototype.all=function(){return this.dict},n.prototype.get=function(e){return this.dict[e]},n.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},n._cache={},n.loadPath=function(e){if(!(e in n._cache)){var o=t(e);n._cache[e]=o}return new n(n._cache[e])},n}),t.define("select2/diacritics",[],function(){var e={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};return e}),t.define("select2/data/base",["../utils"],function(e){function t(e,n){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(e,t){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,n){var o=t.id+"-result-";return o+=e.generateChars(4),o+=null!=n.id?"-"+n.id.toString():"-"+e.generateChars(4)},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,n){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,e),o.prototype.current=function(e){var t=[],o=this;this.$element.find(":selected").each(function(){var e=n(this),i=o.item(e);t.push(i)}),e(t)},o.prototype.select=function(e){var t=this;if(e.selected=!0,n(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(o){var i=[];e=[e],e.push.apply(e,o);for(var r=0;r<e.length;r++){var s=e[r].id;-1===n.inArray(s,i)&&i.push(s)}t.$element.val(i),t.$element.trigger("change")});else{var o=e.id;this.$element.val(o),this.$element.trigger("change")}},o.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple"))return e.selected=!1,n(e.element).is("option")?(e.element.selected=!1,void this.$element.trigger("change")):void this.current(function(o){for(var i=[],r=0;r<o.length;r++){var s=o[r].id;s!==e.id&&-1===n.inArray(s,i)&&i.push(s)}t.$element.val(i),t.$element.trigger("change")})},o.prototype.bind=function(e,t){var n=this;this.container=e,e.on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},o.prototype.destroy=function(){this.$element.find("*").each(function(){n.removeData(this,"data")})},o.prototype.query=function(e,t){var o=[],i=this,r=this.$element.children();r.each(function(){var t=n(this);if(t.is("option")||t.is("optgroup")){var r=i.item(t),s=i.matches(e,r);null!==s&&o.push(s)}}),t({results:o})},o.prototype.addOptions=function(e){t.appendMany(this.$element,e)},o.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup"),t.label=e.text):(t=document.createElement("option"),void 0!==t.textContent?t.textContent=e.text:t.innerText=e.text),e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var o=n(t),i=this._normalizeItem(e);return i.element=t,n.data(t,"data",i),o},o.prototype.item=function(e){var t={};if(t=n.data(e[0],"data"),null!=t)return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var o=e.children("option"),i=[],r=0;r<o.length;r++){var s=n(o[r]),a=this.item(s);i.push(a)}t.children=i}return t=this._normalizeItem(t),t.element=e[0],n.data(e[0],"data",t),t},o.prototype._normalizeItem=function(e){n.isPlainObject(e)||(e={id:e,text:e}),e=n.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),n.extend({},t,e)},o.prototype.matches=function(e,t){var n=this.options.get("matcher");return n(e,t)},o}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,n){function o(e,t){var n=t.get("data")||[];o.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(n))}return t.Extend(o,e),o.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,n){return n.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),o.__super__.select.call(this,e)},o.prototype.convertToOptions=function(e){function o(e){return function(){return n(this).val()==e.id}}for(var i=this,r=this.$element.find("option"),s=r.map(function(){return i.item(n(this)).id}).get(),a=[],l=0;l<e.length;l++){var c=this._normalizeItem(e[l]);if(n.inArray(c.id,s)>=0){var d=r.filter(o(c)),u=this.item(d),h=n.extend(!0,{},u,c),f=this.option(h);d.replaceWith(f)}else{var p=this.option(c);if(c.children){var m=this.convertToOptions(c.children);t.appendMany(p,m)}a.push(p)}}return a},o}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,n){function o(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),o.__super__.constructor.call(this,e,t)}return t.Extend(o,e),o.prototype._applyDefaults=function(e){var t={data:function(e){return n.extend({},e,{q:e.term})},transport:function(e,t,o){var i=n.ajax(e);return i.then(t),i.fail(o),i}};return n.extend({},t,e,!0)},o.prototype.processResults=function(e){return e},o.prototype.query=function(e,t){function o(){var o=r.transport(r,function(o){var r=i.processResults(o,e);i.options.get("debug")&&window.console&&console.error&&(!r||!r.results||!n.isArray(r.results)),t(r)},function(){});i._request=o}var i=this;null!=this._request&&(n.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var r=n.extend({type:"GET"},this.ajaxOptions);"function"==typeof r.url&&(r.url=r.url.call(this.$element,e)),"function"==typeof r.data&&(r.data=r.data.call(this.$element,e)),this.ajaxOptions.delay&&""!==e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(o,this.ajaxOptions.delay)):o()},o}),t.define("select2/data/tags",["jquery"],function(e){function t(t,n,o){var i=o.get("tags"),r=o.get("createTag");if(void 0!==r&&(this.createTag=r),t.call(this,n,o),e.isArray(i))for(var s=0;s<i.length;s++){var a=i[s],l=this._normalizeItem(a),c=this.option(l);this.$element.append(c)}}return t.prototype.query=function(e,t,n){function o(e,r){for(var s=e.results,a=0;a<s.length;a++){var l=s[a],c=null!=l.children&&!o({results:l.children},!0),d=l.text===t.term;if(d||c)return r?!1:(e.data=s,void n(e))}if(r)return!0;var u=i.createTag(t);if(null!=u){var h=i.option(u);h.attr("data-select2-tag",!0),i.addOptions([h]),i.insertTag(s,u)}e.results=s,n(e)}var i=this;return this._removeOldTags(),null==t.term||null!=t.page?void e.call(this,t,n):void e.call(this,t,o)},t.prototype.createTag=function(t,n){var o=e.trim(n.term);return""===o?null:{id:o,text:o}},t.prototype.insertTag=function(e,t,n){t.unshift(n)},t.prototype._removeOldTags=function(t){var n=(this._lastTag,this.$element.find("option[data-select2-tag]"));n.each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,n){var o=n.get("tokenizer");void 0!==o&&(this.tokenizer=o),e.call(this,t,n)}return t.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},t.prototype.query=function(e,t,n){function o(e){i.trigger("select",{data:e})}var i=this;t.term=t.term||"";var r=this.tokenizer(t,this.options,o);r.term!==t.term&&(this.$search.length&&(this.$search.val(r.term),this.$search.focus()),t.term=r.term),e.call(this,t,n)},t.prototype.tokenizer=function(t,n,o,i){for(var r=o.get("tokenSeparators")||[],s=n.term,a=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};a<s.length;){var c=s[a];if(-1!==e.inArray(c,r)){var d=s.substr(0,a),u=e.extend({},n,{term:d}),h=l(u);null!=h?(i(h),s=s.substr(a+1)||"",a=0):a++}else a++}return{term:s}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",t.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){
var o=this;this.current(function(i){var r=null!=i?i.length:0;return o.maximumSelectionLength>0&&r>=o.maximumSelectionLength?void o.trigger("results:message",{message:"maximumSelected",args:{maximum:o.maximumSelectionLength}}):void e.call(o,t,n)})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),t.define("select2/dropdown/search",["jquery","../utils"],function(e,t){function n(){}return n.prototype.render=function(t){var n=t.call(this),o=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=o,this.$search=o.find("input"),n.prepend(o),n},n.prototype.bind=function(t,n,o){var i=this;t.call(this,n,o),this.$search.on("keydown",function(e){i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(t){e(this).off("keyup")}),this.$search.on("keyup input",function(e){i.handleSearch(e)}),n.on("open",function(){i.$search.attr("tabindex",0),i.$search.focus(),window.setTimeout(function(){i.$search.focus()},0)}),n.on("close",function(){i.$search.attr("tabindex",-1),i.$search.val("")}),n.on("results:all",function(e){if(null==e.query.term||""===e.query.term){var t=i.showSearch(e);t?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide")}})},n.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},n.prototype.showSearch=function(e,t){return!0},n}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,o){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,o)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),o=t.length-1;o>=0;o--){var i=t[o];this.placeholder.id===i.id&&n.splice(o,1)}return n},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,n,o){this.lastParams={},e.call(this,t,n,o),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,n,o){var i=this;t.call(this,n,o),n.on("query",function(e){i.lastParams=e,i.loading=!0}),n.on("query:append",function(e){i.lastParams=e,i.loading=!0}),this.$results.on("scroll",function(){var t=e.contains(document.documentElement,i.$loadingMore[0]);if(!i.loading&&t){var n=i.$results.offset().top+i.$results.outerHeight(!1),o=i.$loadingMore.offset().top+i.$loadingMore.outerHeight(!1);n+50>=o&&i.loadMore()}})},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),n=this.options.get("translations").get("loadingMore");return t.html(n(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function n(t,n,o){this.$dropdownParent=o.get("dropdownParent")||e(document.body),t.call(this,n,o)}return n.prototype.bind=function(e,t,n){var o=this,i=!1;e.call(this,t,n),t.on("open",function(){o._showDropdown(),o._attachPositioningHandler(t),i||(i=!0,t.on("results:all",function(){o._positionDropdown(),o._resizeDropdown()}),t.on("results:append",function(){o._positionDropdown(),o._resizeDropdown()}))}),t.on("close",function(){o._hideDropdown(),o._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},n.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},n.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},n.prototype.render=function(t){var n=e("<span></span>"),o=t.call(this);return n.append(o),this.$dropdownContainer=n,n},n.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},n.prototype._attachPositioningHandler=function(n,o){var i=this,r="scroll.select2."+o.id,s="resize.select2."+o.id,a="orientationchange.select2."+o.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(r,function(t){var n=e(this).data("select2-scroll-position");e(this).scrollTop(n.y)}),e(window).on(r+" "+s+" "+a,function(e){i._positionDropdown(),i._resizeDropdown()})},n.prototype._detachPositioningHandler=function(n,o){var i="scroll.select2."+o.id,r="resize.select2."+o.id,s="orientationchange.select2."+o.id,a=this.$container.parents().filter(t.hasScroll);a.off(i),e(window).off(i+" "+r+" "+s)},n.prototype._positionDropdown=function(){var t=e(window),n=this.$dropdown.hasClass("select2-dropdown--above"),o=this.$dropdown.hasClass("select2-dropdown--below"),i=null,r=(this.$container.position(),this.$container.offset());r.bottom=r.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=r.top,s.bottom=r.top+s.height;var a={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},c=l.top<r.top-a.height,d=l.bottom>r.bottom+a.height,u={left:r.left,top:s.bottom};if("static"!==this.$dropdownParent[0].style.position){var h=this.$dropdownParent.offset();u.top-=h.top,u.left-=h.left}n||o||(i="below"),d||!c||n?!c&&d&&n&&(i="below"):i="above",("above"==i||n&&"below"!==i)&&(u.top=s.top-a.height),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(u)},n.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.width="auto"),this.$dropdown.css(e)},n.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},n}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(t){for(var n=0,o=0;o<t.length;o++){var i=t[o];i.children?n+=e(i.children):n++}return n}function t(e,t,n,o){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,o)}return t.prototype.showSearch=function(t,n){return e(n.data.results)<this.minimumResultsForSearch?!1:t.call(this,n)},t}),t.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),t.on("close",function(){o._handleSelectOnClose()})},e.prototype._handleSelectOnClose=function(){var e=this.getHighlightedResults();if(!(e.length<1)){var t=e.data("data");null!=t.element&&t.element.selected||null==t.element&&t.selected||this.trigger("select",{data:t})}},e}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),t.on("select",function(e){o._selectTriggered(e)}),t.on("unselect",function(e){o._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&n.ctrlKey||this.trigger("close",{})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){var t=e.minimum-e.input.length,n="Please enter "+t+" or more characters";return n},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,n,o,i,r,s,a,l,c,d,u,h,f,p,m,g,y,v,w,b,C,x,E,N,S,T,_,A){function R(){this.reset()}R.prototype.apply=function(u){if(u=e.extend({},this.defaults,u),null==u.dataAdapter){if(null!=u.ajax?u.dataAdapter=p:null!=u.data?u.dataAdapter=f:u.dataAdapter=h,u.minimumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,y)),u.maximumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,v)),u.maximumSelectionLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,w)),u.tags&&(u.dataAdapter=c.Decorate(u.dataAdapter,m)),(null!=u.tokenSeparators||null!=u.tokenizer)&&(u.dataAdapter=c.Decorate(u.dataAdapter,g)),null!=u.query){var A=t(u.amdBase+"compat/query");u.dataAdapter=c.Decorate(u.dataAdapter,A)}if(null!=u.initSelection){var R=t(u.amdBase+"compat/initSelection");u.dataAdapter=c.Decorate(u.dataAdapter,R)}}if(null==u.resultsAdapter&&(u.resultsAdapter=n,null!=u.ajax&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,E)),null!=u.placeholder&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,x)),u.selectOnClose&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,T))),null==u.dropdownAdapter){if(u.multiple)u.dropdownAdapter=b;else{var O=c.Decorate(b,C);u.dropdownAdapter=O}if(0!==u.minimumResultsForSearch&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,S)),u.closeOnSelect&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,_)),null!=u.dropdownCssClass||null!=u.dropdownCss||null!=u.adaptDropdownCssClass){var I=t(u.amdBase+"compat/dropdownCss");u.dropdownAdapter=c.Decorate(u.dropdownAdapter,I)}u.dropdownAdapter=c.Decorate(u.dropdownAdapter,N)}if(null==u.selectionAdapter){if(u.multiple?u.selectionAdapter=i:u.selectionAdapter=o,null!=u.placeholder&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,r)),u.allowClear&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,s)),u.multiple&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,a)),null!=u.containerCssClass||null!=u.containerCss||null!=u.adaptContainerCssClass){var L=t(u.amdBase+"compat/containerCss");u.selectionAdapter=c.Decorate(u.selectionAdapter,L)}u.selectionAdapter=c.Decorate(u.selectionAdapter,l)}if("string"==typeof u.language)if(u.language.indexOf("-")>0){var D=u.language.split("-"),k=D[0];u.language=[u.language,k]}else u.language=[u.language];if(e.isArray(u.language)){var $=new d;u.language.push("en");for(var M=u.language,P=0;P<M.length;P++){var B=M[P],H={};try{H=d.loadPath(B)}catch(q){try{B=this.defaults.amdLanguageBase+B,H=d.loadPath(B)}catch(z){u.debug&&window.console&&console.warn;continue}}$.extend(H)}u.translations=$}else{var j=d.loadPath(this.defaults.amdLanguageBase+"en"),U=new d(u.language);U.extend(j),u.translations=U}return u},R.prototype.reset=function(){function t(e){function t(e){return u[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function n(o,i){if(""===e.trim(o.term))return i;if(i.children&&i.children.length>0){for(var r=e.extend(!0,{},i),s=i.children.length-1;s>=0;s--){var a=i.children[s],l=n(o,a);null==l&&r.children.splice(s,1)}return r.children.length>0?r:n(o,r)}var c=t(i.text).toUpperCase(),d=t(o.term).toUpperCase();return c.indexOf(d)>-1?i:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:A,matcher:n,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},R.prototype.set=function(t,n){var o=e.camelCase(t),i={};i[o]=n;var r=c._convertData(i);e.extend(this.defaults,r)};var O=new R;return O}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,n,o){function i(t,i){if(this.options=t,null!=i&&this.fromElement(i),this.options=n.apply(this.options),i&&i.is("input")){var r=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=o.Decorate(this.options.dataAdapter,r)}}return i.prototype.fromElement=function(e){var n=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn,e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn,e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var i={};i=t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset?t.extend(!0,{},e[0].dataset,e.data()):e.data();var r=t.extend(!0,{},i);r=o._convertData(r);for(var s in r)t.inArray(s,n)>-1||(t.isPlainObject(this.options[s])?t.extend(this.options[s],r[s]):this.options[s]=r[s]);return this},i.prototype.get=function(e){return this.options[e]},i.prototype.set=function(e,t){this.options[e]=t},i}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,n,o){var i=function(e,n){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),n=n||{},this.options=new t(n,e),i.__super__.constructor.call(this);var o=e.attr("tabindex")||0;e.data("old-tabindex",o),e.attr("tabindex","-1");var r=this.options.get("dataAdapter");this.dataAdapter=new r(e,this.options);var s=this.render();this._placeContainer(s);var a=this.options.get("selectionAdapter");this.selection=new a(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,s);var l=this.options.get("dropdownAdapter");this.dropdown=new l(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,s);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var d=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){d.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return n.Extend(i,n.Observable),i.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4),t="select2-"+t},i.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},i.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var o=this._resolveWidth(e,"style");return null!=o?o:this._resolveWidth(e,"element")}if("element"==t){var i=e.outerWidth(!1);return 0>=i?"auto":i+"px"}if("style"==t){var r=e.attr("style");if("string"!=typeof r)return null;for(var s=r.split(";"),a=0,l=s.length;l>a;a+=1){var c=s[a].replace(/\s/g,""),d=c.match(n);if(null!==d&&d.length>=1)return d[1]}return null}return t},i.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},i.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this._sync=n.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=o?(this._observer=new o(function(n){e.each(n,t._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",t._sync,!1)},i.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,n){e.trigger(t,n)})},i.prototype._registerSelectionEvents=function(){var t=this,n=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(o,i){-1===e.inArray(o,n)&&t.trigger(o,i)})},i.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,n){e.trigger(t,n)})},i.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,n){e.trigger(t,n)})},i.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(n){e.trigger("results:all",{data:n,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(n){e.trigger("results:append",{data:n,query:t})})}),this.on("keypress",function(t){var n=t.which;e.isOpen()?n===o.ESC||n===o.TAB||n===o.UP&&t.altKey?(e.close(),t.preventDefault()):n===o.ENTER?(e.trigger("results:select",{}),t.preventDefault()):n===o.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):n===o.UP?(e.trigger("results:previous",{}),t.preventDefault()):n===o.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(n===o.ENTER||n===o.SPACE||n===o.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},i.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},i.prototype.trigger=function(e,t){var n=i.__super__.trigger,o={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in o){var r=o[e],s={prevented:!1,name:e,args:t};if(n.call(this,r,s),s.prevented)return void(t.prevented=!0)}n.call(this,e,t)},i.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},i.prototype.open=function(){this.isOpen()||this.trigger("query",{})},i.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},i.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},i.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},i.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},i.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn,(null==e||0===e.length)&&(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},i.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn;var e=[];return this.dataAdapter.current(function(t){e=t}),e},i.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn,null==t||0===t.length)return this.$element.val();var n=t[0];e.isArray(n)&&(n=e.map(n,function(e){return e.toString()})),this.$element.val(n).trigger("change")},i.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},i.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),t.data("element",this.$element),t},i}),t.define("jquery-mousewheel",["jquery"],function(e){return e}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,t,n,o){if(null==e.fn.select2){var i=["open","close","destroy"];e.fn.select2=function(t){if(t=t||{},"object"==typeof t)return this.each(function(){var o=e.extend(!0,{},t);new n(e(this),o)}),this;if("string"==typeof t){var o;return this.each(function(){var n=e(this).data("select2");null==n&&window.console&&console.error;var i=Array.prototype.slice.call(arguments,1);o=n[t].apply(n,i)}),e.inArray(t,i)>-1?this:o}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=o),n}),{define:t.define,require:t.require}}(),n=t.require("jquery.select2");return e.fn.select2.amd=t,n}),$(function(){toastr.options={closeButton:!0,debug:!1,progressBar:!0,positionClass:"toast-top-right",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},$(".select2").select2(),$(".textarea").wysihtml5({toolbar:{fa:!0}})});